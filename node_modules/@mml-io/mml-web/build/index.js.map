{
  "version": 3,
  "sources": ["../src/color/color-utils.ts", "../src/color/colors.ts", "../src/attributes/attribute-handling.ts", "../src/global/global.ts", "../src/elements/MElement.ts", "../src/elements/AttributeAnimation.ts", "../src/elements/AttributeLerp.ts", "../src/attribute-animation/AnimatedAttributeHelper.ts", "../src/attribute-animation/easingFunctions.ts", "../src/attribute-animation/easings.ts", "../src/attribute-animation/animation-timings.ts", "../src/math/Quat.ts", "../src/math/Vect3.ts", "../src/math/Matr4.ts", "../src/bounding-box/OrientedBoundingBox.ts", "../src/canvas-text/CanvasText.ts", "../src/collision/CollideableHelper.ts", "../src/collision/MMLCollisionTrigger.ts", "../src/clickable/ClickableHelper.ts", "../src/debug-helper/DebugHelper.ts", "../src/math/EulXYZ.ts", "../src/math/radToDeg.ts", "../src/elements/TransformableElement.ts", "../src/elements/Model.ts", "../src/elements/Animation.ts", "../src/elements/Audio.ts", "../src/elements/Character.ts", "../src/position/position-utils.ts", "../src/elements/ChatProbe.ts", "../src/elements/Cube.ts", "../src/elements/Cylinder.ts", "../src/frame/CreateWrappedScene.ts", "../src/loading/LoadingInstanceManager.ts", "../src/loading/LoadingProgressManager.ts", "../src/loading/LoadingProgressBar.ts", "../src/loading/LoadingSpinner.ts", "../src/remote-document/fetchRemoteStaticMML.ts", "../src/remote-document/RemoteDocumentWrapper.ts", "../src/frame/StaticHTMLFrameInstance.ts", "../src/frame/WebSocketFrameInstance.ts", "../src/network/MMLNetworkSource.ts", "../src/elements/Frame.ts", "../src/elements/Group.ts", "../src/elements/Image.ts", "../src/elements/Interaction.ts", "../src/elements/Label.ts", "../src/elements/Light.ts", "../src/elements/Link.ts", "../src/elements/Overlay.ts", "../src/elements/Plane.ts", "../src/elements/PositionProbe.ts", "../src/elements/Prompt.ts", "../src/time/MMLDocumentTimeManager.ts", "../src/elements/RemoteDocument.ts", "../src/elements/Sphere.ts", "../src/elements/Video.ts", "../src/elements/register-custom-elements.ts", "../src/utils/EventHandlerCollection.ts", "../src/interaction-ui/InteractionManager.ts", "../src/prompt-ui/Modal.ts", "../src/prompt-ui/ConfirmModal.ts", "../src/prompt-ui/PromptModal.ts", "../src/prompt-ui/PromptManager.ts", "../src/scene/MMLScene.ts", "../src/scene/FullScreenMMLScene.ts", "../src/configure-window-for-mml.ts", "../src/graphics/AnimationGraphics.ts", "../src/graphics/AudioGraphics.ts", "../src/graphics/ChatProbeGraphics.ts", "../src/graphics/CubeGraphics.ts", "../src/graphics/CylinderGraphics.ts", "../src/graphics/DebugHelperGraphics.ts", "../src/graphics/FrameGraphics.ts", "../src/graphics/ImageGraphics.ts", "../src/graphics/InteractionGraphics.ts", "../src/graphics/LabelGraphics.ts", "../src/graphics/LightGraphics.ts", "../src/graphics/LinkGraphics.ts", "../src/graphics/MElementGraphics.ts", "../src/graphics/ModelGraphics.ts", "../src/graphics/OverlayGraphics.ts", "../src/graphics/PlaneGraphics.ts", "../src/graphics/PositionProbeGraphics.ts", "../src/graphics/PromptGraphics.ts", "../src/graphics/RemoteDocumentGraphics.ts", "../src/graphics/SphereGraphics.ts", "../src/graphics/TransformableGraphics.ts", "../src/graphics/VideoGraphics.ts", "../src/iframe/IframeWrapper.ts", "../src/status-ui/StatusUI.ts", "../src/tag-debug-adapter/TagAdapterThemeColors.ts", "../src/tag-debug-adapter/TagDebugAdapterDebugHelper.ts", "../src/tag-debug-adapter/TagDebugAdapterElement.ts", "../src/tag-debug-adapter/TagDebugAttribute.ts", "../src/tag-debug-adapter/TagDebugMElement.ts", "../src/tag-debug-adapter/TagDebugAdapterGraphicsInterface.ts", "../src/tag-debug-adapter/StandaloneTagDebugAdapter.ts", "../src/utils/calculateContentSize.ts", "../src/video/StaticFileVideoSource.ts", "../src/video/negotiateConnectionWithClientOffer.ts", "../src/video/WHEPVideoSource.ts", "../src/index.ts"],
  "sourcesContent": ["import { MMLColor } from \"./MMLColor\";\n\nexport function lerpHSL(colorA: MMLColor, colorB: MMLColor, alpha: number): MMLColor {\n  const hslA = getHSL(colorA);\n  const hslB = getHSL(colorB);\n  const h = hslA.h + (hslB.h - hslA.h) * alpha;\n  const s = hslA.s + (hslB.s - hslA.s) * alpha;\n  const l = hslA.l + (hslB.l - hslA.l) * alpha;\n  return hslToRGB(h, s, l);\n}\n\nfunction hue2RGB(p: number, q: number, t: number) {\n  if (t < 0) t += 1;\n  if (t > 1) t -= 1;\n  if (t < 1 / 6) return p + (q - p) * 6 * t;\n  if (t < 1 / 2) return q;\n  if (t < 2 / 3) return p + (q - p) * 6 * (2 / 3 - t);\n  return p;\n}\n\nfunction euclideanModulo(n: number, m: number) {\n  return ((n % m) + m) % m;\n}\n\nexport function hslToRGB(h: number, s: number, l: number): MMLColor {\n  h = euclideanModulo(h, 1);\n  s = Math.max(0, Math.min(s, 1));\n  l = Math.max(0, Math.min(l, 1));\n\n  if (s === 0) {\n    return { r: l, g: l, b: l };\n  } else {\n    const p = l <= 0.5 ? l * (1 + s) : l + s - l * s;\n    const q = 2 * l - p;\n\n    return {\n      r: hue2RGB(q, p, h + 1 / 3),\n      g: hue2RGB(q, p, h),\n      b: hue2RGB(q, p, h - 1 / 3),\n    };\n  }\n}\n\nfunction getHSL(source: MMLColor): { h: number; s: number; l: number } {\n  // h,s,l ranges are in 0.0 - 1.0\n\n  const r = source.r,\n    g = source.g,\n    b = source.b;\n\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n\n  let hue = 0;\n  let saturation = 0;\n  const lightness = (min + max) / 2.0;\n\n  if (min === max) {\n    hue = 0;\n    saturation = 0;\n  } else {\n    const delta = max - min;\n\n    saturation = lightness <= 0.5 ? delta / (max + min) : delta / (2 - max - min);\n\n    switch (max) {\n      case r:\n        hue = (g - b) / delta + (g < b ? 6 : 0);\n        break;\n      case g:\n        hue = (b - r) / delta + 2;\n        break;\n      case b:\n        hue = (r - g) / delta + 4;\n        break;\n    }\n\n    hue /= 6;\n  }\n\n  return {\n    h: hue,\n    s: saturation,\n    l: lightness,\n  };\n}\n", "export const colors: { [key: string]: [number, number, number] } = {\n  aliceblue: [0xf0 / 255, 0xf8 / 255, 0xff / 255],\n  antiquewhite: [0xfa / 255, 0xeb / 255, 0xd7 / 255],\n  aqua: [0x00 / 255, 0xff / 255, 0xff / 255],\n  aquamarine: [0x7f / 255, 0xff / 255, 0xd4 / 255],\n  azure: [0xf0 / 255, 0xff / 255, 0xff / 255],\n  beige: [0xf5 / 255, 0xf5 / 255, 0xdc / 255],\n  bisque: [0xff / 255, 0xe4 / 255, 0xc4 / 255],\n  black: [0x00 / 255, 0x00 / 255, 0x00 / 255],\n  blanchedalmond: [0xff / 255, 0xeb / 255, 0xcd / 255],\n  blue: [0x00 / 255, 0x00 / 255, 0xff / 255],\n  blueviolet: [0x8a / 255, 0x2b / 255, 0xe2 / 255],\n  brown: [0xa5 / 255, 0x2a / 255, 0x2a / 255],\n  burlywood: [0xde / 255, 0xb8 / 255, 0x87 / 255],\n  cadetblue: [0x5f / 255, 0x9e / 255, 0xa0 / 255],\n  chartreuse: [0x7f / 255, 0xff / 255, 0x00 / 255],\n  chocolate: [0xd2 / 255, 0x69 / 255, 0x1e / 255],\n  coral: [0xff / 255, 0x7f / 255, 0x50 / 255],\n  cornflowerblue: [0x64 / 255, 0x95 / 255, 0xed / 255],\n  cornsilk: [0xff / 255, 0xf8 / 255, 0xdc / 255],\n  crimson: [0xdc / 255, 0x14 / 255, 0x3c / 255],\n  cyan: [0x00 / 255, 0xff / 255, 0xff / 255],\n  darkblue: [0x00 / 255, 0x00 / 255, 0x8b / 255],\n  darkcyan: [0x00 / 255, 0x8b / 255, 0x8b / 255],\n  darkgoldenrod: [0xb8 / 255, 0x86 / 255, 0x0b / 255],\n  darkgray: [0xa9 / 255, 0xa9 / 255, 0xa9 / 255],\n  darkgreen: [0x00 / 255, 0x64 / 255, 0x00 / 255],\n  darkgrey: [0xa9 / 255, 0xa9 / 255, 0xa9 / 255],\n  darkkhaki: [0xbd / 255, 0xb7 / 255, 0x6b / 255],\n  darkmagenta: [0x8b / 255, 0x00 / 255, 0x8b / 255],\n  darkolivegreen: [0x55 / 255, 0x6b / 255, 0x2f / 255],\n  darkorange: [0xff / 255, 0x8c / 255, 0x00 / 255],\n  darkorchid: [0x99 / 255, 0x32 / 255, 0xcc / 255],\n  darkred: [0x8b / 255, 0x00 / 255, 0x00 / 255],\n  darksalmon: [0xe9 / 255, 0x96 / 255, 0x7a / 255],\n  darkseagreen: [0x8f / 255, 0xbc / 255, 0x8f / 255],\n  darkslateblue: [0x48 / 255, 0x3d / 255, 0x8b / 255],\n  darkslategray: [0x2f / 255, 0x4f / 255, 0x4f / 255],\n  darkslategrey: [0x2f / 255, 0x4f / 255, 0x4f / 255],\n  darkturquoise: [0x00 / 255, 0xce / 255, 0xd1 / 255],\n  darkviolet: [0x94 / 255, 0x00 / 255, 0xd3 / 255],\n  deeppink: [0xff / 255, 0x14 / 255, 0x93 / 255],\n  deepskyblue: [0x00 / 255, 0xbf / 255, 0xff / 255],\n  dimgray: [0x69 / 255, 0x69 / 255, 0x69 / 255],\n  dimgrey: [0x69 / 255, 0x69 / 255, 0x69 / 255],\n  dodgerblue: [0x1e / 255, 0x90 / 255, 0xff / 255],\n  firebrick: [0xb2 / 255, 0x22 / 255, 0x22 / 255],\n  floralwhite: [0xff / 255, 0xfa / 255, 0xf0 / 255],\n  forestgreen: [0x22 / 255, 0x8b / 255, 0x22 / 255],\n  fuchsia: [0xff / 255, 0x00 / 255, 0xff / 255],\n  gainsboro: [0xdc / 255, 0xdc / 255, 0xdc / 255],\n  ghostwhite: [0xf8 / 255, 0xf8 / 255, 0xff / 255],\n  gold: [0xff / 255, 0xd7 / 255, 0x00 / 255],\n  goldenrod: [0xda / 255, 0xa5 / 255, 0x20 / 255],\n  gray: [0x80 / 255, 0x80 / 255, 0x80 / 255],\n  green: [0x00 / 255, 0x80 / 255, 0x00 / 255],\n  greenyellow: [0xad / 255, 0xff / 255, 0x2f / 255],\n  grey: [0x80 / 255, 0x80 / 255, 0x80 / 255],\n  honeydew: [0xf0 / 255, 0xff / 255, 0xf0 / 255],\n  hotpink: [0xff / 255, 0x69 / 255, 0xb4 / 255],\n  indianred: [0xcd / 255, 0x5c / 255, 0x5c / 255],\n  indigo: [0x4b / 255, 0x00 / 255, 0x82 / 255],\n  ivory: [0xff / 255, 0xff / 255, 0xf0 / 255],\n  khaki: [0xf0 / 255, 0xe6 / 255, 0x8c / 255],\n  lavender: [0xe6 / 255, 0xe6 / 255, 0xfa / 255],\n  lavenderblush: [0xff / 255, 0xf0 / 255, 0xf5 / 255],\n  lawngreen: [0x7c / 255, 0xfc / 255, 0x00 / 255],\n  lemonchiffon: [0xff / 255, 0xfa / 255, 0xcd / 255],\n  lightblue: [0xad / 255, 0xd8 / 255, 0xe6 / 255],\n  lightcoral: [0xf0 / 255, 0x80 / 255, 0x80 / 255],\n  lightcyan: [0xe0 / 255, 0xff / 255, 0xff / 255],\n  lightgoldenrodyellow: [0xfa / 255, 0xfa / 255, 0xd2 / 255],\n  lightgray: [0xd3 / 255, 0xd3 / 255, 0xd3 / 255],\n  lightgreen: [0x90 / 255, 0xee / 255, 0x90 / 255],\n  lightgrey: [0xd3 / 255, 0xd3 / 255, 0xd3 / 255],\n  lightpink: [0xff / 255, 0xb6 / 255, 0xc1 / 255],\n  lightsalmon: [0xff / 255, 0xa0 / 255, 0x7a / 255],\n  lightseagreen: [0x20 / 255, 0xb2 / 255, 0xaa / 255],\n  lightskyblue: [0x87 / 255, 0xce / 255, 0xfa / 255],\n  lightslategray: [0x77 / 255, 0x88 / 255, 0x99 / 255],\n  lightslategrey: [0x77 / 255, 0x88 / 255, 0x99 / 255],\n  lightsteelblue: [0xb0 / 255, 0xc4 / 255, 0xde / 255],\n  lightyellow: [0xff / 255, 0xff / 255, 0xe0 / 255],\n  lime: [0x00 / 255, 0xff / 255, 0x00 / 255],\n  limegreen: [0x32 / 255, 0xcd / 255, 0x32 / 255],\n  linen: [0xfa / 255, 0xf0 / 255, 0xe6 / 255],\n  magenta: [0xff / 255, 0x00 / 255, 0xff / 255],\n  maroon: [0x80 / 255, 0x00 / 255, 0x00 / 255],\n  mediumaquamarine: [0x66 / 255, 0xcd / 255, 0xaa / 255],\n  mediumblue: [0x00 / 255, 0x00 / 255, 0xcd / 255],\n  mediumorchid: [0xba / 255, 0x55 / 255, 0xd3 / 255],\n  mediumpurple: [0x93 / 255, 0x70 / 255, 0xdb / 255],\n  mediumseagreen: [0x3c / 255, 0xb3 / 255, 0x71 / 255],\n  mediumslateblue: [0x7b / 255, 0x68 / 255, 0xee / 255],\n  mediumspringgreen: [0x00 / 255, 0xfa / 255, 0x9a / 255],\n  mediumturquoise: [0x48 / 255, 0xd1 / 255, 0xcc / 255],\n  mediumvioletred: [0xc7 / 255, 0x15 / 255, 0x85 / 255],\n  midnightblue: [0x19 / 255, 0x19 / 255, 0x70 / 255],\n  mintcream: [0xf5 / 255, 0xff / 255, 0xfa / 255],\n  mistyrose: [0xff / 255, 0xe4 / 255, 0xe1 / 255],\n  moccasin: [0xff / 255, 0xe4 / 255, 0xb5 / 255],\n  navajowhite: [0xff / 255, 0xde / 255, 0xad / 255],\n  navy: [0x00 / 255, 0x00 / 255, 0x80 / 255],\n  oldlace: [0xfd / 255, 0xf5 / 255, 0xe6 / 255],\n  olive: [0x80 / 255, 0x80 / 255, 0x00 / 255],\n  olivedrab: [0x6b / 255, 0x8e / 255, 0x23 / 255],\n  orange: [0xff / 255, 0xa5 / 255, 0x00 / 255],\n  orangered: [0xff / 255, 0x45 / 255, 0x00 / 255],\n  orchid: [0xda / 255, 0x70 / 255, 0xd6 / 255],\n  palegoldenrod: [0xee / 255, 0xe8 / 255, 0xaa / 255],\n  palegreen: [0x98 / 255, 0xfb / 255, 0x98 / 255],\n  paleturquoise: [0xaf / 255, 0xee / 255, 0xee / 255],\n  palevioletred: [0xdb / 255, 0x70 / 255, 0x93 / 255],\n  papayawhip: [0xff / 255, 0xef / 255, 0xd5 / 255],\n  peachpuff: [0xff / 255, 0xda / 255, 0xb9 / 255],\n  peru: [0xcd / 255, 0x85 / 255, 0x3f / 255],\n  pink: [0xff / 255, 0xc0 / 255, 0xcb / 255],\n  plum: [0xdd / 255, 0xa0 / 255, 0xdd / 255],\n  powderblue: [0xb0 / 255, 0xe0 / 255, 0xe6 / 255],\n  purple: [0x80 / 255, 0x00 / 255, 0x80 / 255],\n  rebeccapurple: [0x66 / 255, 0x33 / 255, 0x99 / 255],\n  red: [0xff / 255, 0x00 / 255, 0x00 / 255],\n  rosybrown: [0xbc / 255, 0x8f / 255, 0x8f / 255],\n  royalblue: [0x41 / 255, 0x69 / 255, 0xe1 / 255],\n  saddlebrown: [0x8b / 255, 0x45 / 255, 0x13 / 255],\n  salmon: [0xfa / 255, 0x80 / 255, 0x72 / 255],\n  sandybrown: [0xf4 / 255, 0xa4 / 255, 0x60 / 255],\n  seagreen: [0x2e / 255, 0x8b / 255, 0x57 / 255],\n  seashell: [0xff / 255, 0xf5 / 255, 0xee / 255],\n  sienna: [0xa0 / 255, 0x52 / 255, 0x2d / 255],\n  silver: [0xc0 / 255, 0xc0 / 255, 0xc0 / 255],\n  skyblue: [0x87 / 255, 0xce / 255, 0xeb / 255],\n  slateblue: [0x6a / 255, 0x5a / 255, 0xcd / 255],\n  slategray: [0x70 / 255, 0x80 / 255, 0x90 / 255],\n  slategrey: [0x70 / 255, 0x80 / 255, 0x90 / 255],\n  snow: [0xff / 255, 0xfa / 255, 0xfa / 255],\n  springgreen: [0x00 / 255, 0xff / 255, 0x7f / 255],\n  steelblue: [0x46 / 255, 0x82 / 255, 0xb4 / 255],\n  tan: [0xd2 / 255, 0xb4 / 255, 0x8c / 255],\n  teal: [0x00 / 255, 0x80 / 255, 0x80 / 255],\n  thistle: [0xd8 / 255, 0xbf / 255, 0xd8 / 255],\n  tomato: [0xff / 255, 0x63 / 255, 0x47 / 255],\n  turquoise: [0x40 / 255, 0xe0 / 255, 0xd0 / 255],\n  violet: [0xee / 255, 0x82 / 255, 0xee / 255],\n  wheat: [0xf5 / 255, 0xde / 255, 0xb3 / 255],\n  white: [0xff / 255, 0xff / 255, 0xff / 255],\n  whitesmoke: [0xf5 / 255, 0xf5 / 255, 0xf5 / 255],\n  yellow: [0xff / 255, 0xff / 255, 0x00 / 255],\n  yellowgreen: [0x9a / 255, 0xcd / 255, 0x32 / 255],\n};\n", "import { colors, hslToRGB, MMLColor } from \"../color\";\n\nexport type AttributeHandlerMap<T> = {\n  [key: string]: (instance: T, newValue: string | null) => void;\n};\n\nexport class AttributeHandler<T> {\n  private map: AttributeHandlerMap<T>;\n\n  constructor(map: AttributeHandlerMap<T>) {\n    this.map = map;\n  }\n\n  public getAttributes() {\n    return Object.keys(this.map);\n  }\n\n  public handle(instance: T, name: string, newValue: string): boolean {\n    const handler = this.map[name];\n    if (handler) {\n      handler(instance, newValue);\n      return true;\n    }\n    return false;\n  }\n}\n\nfunction parseRGB(value: string): MMLColor | null {\n  value = value.trim();\n  const validStart = value.startsWith(\"rgb(\") || value.startsWith(\"rgba(\");\n  const validEnd = value.endsWith(\")\");\n  if (!validStart || !validEnd) return null;\n\n  const content = value.substring(value.indexOf(\"(\") + 1, value.length - 1).split(\",\");\n\n  if (content.length < 3 || content.length > 4) return null;\n  if (value.startsWith(\"rgb(\") && content.length !== 3) return null;\n  if (value.startsWith(\"rgba(\") && content.length !== 4) return null;\n\n  const numbers = content.map((n) => parseFloat(n.trim()));\n  if (numbers.some((n) => isNaN(n))) return null;\n\n  return {\n    r: Math.min(255, Math.max(0, numbers[0])) / 255,\n    g: Math.min(255, Math.max(0, numbers[1])) / 255,\n    b: Math.min(255, Math.max(0, numbers[2])) / 255,\n    a: numbers.length === 4 ? Math.min(1, Math.max(0, numbers[3])) : undefined,\n  };\n}\n\nfunction parseHSL(value: string): MMLColor | null {\n  value = value.trim();\n  const validStart = value.startsWith(\"hsl(\") || value.startsWith(\"hsla(\");\n  const validEnd = value.endsWith(\")\");\n  if (!validStart || !validEnd) return null;\n  const content = value.substring(value.indexOf(\"(\") + 1, value.length - 1).split(\",\");\n\n  if (content.length < 3 || content.length > 4) return null;\n  if (value.startsWith(\"hsl(\") && content.length !== 3) return null;\n  if (value.startsWith(\"hsla(\") && content.length !== 4) return null;\n\n  const numbers = content.map((n) => parseFloat(n.trim()));\n  if (numbers.some((n) => isNaN(n))) return null;\n\n  let [h, s, l] = numbers;\n\n  h = h / 360;\n  h = h === 0 ? 0.0001 : h === 1 ? 0.9999 : h;\n\n  s = s / 100;\n  s = s === 0 ? 0.0001 : s === 1 ? 0.9999 : s;\n\n  l = l / 100;\n  l = l === 0 ? 0.0001 : l === 1 ? 0.9999 : l;\n\n  const rgb = hslToRGB(h, s, l);\n  return {\n    r: rgb.r,\n    g: rgb.g,\n    b: rgb.b,\n    a: numbers.length === 4 ? Math.min(1, Math.max(0, numbers[3])) : undefined,\n  };\n}\n\nexport function parseColorAttribute(value: string | null, defaultValue: null): MMLColor | null;\nexport function parseColorAttribute(value: string | null, defaultValue: MMLColor): MMLColor;\nexport function parseColorAttribute(\n  value: string | null,\n  defaultValue: MMLColor | null,\n): MMLColor | null {\n  return parseAttribute(value, defaultValue, (value) => {\n    const colorNameValues = colors[value.trim()];\n    if (colorNameValues) {\n      return {\n        r: colorNameValues[0],\n        g: colorNameValues[1],\n        b: colorNameValues[2],\n      };\n    }\n\n    if (value.length === 7) {\n      const hex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(value);\n      if (hex) {\n        // e.g. #ff00ff\n        return {\n          r: parseInt(hex[1], 16) / 255,\n          g: parseInt(hex[2], 16) / 255,\n          b: parseInt(hex[3], 16) / 255,\n        };\n      }\n    }\n\n    if (value.length === 4) {\n      const hex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i.exec(value);\n      if (hex) {\n        // e.g. #f0f\n        return {\n          r: parseInt(hex[1] + hex[1], 16) / 255,\n          g: parseInt(hex[2] + hex[2], 16) / 255,\n          b: parseInt(hex[3] + hex[3], 16) / 255,\n        };\n      }\n    }\n\n    if (value.indexOf(\"rgb(\") === 0) {\n      return parseRGB(value);\n    }\n\n    if (value.indexOf(\"rgba(\") === 0) {\n      return parseRGB(value);\n    }\n\n    if (value.indexOf(\"hsl(\") === 0) {\n      return parseHSL(value);\n    }\n\n    if (value.indexOf(\"hsla(\") === 0) {\n      return parseHSL(value);\n    }\n    return null;\n  });\n}\n\nexport function parseAttribute<T>(\n  value: string | null,\n  defaultValue: T,\n  parser: (value: string) => T | null,\n): T {\n  if (value === null) {\n    return defaultValue;\n  }\n  const parsed = parser(value);\n  if (parsed === null) {\n    return defaultValue;\n  }\n  return parsed;\n}\n\nexport function floatParser(value: string): number | null {\n  const parsed = parseFloat(value);\n  if (isNaN(parsed)) {\n    return null;\n  }\n  return parsed;\n}\n\nexport function boolParser(value: string): boolean | null {\n  if (value === \"true\") {\n    return true;\n  } else if (value === \"false\") {\n    return false;\n  }\n  return null;\n}\n\nexport function parseFloatAttribute(value: string | null, defaultValue: null): number | null;\nexport function parseFloatAttribute(value: string | null, defaultValue: number): number;\n\nexport function parseFloatAttribute(\n  value: string | null,\n  defaultValue: number | null,\n): number | null {\n  return parseAttribute(value, defaultValue, floatParser);\n}\n\nexport function parseBoolAttribute(value: string | null, defaultValue: boolean): boolean {\n  return parseAttribute(value, defaultValue, boolParser);\n}\n\nexport function parseEnumAttribute<T extends string>(\n  value: string | null,\n  enumValues: Record<T, T>,\n  defaultValue: T,\n): T {\n  return parseAttribute(value, defaultValue, (value) => {\n    if (Object.keys(enumValues).indexOf(value as T) === -1) {\n      return null;\n    }\n    return value as T;\n  });\n}\n", "import { GraphicsAdapter } from \"../graphics\";\nimport { IMMLScene } from \"../scene\";\nimport { MMLDocumentTimeManager } from \"../time\";\n\nlet scene: IMMLScene<GraphicsAdapter> | null = null;\nlet documentTimeManager: MMLDocumentTimeManager | null = null;\n\nexport function setGlobalMMLScene(sceneArg: IMMLScene<GraphicsAdapter>) {\n  if (scene) {\n    throw new Error(\"GlobalMMLScene already set\");\n  }\n  scene = sceneArg;\n}\n\nexport function getGlobalMMLScene(): IMMLScene<GraphicsAdapter> {\n  if (!scene) {\n    throw new Error(\"GlobalMMLScene not set\");\n  }\n  return scene;\n}\n\nexport function setGlobalDocumentTimeManager(documentTimeManagerArg: MMLDocumentTimeManager) {\n  if (documentTimeManager) {\n    throw new Error(\"GlobalDocumentTimeManager already set\");\n  }\n  documentTimeManager = documentTimeManagerArg;\n}\n\nexport function getGlobalDocumentTimeManager(): MMLDocumentTimeManager {\n  if (!documentTimeManager) {\n    throw new Error(\"GlobalMMLScene not set\");\n  }\n  return documentTimeManager;\n}\n", "import { getGlobalDocumentTimeManager, getGlobalMMLScene } from \"../global\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { MElementGraphics } from \"../graphics\";\nimport { LoadingProgressManager } from \"../loading\";\nimport { IMMLScene, PositionAndRotation } from \"../scene\";\nimport { MMLDocumentTimeManager } from \"../time\";\nimport type { RemoteDocument } from \"./RemoteDocument\";\n\nexport const MELEMENT_PROPERTY_NAME = \"m-element-property\";\nexport const consumeEventEventName = \"consume-event\";\n\nexport abstract class MElement<G extends GraphicsAdapter = GraphicsAdapter> extends HTMLElement {\n  // This allows switching which document this HTMLElement subclass extends so that it can be placed into iframes\n  static overwriteSuperclass(newSuperclass: typeof HTMLElement) {\n    (MElement as any).__proto__ = newSuperclass;\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [];\n  }\n\n  private mElementGraphics: MElementGraphics<G> | null = null;\n\n  constructor() {\n    super();\n  }\n\n  public readonly isMElement = true;\n\n  public static isMElement(element: object): element is MElement {\n    return (element as MElement).isMElement;\n  }\n\n  static getMElementFromObject(object: unknown): MElement<GraphicsAdapter> | null {\n    return (object as any)[MELEMENT_PROPERTY_NAME] || null;\n  }\n\n  public abstract isClickable(): boolean;\n\n  public abstract parentTransformed(): void;\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  public addSideEffectChild(child: MElement<G>): void {\n    // no-op\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  public removeSideEffectChild(child: MElement<G>): void {\n    // no-op\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  public attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    // no-op\n  }\n\n  public getScene(): IMMLScene<G> {\n    const remoteDocumentElement = this.getInitiatedRemoteDocument();\n    if (remoteDocumentElement) {\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      return (remoteDocumentElement as RemoteDocument<G>).getMMLScene()!;\n    }\n    const globalScene = getGlobalMMLScene() as IMMLScene<G>;\n    if (!globalScene) {\n      throw new Error(\"No scene attachment found and no global scene found\");\n    }\n    return globalScene;\n  }\n\n  public getInitiatedRemoteDocument(): RemoteDocument<G> | null {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    for (let parentNode: ParentNode | null = this; parentNode; parentNode = parentNode.parentNode) {\n      if (\n        parentNode.nodeName === \"M-REMOTE-DOCUMENT\" &&\n        (parentNode as RemoteDocument<G>).getMMLScene()\n      ) {\n        // Return the first remote document that has an explicit scene set\n        return parentNode as RemoteDocument<G>;\n      }\n    }\n    return null;\n  }\n\n  public contentSrcToContentAddress(src: string): string {\n    // Convert the potentially relative src to an absolute address using the document host\n    const documentLocation = this.getDocumentHost();\n    // First check if the src is a host-relative path\n    try {\n      // Check if the src is a valid URL - if so then it's already absolute\n      const url = new URL(src);\n      return url.toString();\n    } catch {\n      // Do nothing\n    }\n    let protocol = documentLocation.protocol;\n    if (protocol === \"ws:\") {\n      protocol = \"http:\";\n    } else if (protocol === \"wss:\") {\n      protocol = \"https:\";\n    }\n    if (src.startsWith(\"/\")) {\n      // If the src is host-relative then we can just use the document host\n      return `${protocol}//${documentLocation.host}${src}`;\n    } else {\n      // Otherwise we need to use the document host as a base\n      const path = documentLocation.pathname;\n      const lastSlashIndex = path.lastIndexOf(\"/\");\n      if (lastSlashIndex === -1) {\n        return `${protocol}//${documentLocation.host}/${src}`;\n      }\n      const pathWithoutFilename = path.substring(0, lastSlashIndex + 1);\n      return `${protocol}//${documentLocation.host}${pathWithoutFilename}${src}`;\n    }\n  }\n\n  private getDocumentHost(): URL | Location {\n    const remoteDocument = this.getInitiatedRemoteDocument();\n    if (remoteDocument) {\n      const remoteDocumentAddress = remoteDocument.getDocumentAddress();\n      if (remoteDocumentAddress) {\n        const url = new URL(remoteDocumentAddress);\n        return url;\n      }\n    }\n    return window.location;\n  }\n\n  public getDocumentTime(): number {\n    const documentTimeContextProvider = this.getDocumentTimeManager();\n    if (documentTimeContextProvider) {\n      return documentTimeContextProvider.getDocumentTime();\n    }\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    return Number(document.timeline.currentTime!);\n  }\n\n  public getWindowTime(): number {\n    const documentTimeContextProvider = this.getDocumentTimeManager();\n    if (documentTimeContextProvider) {\n      return documentTimeContextProvider.getWindowTime();\n    }\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    return Number(document.timeline.currentTime!);\n  }\n\n  public getLoadingProgressManager(): LoadingProgressManager | null {\n    const scene = this.getScene();\n    if (scene) {\n      return scene.getLoadingProgressManager?.() || null;\n    }\n    return null;\n  }\n\n  protected getDocumentTimeManager(): MMLDocumentTimeManager | null {\n    const remoteDocument = this.getInitiatedRemoteDocument();\n    if (remoteDocument) {\n      return remoteDocument.getDocumentTimeManager();\n    }\n    const globalDocumentTimeManager = getGlobalDocumentTimeManager();\n    if (globalDocumentTimeManager) {\n      return globalDocumentTimeManager;\n    }\n    return null;\n  }\n\n  public addDocumentTimeListener(cb: (documentTime: number) => void): {\n    remove: () => void;\n  } {\n    const documentTimeManager = this.getDocumentTimeManager();\n    if (documentTimeManager) {\n      documentTimeManager.addDocumentTimeListenerCallback(cb);\n      return {\n        remove: () => {\n          documentTimeManager.removeDocumentTimeListenerCallback(cb);\n        },\n      };\n    } else {\n      console.warn(\"No document time context provider found to add listener to\");\n      return {\n        remove: () => {\n          // no-op\n        },\n      };\n    }\n  }\n\n  public addDocumentTimeTickListener(cb: (documentTime: number) => void): {\n    remove: () => void;\n  } {\n    const documentTimeManager = this.getDocumentTimeManager();\n    if (documentTimeManager) {\n      documentTimeManager.addDocumentTimeTickListenerCallback(cb);\n      return {\n        remove: () => {\n          documentTimeManager.removeDocumentTimeTickListenerCallback(cb);\n        },\n      };\n    } else {\n      console.warn(\"No document time context provider found to add listener to\");\n      return {\n        remove: () => {\n          // no-op\n        },\n      };\n    }\n  }\n\n  getContainer(): G[\"containerType\"] {\n    const container = this.mElementGraphics?.getContainer();\n    if (!container) {\n      throw new Error(\"No container found\");\n    }\n    return container;\n  }\n\n  getUserPositionAndRotation(): PositionAndRotation {\n    const remoteDocument = this.getScene();\n    if (!remoteDocument) {\n      throw new Error(\"No scene to retrieve user position from\");\n    }\n    return remoteDocument.getUserPositionAndRotation();\n  }\n\n  dispatchEvent(event: Event): boolean {\n    const remoteDocument = this.getInitiatedRemoteDocument();\n    if (remoteDocument) {\n      remoteDocument.dispatchEvent(\n        new CustomEvent(consumeEventEventName, {\n          bubbles: false,\n          detail: { element: this, originalEvent: event },\n        }),\n      );\n      return super.dispatchEvent(event);\n    } else {\n      if (event.type !== \"click\") {\n        const script = this.getAttribute(\"on\" + event.type.toLowerCase());\n        if (script) {\n          const handler = window[\"eval\"](`(function(event){ ${script} })`);\n          handler.apply(this, [event]);\n        }\n      }\n      return super.dispatchEvent(event);\n    }\n  }\n\n  public getMElementParent(): MElement<G> | null {\n    let parentNode = this.parentNode;\n    while (parentNode != null) {\n      if (MElement.isMElement(parentNode)) {\n        return parentNode as MElement<G>;\n      }\n      parentNode = parentNode.parentNode;\n    }\n    return null;\n  }\n\n  public connectedCallback(): void {\n    if (!this.getScene().hasGraphicsAdapter() || this.mElementGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.mElementGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MElementGraphicsInterface(this);\n  }\n\n  disconnectedCallback() {\n    this.mElementGraphics?.dispose();\n    this.mElementGraphics = null;\n  }\n}\n", "import {\n  AnimatedAttributeHelper,\n  EndOfAnimationSymbol,\n  getEasedRatioForTime,\n  StartOfAnimationSymbol,\n} from \"../attribute-animation\";\nimport {\n  AttributeHandler,\n  parseBoolAttribute,\n  parseColorAttribute,\n  parseFloatAttribute,\n} from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { lerpHSL } from \"../color\";\nimport { MMLColor } from \"../color\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { MElement } from \"./MElement\";\n\nconst defaultAttribute: string | null = null;\nconst defaultStart = 0;\nconst defaultEnd = 0;\nconst defaultLoop = true;\nconst defaultPingPong = false;\nconst defaultEasing = \"\";\nconst defaultStartTime = 0;\nconst defaultPauseTime = null;\nconst defaultAnimDuration = 1000;\nconst defaultPingPongDelay = 0;\n\nexport enum AnimationType {\n  Number,\n  Degrees, // Special handling for lerping e.g. 359 to 1\n  Color,\n}\n\nconst defaultColor: MMLColor = { r: 1, g: 1, b: 1 };\n\n/*\n Attribute animations are applied with the following precedence:\n  1. The first child m-attr-anim that is running (start time has passed, and duration is not exceeded / is looping)\n  2. The next-to-start m-attr-anim that is not yet running (start time has not passed). If equal timing then the first occurring child is used.\n  3. The last m-attr-anim to end (duration has been exceeded, and is not looping). If equal timing then the first occurring child is used.\n  4. The element's attribute value.\n */\n\nexport class AttributeAnimation<G extends GraphicsAdapter = GraphicsAdapter> extends MElement<G> {\n  static tagName = \"m-attr-anim\";\n\n  private props = {\n    attr: defaultAttribute,\n    start: defaultStart as number | MMLColor,\n    end: defaultEnd as number | MMLColor,\n    loop: defaultLoop,\n    pingPong: defaultPingPong,\n    pingPongDelay: defaultPingPongDelay,\n    easing: defaultEasing,\n    startTime: defaultStartTime,\n    pauseTime: defaultPauseTime as number | null,\n    animDuration: defaultAnimDuration,\n  };\n\n  private registeredParentAttachment: MElement<G> | null = null;\n\n  private animatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    start: [\n      AnimationType.Number,\n      defaultStart,\n      (value: number) => {\n        this.props.start = value;\n      },\n    ],\n    end: [\n      AnimationType.Number,\n      defaultEnd,\n      (value: number) => {\n        this.props.end = value;\n      },\n    ],\n    \"start-time\": [\n      AnimationType.Number,\n      defaultStartTime,\n      (value: number) => {\n        this.props.startTime = value;\n      },\n    ],\n    \"pause-time\": [\n      AnimationType.Number,\n      defaultPauseTime,\n      (value: number | null) => {\n        this.props.pauseTime = value;\n      },\n    ],\n    duration: [\n      AnimationType.Number,\n      defaultAnimDuration,\n      (value: number) => {\n        this.props.animDuration = value;\n      },\n    ],\n    \"ping-pong-delay\": [\n      AnimationType.Number,\n      defaultPingPongDelay,\n      (value: number) => {\n        this.props.pingPongDelay = value;\n      },\n    ],\n  });\n\n  private static attributeHandler = new AttributeHandler<AttributeAnimation<GraphicsAdapter>>({\n    attr: (instance, newValue) => {\n      if (instance.registeredParentAttachment && instance.props.attr) {\n        instance.registeredParentAttachment.removeSideEffectChild(instance);\n      }\n      instance.props.attr = newValue || defaultAttribute;\n      if (instance.registeredParentAttachment && instance.props.attr) {\n        instance.registeredParentAttachment.addSideEffectChild(instance);\n      }\n    },\n    start: (instance, newValue) => {\n      let parsedValue: number | MMLColor | null = parseFloatAttribute(newValue, null);\n      if (parsedValue === null) {\n        parsedValue = parseColorAttribute(newValue, null);\n      }\n      if (parsedValue === null) {\n        instance.props.start = defaultStart;\n      } else {\n        instance.props.start = parsedValue;\n      }\n    },\n    end: (instance, newValue) => {\n      let parsedValue: number | MMLColor | null = parseFloatAttribute(newValue, null);\n      if (parsedValue === null) {\n        parsedValue = parseColorAttribute(newValue, null);\n      }\n      if (parsedValue === null) {\n        instance.props.end = defaultStart;\n      } else {\n        instance.props.end = parsedValue;\n      }\n    },\n    loop: (instance, newValue) => {\n      instance.props.loop = parseBoolAttribute(newValue, defaultLoop);\n    },\n    \"ping-pong\": (instance, newValue) => {\n      instance.props.pingPong = parseBoolAttribute(newValue, defaultPingPong);\n    },\n    \"ping-pong-delay\": (instance, newValue) => {\n      instance.animatedAttributeHelper.elementSetAttribute(\n        \"ping-pong-delay\",\n        parseFloatAttribute(newValue, defaultPingPongDelay),\n      );\n    },\n    easing: (instance, newValue) => {\n      instance.props.easing = newValue || defaultEasing;\n    },\n    \"start-time\": (instance, newValue) => {\n      instance.animatedAttributeHelper.elementSetAttribute(\n        \"start-time\",\n        parseFloatAttribute(newValue, defaultStartTime),\n      );\n    },\n    \"pause-time\": (instance, newValue) => {\n      instance.animatedAttributeHelper.elementSetAttribute(\n        \"pause-time\",\n        parseFloatAttribute(newValue, defaultPauseTime),\n      );\n    },\n    duration: (instance, newValue) => {\n      instance.animatedAttributeHelper.elementSetAttribute(\n        \"duration\",\n        parseFloatAttribute(newValue, defaultAnimDuration),\n      );\n    },\n  });\n\n  public readonly isAttributeAnimation = true;\n\n  public static isAttributeAnimation(element: object): element is AttributeAnimation {\n    return (element as AttributeAnimation).isAttributeAnimation;\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [...AttributeAnimation.attributeHandler.getAttributes()];\n  }\n  constructor() {\n    super();\n  }\n\n  protected enable() {\n    // no-op\n  }\n\n  protected disable() {\n    // no-op\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    return null;\n  }\n\n  public getAnimatedAttributeName(): string | null {\n    return this.props.attr;\n  }\n\n  public parentTransformed(): void {\n    // no-op\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.animatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.animatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    super.attributeChangedCallback(name, oldValue, newValue);\n    AttributeAnimation.attributeHandler.handle(this, name, newValue);\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (this.parentElement && MElement.isMElement(this.parentElement)) {\n      this.registeredParentAttachment = this.parentElement as MElement<G>;\n      if (this.props.attr) {\n        this.registeredParentAttachment.addSideEffectChild(this);\n      }\n    }\n  }\n\n  disconnectedCallback() {\n    if (this.registeredParentAttachment && this.props.attr) {\n      this.registeredParentAttachment.removeSideEffectChild(this);\n    }\n    this.animatedAttributeHelper.reset();\n    this.registeredParentAttachment = null;\n    super.disconnectedCallback();\n  }\n\n  public getColorValueForTime(docTimeMs: number): [MMLColor, number] {\n    const [ratio, state] = getEasedRatioForTime(docTimeMs, this.props);\n    if (typeof this.props.start !== \"object\" || typeof this.props.end !== \"object\") {\n      return [defaultColor, state];\n    }\n    if (ratio === StartOfAnimationSymbol) {\n      return [this.props.start, state];\n    } else if (ratio === EndOfAnimationSymbol) {\n      return [this.props.end, state];\n    } else {\n      const value = lerpHSL(this.props.start, this.props.end, ratio);\n      return [value, state];\n    }\n  }\n\n  public getFloatValueForTime(docTimeMs: number): [number, number] {\n    const [ratio, state] = getEasedRatioForTime(docTimeMs, this.props);\n    if (typeof this.props.start !== \"number\" || typeof this.props.end !== \"number\") {\n      return [0, state];\n    }\n    if (ratio === StartOfAnimationSymbol) {\n      return [this.props.start as number, state];\n    } else if (ratio === EndOfAnimationSymbol) {\n      return [this.props.end as number, state];\n    } else {\n      const value = ratio * (this.props.end - this.props.start) + this.props.start;\n      return [value, state];\n    }\n  }\n}\n", "import { easingsByName } from \"../attribute-animation\";\nimport { AttributeHandler, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { lerpHSL, MMLColor } from \"../color\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { MElement } from \"./MElement\";\n\nconst defaultAttribute: string = \"all\";\nconst defaultEasing = \"\";\nconst defaultLerpDuration = 1000;\n\nexport class AttributeLerp<G extends GraphicsAdapter = GraphicsAdapter> extends MElement<G> {\n  static tagName = \"m-attr-lerp\";\n\n  private props = {\n    attr: defaultAttribute,\n    easing: defaultEasing,\n    lerpDuration: defaultLerpDuration,\n  };\n\n  private registeredParentAttachment: MElement<G> | null = null;\n\n  private static attributeHandler = new AttributeHandler<AttributeLerp<GraphicsAdapter>>({\n    attr: (instance, newValue) => {\n      if (instance.registeredParentAttachment) {\n        instance.registeredParentAttachment.removeSideEffectChild(instance);\n      }\n      instance.props.attr = newValue !== null ? newValue : defaultAttribute;\n      if (instance.registeredParentAttachment) {\n        instance.registeredParentAttachment.addSideEffectChild(instance);\n      }\n    },\n    easing: (instance, newValue) => {\n      instance.props.easing = newValue || defaultEasing;\n    },\n    duration: (instance, newValue) => {\n      instance.props.lerpDuration = Math.max(0, parseFloatAttribute(newValue, defaultLerpDuration));\n    },\n  });\n\n  public readonly isAttributeLerp = true;\n\n  public static isAttributeLerp(element: object): element is AttributeLerp {\n    return (element as AttributeLerp).isAttributeLerp;\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [...AttributeLerp.attributeHandler.getAttributes()];\n  }\n\n  constructor() {\n    super();\n  }\n\n  protected enable() {\n    // no-op\n  }\n\n  protected disable() {\n    // no-op\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    return null;\n  }\n\n  public getAnimatedAttributeName(): string | null {\n    return this.props.attr;\n  }\n\n  public parentTransformed(): void {\n    // no-op\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    super.attributeChangedCallback(name, oldValue, newValue);\n    AttributeLerp.attributeHandler.handle(this, name, newValue);\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (this.parentElement && MElement.isMElement(this.parentElement)) {\n      this.registeredParentAttachment = this.parentElement as MElement<G>;\n      this.registeredParentAttachment.addSideEffectChild(this);\n    }\n  }\n\n  disconnectedCallback() {\n    if (this.registeredParentAttachment) {\n      this.registeredParentAttachment.removeSideEffectChild(this);\n    }\n    this.registeredParentAttachment = null;\n    super.disconnectedCallback();\n  }\n\n  public getColorValueForTime(\n    windowTime: number,\n    elementValueSetTime: number,\n    elementValue: MMLColor,\n    previousValue: MMLColor,\n  ) {\n    const ratio = this.getLerpRatio(windowTime, elementValueSetTime);\n    if (ratio >= 1) {\n      return elementValue;\n    }\n    return lerpHSL(previousValue, elementValue, ratio);\n  }\n\n  public getFloatValueForTime(\n    windowTime: number,\n    elementValueSetTime: number,\n    elementValue: number,\n    previousValue: number,\n    isDegrees: boolean,\n  ) {\n    let from = previousValue;\n    const to = elementValue;\n    const ratio = this.getLerpRatio(windowTime, elementValueSetTime);\n    if (ratio >= 1) {\n      return to;\n    }\n    if (isDegrees) {\n      // Should handle going from 359 to 1 as +2 rather than -358\n      if (to - from > 180) {\n        from += 360;\n      } else if (from - to > 180) {\n        from -= 360;\n      }\n    }\n    return from + (to - from) * ratio;\n  }\n\n  private getLerpRatio(windowTime: number, elementValueSetTime: number) {\n    const duration = this.props.lerpDuration;\n    const timePassed = (windowTime || 0) - elementValueSetTime;\n    const ratioOfTimePassed = Math.min(timePassed / duration, 1);\n    const easing = this.props.easing;\n    let ratio;\n    const easingFunction = easingsByName[easing];\n    if (easingFunction) {\n      ratio = easingFunction(ratioOfTimePassed, 0, 1, 1);\n    } else {\n      ratio = ratioOfTimePassed;\n    }\n    return ratio;\n  }\n}\n", "import { MMLColor } from \"../color\";\nimport { AnimationType, AttributeAnimation } from \"../elements/AttributeAnimation\";\nimport { AttributeLerp } from \"../elements/AttributeLerp\";\nimport { MElement } from \"../elements/MElement\";\nimport { GraphicsAdapter } from \"../graphics\";\n\ntype AttributeTuple<T extends AnimationType> = T extends AnimationType.Number\n  ? [\n      AnimationType.Number,\n      AnimationTypeToValueType<T> | null,\n      (newValue: AnimationTypeToValueType<T> | null) => void,\n    ]\n  : T extends AnimationType.Degrees\n    ? [\n        AnimationType.Degrees,\n        AnimationTypeToValueType<T> | null,\n        (newValue: AnimationTypeToValueType<T> | null) => void,\n      ]\n    : [\n        AnimationType.Color,\n        AnimationTypeToValueType<T> | null,\n        (newValue: AnimationTypeToValueType<T> | null) => void,\n      ];\n\nexport type AttributeHandlerRecord = Record<\n  string,\n  | AttributeTuple<AnimationType.Number>\n  | AttributeTuple<AnimationType.Degrees>\n  | AttributeTuple<AnimationType.Color>\n>;\n\ntype AnimationTypeToValueType<T extends AnimationType> = T extends\n  | AnimationType.Number\n  | AnimationType.Degrees\n  ? number\n  : MMLColor;\n\ntype AttributeState<T extends AnimationType> = {\n  type: T;\n  previousValue: AnimationTypeToValueType<T> | null;\n  elementValue: AnimationTypeToValueType<T> | null;\n  elementValueSetTime: number | null;\n  latestValue: AnimationTypeToValueType<T> | null;\n  defaultValue: AnimationTypeToValueType<T> | null;\n  handler: (newValue: AnimationTypeToValueType<T> | null) => void;\n};\n\ntype AnimationStateRecord<T extends AnimationType> = {\n  attributeState: AttributeState<T>;\n  animationsInOrder: Array<AttributeAnimation<GraphicsAdapter>>;\n  animationsSet: Set<AttributeAnimation<GraphicsAdapter>>;\n  lerpsInOrder: Array<AttributeLerp<GraphicsAdapter>>;\n  lerpsSet: Set<AttributeLerp<GraphicsAdapter>>;\n};\n\nfunction TupleToState<T extends AnimationType>(tuple: AttributeTuple<T>): AttributeState<T> {\n  return {\n    previousValue: null,\n    elementValue: null,\n    elementValueSetTime: null,\n    type: tuple[0],\n    latestValue: tuple[1],\n    defaultValue: tuple[1],\n    handler: tuple[2],\n  } as AttributeState<T>;\n}\n\nfunction updateIfChangedValue<T extends AnimationType>(\n  state: AnimationStateRecord<T>,\n  newValue: AnimationTypeToValueType<T> | null,\n) {\n  if (newValue === null) {\n    // There is no value from the source (likely there are no animations and no attribute value), so use the default.\n    newValue = state.attributeState.defaultValue;\n  }\n  if (state.attributeState.latestValue !== newValue) {\n    state.attributeState.latestValue = newValue;\n    state.attributeState.handler(newValue);\n  }\n}\n\nfunction isColorAttribute(\n  attributeState: AttributeState<AnimationType>,\n): attributeState is AttributeState<AnimationType.Color> {\n  return attributeState.type === AnimationType.Color;\n}\n\nfunction isDegreesAttribute(\n  attributeState: AttributeState<AnimationType>,\n): attributeState is AttributeState<AnimationType.Degrees> {\n  return attributeState.type === AnimationType.Degrees;\n}\n\nfunction isNumberAttribute(\n  attributeState: AttributeState<AnimationType>,\n): attributeState is AttributeState<AnimationType.Number> {\n  return attributeState.type === AnimationType.Number;\n}\n\n/**\n * The AnimatedAttributeHelper is a utility class that manages the application of attribute animations to an element.\n *\n * It is used by an MElement that has animateable attributes and is responsible for applying the animations to the\n * element according to the precedence rules defined in the AttributeAnimation<GraphicsAdapter> class, and falling back to the element's\n * attribute value if no animations are active.\n */\nexport class AnimatedAttributeHelper {\n  private stateByAttribute: {\n    [p: string]: AnimationStateRecord<AnimationType>;\n  } = {};\n\n  private allAnimations: Set<AttributeAnimation<GraphicsAdapter>> = new Set();\n  private allLerps: Set<AttributeLerp<GraphicsAdapter>> = new Set();\n\n  private documentTimeTickListener: null | { remove: () => void } = null;\n\n  // Track if this helper has ticked at least once.\n  private hasTicked = false;\n\n  constructor(\n    private element: MElement<GraphicsAdapter>,\n    private handlers: AttributeHandlerRecord,\n  ) {\n    this.element = element;\n    this.reset();\n  }\n\n  public addSideEffectChild(child: MElement<GraphicsAdapter>): void {\n    if (AttributeAnimation.isAttributeAnimation(child)) {\n      const attr = child.getAnimatedAttributeName();\n      if (attr) {\n        this.addAnimation(child, attr);\n      }\n    } else if (AttributeLerp.isAttributeLerp(child)) {\n      const attr = child.getAnimatedAttributeName();\n      if (attr) {\n        this.addLerp(child, attr);\n      }\n    }\n  }\n\n  public removeSideEffectChild(child: MElement<GraphicsAdapter>): void {\n    if (AttributeAnimation.isAttributeAnimation(child)) {\n      const attr = child.getAnimatedAttributeName();\n      if (attr) {\n        this.removeAnimation(child, attr);\n      }\n    } else if (AttributeLerp.isAttributeLerp(child)) {\n      const attr = child.getAnimatedAttributeName();\n      if (attr) {\n        this.removeLerp(child, attr);\n      }\n    }\n  }\n\n  public elementSetAttribute(\n    key: string,\n    newValue: AnimationTypeToValueType<AnimationType> | null,\n  ) {\n    const state = this.stateByAttribute[key] as AnimationStateRecord<AnimationType>;\n    if (!state) {\n      return;\n    }\n    state.attributeState.elementValue = newValue;\n    if (this.hasTicked) {\n      state.attributeState.previousValue = state.attributeState.latestValue;\n    } else {\n      // If the element has not ticked yet, set the previous value to the new value to avoid lerping from the default value.\n      state.attributeState.previousValue = newValue;\n    }\n\n    if (this.element.isConnected) {\n      state.attributeState.elementValueSetTime = this.element.getWindowTime();\n    } else {\n      state.attributeState.elementValueSetTime = null;\n    }\n    if (state.animationsSet.size > 0 || state.lerpsSet.size > 0) {\n      return;\n    }\n    updateIfChangedValue(state, newValue);\n  }\n\n  public getAttributesForAttributeValue(attr: string): Array<string> {\n    // attr is in the format \"some-attr, another-attr\" or \"all\". Only return attributes that exist\n    if (attr === \"all\") {\n      return Object.keys(this.stateByAttribute);\n    }\n    return attr\n      .split(\",\")\n      .map((a) => a.trim())\n      .filter((a) => this.stateByAttribute[a]);\n  }\n\n  public addLerp(lerp: AttributeLerp<GraphicsAdapter>, attributeValue: string) {\n    const attributes = this.getAttributesForAttributeValue(attributeValue);\n    for (const key of attributes) {\n      const state = this.stateByAttribute[key];\n      if (!state) {\n        return;\n      }\n      if (state.animationsSet.size === 0 && state.lerpsSet.size === 0) {\n        // start listening to document time\n        this.documentTimeTickListener = this.element.addDocumentTimeTickListener((documentTime) => {\n          this.updateTime(documentTime);\n        });\n      }\n      this.allLerps.add(lerp);\n      state.lerpsSet.add(lerp);\n      state.lerpsInOrder = [];\n      const elementChildren = Array.from(this.element.children);\n      for (const child of elementChildren) {\n        if (state.lerpsSet.has(child as AttributeLerp<GraphicsAdapter>)) {\n          state.lerpsInOrder.push(child as AttributeLerp<GraphicsAdapter>);\n        }\n      }\n    }\n  }\n\n  public removeLerp(lerp: AttributeLerp<GraphicsAdapter>, attributeValue: string) {\n    const attributes = this.getAttributesForAttributeValue(attributeValue);\n    for (const key of attributes) {\n      const state = this.stateByAttribute[key];\n      if (!state) {\n        return;\n      }\n      state.lerpsInOrder.splice(state.lerpsInOrder.indexOf(lerp), 1);\n      state.lerpsSet.delete(lerp);\n      if (state.animationsSet.size === 0) {\n        updateIfChangedValue(state, state.attributeState.elementValue);\n      }\n      this.allLerps.delete(lerp);\n      if (this.allLerps.size === 0) {\n        // stop listening to document time\n        if (this.documentTimeTickListener) {\n          this.documentTimeTickListener.remove();\n          this.documentTimeTickListener = null;\n        }\n      }\n    }\n  }\n\n  public addAnimation(animation: AttributeAnimation<GraphicsAdapter>, key: string) {\n    const state = this.stateByAttribute[key];\n    if (!state) {\n      return;\n    }\n    if (state.animationsSet.size === 0 && state.lerpsSet.size === 0) {\n      // start listening to document time\n      this.documentTimeTickListener = this.element.addDocumentTimeTickListener((documentTime) => {\n        this.updateTime(documentTime);\n      });\n    }\n    this.allAnimations.add(animation);\n    state.animationsSet.add(animation);\n    state.animationsInOrder = [];\n    const elementChildren = Array.from(this.element.children);\n    for (const child of elementChildren) {\n      if (state.animationsSet.has(child as AttributeAnimation<GraphicsAdapter>)) {\n        state.animationsInOrder.push(child as AttributeAnimation<GraphicsAdapter>);\n      }\n    }\n  }\n\n  public removeAnimation(animation: AttributeAnimation<GraphicsAdapter>, key: string) {\n    const state = this.stateByAttribute[key];\n    if (!state) {\n      return;\n    }\n    state.animationsInOrder.splice(state.animationsInOrder.indexOf(animation), 1);\n    state.animationsSet.delete(animation);\n    if (state.animationsSet.size === 0) {\n      updateIfChangedValue(state, state.attributeState.elementValue);\n    }\n    this.allAnimations.delete(animation);\n    if (this.allAnimations.size === 0) {\n      // stop listening to document time\n      if (this.documentTimeTickListener) {\n        this.documentTimeTickListener.remove();\n        this.documentTimeTickListener = null;\n      }\n    }\n  }\n\n  public updateTime(documentTime: number) {\n    this.hasTicked = true;\n\n    for (const key in this.stateByAttribute) {\n      let stale: { value: number | MMLColor; state: number } | null = null;\n      const state = this.stateByAttribute[key];\n      for (const animation of state.animationsInOrder) {\n        const [newValue, active] =\n          state.attributeState.type === AnimationType.Color\n            ? animation.getColorValueForTime(documentTime)\n            : animation.getFloatValueForTime(documentTime);\n\n        if (active === 0) {\n          updateIfChangedValue(state, newValue);\n          stale = null;\n          break;\n        } else {\n          if (stale === null) {\n            stale = { value: newValue, state: active };\n          } else {\n            const isAboutToStartRatherThanEnded = stale.state > 0 && active < 0;\n            const isMoreRecentEnd = stale.state > 0 && active > 0 && stale.state > active;\n            const isSoonerToStart = stale.state < 0 && active < 0 && stale.state < active;\n\n            if (isAboutToStartRatherThanEnded || isMoreRecentEnd || isSoonerToStart) {\n              stale = { value: newValue, state: active };\n            }\n          }\n        }\n      }\n\n      if (stale !== null) {\n        updateIfChangedValue(state, stale.value);\n        continue;\n      }\n\n      if (state.lerpsInOrder.length > 0) {\n        const lerp = state.lerpsInOrder[0];\n        const config = state.attributeState;\n        if (\n          config.elementValueSetTime !== null &&\n          config.previousValue !== null &&\n          config.elementValue !== null\n        ) {\n          if (isColorAttribute(config)) {\n            updateIfChangedValue(\n              state,\n              lerp.getColorValueForTime(\n                this.element.getWindowTime(),\n                config.elementValueSetTime,\n                config.elementValue,\n                config.previousValue,\n              ),\n            );\n          } else if (isDegreesAttribute(config)) {\n            updateIfChangedValue(\n              state,\n              lerp.getFloatValueForTime(\n                this.element.getWindowTime(),\n                config.elementValueSetTime,\n                config.elementValue,\n                config.previousValue,\n                true,\n              ),\n            );\n          } else if (isNumberAttribute(config)) {\n            updateIfChangedValue(\n              state,\n              lerp.getFloatValueForTime(\n                this.element.getWindowTime(),\n                config.elementValueSetTime,\n                config.elementValue,\n                config.previousValue,\n                false,\n              ),\n            );\n          }\n        }\n      }\n    }\n  }\n\n  reset() {\n    for (const key in this.handlers) {\n      const state = TupleToState(this.handlers[key]);\n      this.stateByAttribute[key] = {\n        attributeState: state,\n        animationsInOrder: [],\n        animationsSet: new Set(),\n        lerpsInOrder: [],\n        lerpsSet: new Set(),\n      };\n    }\n  }\n}\n", "/* ============================================================\n * jQuery Easing v1.3 - http://gsgd.co.uk/sandbox/jquery/easing/\n *\n * Open source under the BSD License.\n *\n * Copyright \u00A9 2008 George McGinley Smith\n * All rights reserved.\n * https://raw.github.com/danro/jquery-easing/master/LICENSE\n * ======================================================== */\n\nexport const easingFunctions = {\n  easeInQuad(t: number, b: number, c: number, d: number): number {\n    return c * (t /= d) * t + b;\n  },\n  easeOutQuad(t: number, b: number, c: number, d: number): number {\n    return -c * (t /= d) * (t - 2) + b;\n  },\n  easeInOutQuad(t: number, b: number, c: number, d: number): number {\n    if ((t /= d / 2) < 1) return (c / 2) * t * t + b;\n    return (-c / 2) * (--t * (t - 2) - 1) + b;\n  },\n  easeInCubic(t: number, b: number, c: number, d: number): number {\n    return c * (t /= d) * t * t + b;\n  },\n  easeOutCubic(t: number, b: number, c: number, d: number): number {\n    return c * ((t = t / d - 1) * t * t + 1) + b;\n  },\n  easeInOutCubic(t: number, b: number, c: number, d: number): number {\n    if ((t /= d / 2) < 1) return (c / 2) * t * t * t + b;\n    return (c / 2) * ((t -= 2) * t * t + 2) + b;\n  },\n  easeInQuart(t: number, b: number, c: number, d: number): number {\n    return c * (t /= d) * t * t * t + b;\n  },\n  easeOutQuart(t: number, b: number, c: number, d: number): number {\n    return -c * ((t = t / d - 1) * t * t * t - 1) + b;\n  },\n  easeInOutQuart(t: number, b: number, c: number, d: number): number {\n    if ((t /= d / 2) < 1) return (c / 2) * t * t * t * t + b;\n    return (-c / 2) * ((t -= 2) * t * t * t - 2) + b;\n  },\n  easeInQuint(t: number, b: number, c: number, d: number): number {\n    return c * (t /= d) * t * t * t * t + b;\n  },\n  easeOutQuint(t: number, b: number, c: number, d: number): number {\n    return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n  },\n  easeInOutQuint(t: number, b: number, c: number, d: number): number {\n    if ((t /= d / 2) < 1) return (c / 2) * t * t * t * t * t + b;\n    return (c / 2) * ((t -= 2) * t * t * t * t + 2) + b;\n  },\n  easeInSine(t: number, b: number, c: number, d: number): number {\n    return -c * Math.cos((t / d) * (Math.PI / 2)) + c + b;\n  },\n  easeOutSine(t: number, b: number, c: number, d: number): number {\n    return c * Math.sin((t / d) * (Math.PI / 2)) + b;\n  },\n  easeInOutSine(t: number, b: number, c: number, d: number): number {\n    return (-c / 2) * (Math.cos((Math.PI * t) / d) - 1) + b;\n  },\n  easeInExpo(t: number, b: number, c: number, d: number): number {\n    return t === 0 ? b : c * Math.pow(2, 10 * (t / d - 1)) + b;\n  },\n  easeOutExpo(t: number, b: number, c: number, d: number): number {\n    return t === d ? b + c : c * (-Math.pow(2, (-10 * t) / d) + 1) + b;\n  },\n  easeInOutExpo(t: number, b: number, c: number, d: number): number {\n    if (t === 0) return b;\n    if (t === d) return b + c;\n    if ((t /= d / 2) < 1) return (c / 2) * Math.pow(2, 10 * (t - 1)) + b;\n    return (c / 2) * (-Math.pow(2, -10 * --t) + 2) + b;\n  },\n  easeInCirc(t: number, b: number, c: number, d: number): number {\n    return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;\n  },\n  easeOutCirc(t: number, b: number, c: number, d: number): number {\n    return c * Math.sqrt(1 - (t = t / d - 1) * t) + b;\n  },\n  easeInOutCirc(t: number, b: number, c: number, d: number): number {\n    if ((t /= d / 2) < 1) return (-c / 2) * (Math.sqrt(1 - t * t) - 1) + b;\n    return (c / 2) * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;\n  },\n  easeInElastic(t: number, b: number, c: number, d: number): number {\n    let s = 1.70158;\n    let p = 0;\n    let a = c;\n    if (t === 0) return b;\n    if ((t /= d) === 1) return b + c;\n    if (!p) p = d * 0.3;\n    if (a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = (p / (2 * Math.PI)) * Math.asin(c / a);\n    }\n    return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin(((t * d - s) * (2 * Math.PI)) / p)) + b;\n  },\n  easeOutElastic(t: number, b: number, c: number, d: number): number {\n    let s = 1.70158;\n    let p = 0;\n    let a = c;\n    if (t === 0) return b;\n    if ((t /= d) === 1) return b + c;\n    if (!p) p = d * 0.3;\n    if (a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = (p / (2 * Math.PI)) * Math.asin(c / a);\n    }\n    return a * Math.pow(2, -10 * t) * Math.sin(((t * d - s) * (2 * Math.PI)) / p) + c + b;\n  },\n  easeInOutElastic(t: number, b: number, c: number, d: number): number {\n    let s = 1.70158;\n    let p = 0;\n    let a = c;\n    if (t === 0) return b;\n    if ((t /= d / 2) === 2) return b + c;\n    if (!p) p = d * (0.3 * 1.5);\n    if (a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    } else {\n      s = (p / (2 * Math.PI)) * Math.asin(c / a);\n    }\n    if (t < 1)\n      return (\n        -0.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin(((t * d - s) * (2 * Math.PI)) / p)) + b\n      );\n    return (\n      a * Math.pow(2, -10 * (t -= 1)) * Math.sin(((t * d - s) * (2 * Math.PI)) / p) * 0.5 + c + b\n    );\n  },\n  easeInBack(t: number, b: number, c: number, d: number) {\n    const s = 1.70158;\n    return c * (t /= d) * t * ((s + 1) * t - s) + b;\n  },\n  easeOutBack(t: number, b: number, c: number, d: number) {\n    const s = 1.70158;\n    return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n  },\n  easeInOutBack(t: number, b: number, c: number, d: number) {\n    let s = 1.70158;\n    if ((t /= d / 2) < 1) return (c / 2) * (t * t * (((s *= 1.525) + 1) * t - s)) + b;\n    return (c / 2) * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2) + b;\n  },\n  easeInBounce(t: number, b: number, c: number, d: number): number {\n    return c - easingFunctions.easeOutBounce(d - t, 0, c, d) + b;\n  },\n  easeOutBounce(t: number, b: number, c: number, d: number): number {\n    if ((t /= d) < 1 / 2.75) {\n      return c * (7.5625 * t * t) + b;\n    } else if (t < 2 / 2.75) {\n      return c * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75) + b;\n    } else if (t < 2.5 / 2.75) {\n      return c * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375) + b;\n    } else {\n      return c * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375) + b;\n    }\n  },\n  easeInOutBounce(t: number, b: number, c: number, d: number): number {\n    if (t < d / 2) return easingFunctions.easeInBounce(t * 2, 0, c, d) * 0.5 + b;\n    return easingFunctions.easeOutBounce(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n  },\n};\n/*\n *\n * TERMS OF USE - EASING EQUATIONS\n *\n * Open source under the BSD License.\n *\n * Copyright \u00A9 2001 Robert Penner\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *\n * Redistributions of source code must retain the above copyright notice, this list of\n * conditions and the following disclaimer.\n * Redistributions in binary form must reproduce the above copyright notice, this list\n * of conditions and the following disclaimer in the documentation and/or other materials\n * provided with the distribution.\n *\n * Neither the name of the author nor the names of contributors may be used to endorse\n * or promote products derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE\n *  COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n *  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n *  GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED\n * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n *  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n * OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n */\n", "import { easingFunctions } from \"./easingFunctions\";\n\nexport const easingsByName: Record<\n  string,\n  (amount: number, base: number, change: number, duration: number) => number\n> = easingFunctions;\n", "import { easingsByName } from \"./easings\";\n\nexport const StartOfAnimationSymbol = Symbol(\"Start\");\nexport const EndOfAnimationSymbol = Symbol(\"End\");\n\n// Returns [current ratio | start | end symbols, state (negative if before start, zero if running, positive if after end)]\nexport function getEasedRatioForTime(\n  docTimeMs: number,\n  props: {\n    startTime: number;\n    pauseTime: number | null;\n    animDuration: number;\n    loop: boolean;\n    pingPong: boolean;\n    pingPongDelay: number;\n    easing: string;\n  },\n): [typeof StartOfAnimationSymbol | number | typeof EndOfAnimationSymbol, number] {\n  if (props.pauseTime !== null && docTimeMs >= props.pauseTime) {\n    docTimeMs = props.pauseTime;\n  }\n  let elapsedTime = docTimeMs - props.startTime;\n  if (elapsedTime < 0) {\n    return [StartOfAnimationSymbol, elapsedTime];\n  } else if (elapsedTime < props.animDuration || props.loop) {\n    if (props.loop) {\n      elapsedTime = elapsedTime % props.animDuration;\n    }\n    let elapsedRatio = elapsedTime / props.animDuration;\n    if (props.pingPong) {\n      let pingPongDelayRatio = props.pingPongDelay / props.animDuration;\n      if (pingPongDelayRatio < 0) {\n        pingPongDelayRatio = 0;\n      }\n      if (pingPongDelayRatio > 0.5) {\n        pingPongDelayRatio = 0.5;\n      }\n\n      /*\n       ping-pong-delay describes how long the animation should stay at the start and end values.\n       The attribute describes the delay at each end - therefore a ping-pong-delay of 1000 on a duration of 10000 means\n       that the animation should stay at the start value for 500ms, then animate to the end value up until 4500ms,\n       before waiting for 1000ms at the end value, and then animating back to the start value until 9500ms\n      */\n\n      if (elapsedRatio < pingPongDelayRatio / 2) {\n        elapsedRatio = 0;\n      } else if (\n        elapsedRatio > 0.5 - pingPongDelayRatio / 2 &&\n        elapsedRatio < 0.5 + pingPongDelayRatio / 2\n      ) {\n        elapsedRatio = 1;\n      } else if (elapsedRatio > 1 - pingPongDelayRatio / 2) {\n        elapsedRatio = 0;\n      } else {\n        // The loop should reach the end value at half the time and then return\n        // to the start value at the end of the loop.\n        if (elapsedRatio > 0.5) {\n          elapsedRatio =\n            ((elapsedRatio - 0.5 - pingPongDelayRatio / 2) * 2) / (1 - pingPongDelayRatio * 2);\n          elapsedRatio = 1 - elapsedRatio;\n        } else {\n          elapsedRatio =\n            ((elapsedRatio - pingPongDelayRatio / 2) * 2) / (1 - pingPongDelayRatio * 2);\n        }\n      }\n    }\n    let newValue;\n    const easingFunction = easingsByName[props.easing];\n    if (easingFunction) {\n      newValue = easingFunction(elapsedRatio, 0, 1, 1);\n    } else {\n      newValue = elapsedRatio;\n    }\n    return [newValue, 0];\n  } else {\n    if (props.pingPong) {\n      // ping-pong animations return to the start value at the end of their duration so the \"final\" state should be the start value.\n      return [StartOfAnimationSymbol, elapsedTime - props.animDuration];\n    }\n    return [EndOfAnimationSymbol, elapsedTime - props.animDuration];\n  }\n}\n", "// Largely based on https://github.com/mrdoob/three.js/blob/master/src/math/Quaternion.js\n\nimport { Matr4 } from \"./Matr4\";\n\nexport class Quat {\n  public x: number;\n  public y: number;\n  public z: number;\n  public w: number;\n\n  constructor(x?: number | Quat, y?: number, z?: number, w?: number) {\n    if (x instanceof Quat) {\n      this.x = x.x;\n      this.y = x.y;\n      this.z = x.z;\n      this.w = x.w;\n      return;\n    }\n    this.x = x || 0;\n    this.y = y || 0;\n    this.z = z || 0;\n    this.w = w || 1;\n  }\n\n  copy(other: { x?: number; y?: number; z?: number; w?: number }): this {\n    this.x = other.x || 0;\n    this.y = other.y || 0;\n    this.z = other.z || 0;\n    this.w = other.w || 0;\n    return this;\n  }\n\n  multiply(q: { x: number; y: number; z: number; w: number }): this {\n    return this.multiplyQuaternions(this, q);\n  }\n\n  premultiply(q: { x: number; y: number; z: number; w: number }): this {\n    return this.multiplyQuaternions(q, this);\n  }\n\n  multiplyQuaternions(\n    a: { x: number; y: number; z: number; w: number },\n    b: { x: number; y: number; z: number; w: number },\n  ): this {\n    const qax = a.x;\n    const qay = a.y;\n    const qaz = a.z;\n    const qaw = a.w;\n    const qbx = b.x;\n    const qby = b.y;\n    const qbz = b.z;\n    const qbw = b.w;\n\n    this.x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n    this.y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n    this.z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n    this.w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n    return this;\n  }\n\n  setFromEulerXYZ(euler: { x: number; y: number; z: number }): this {\n    const x = euler.x;\n    const y = euler.y;\n    const z = euler.z;\n\n    const cos = Math.cos;\n    const sin = Math.sin;\n\n    const c1 = cos(x / 2);\n    const c2 = cos(y / 2);\n    const c3 = cos(z / 2);\n\n    const s1 = sin(x / 2);\n    const s2 = sin(y / 2);\n    const s3 = sin(z / 2);\n\n    this.x = s1 * c2 * c3 + c1 * s2 * s3;\n    this.y = c1 * s2 * c3 - s1 * c2 * s3;\n    this.z = c1 * c2 * s3 + s1 * s2 * c3;\n    this.w = c1 * c2 * c3 - s1 * s2 * s3;\n\n    return this;\n  }\n\n  setFromRotationMatrix(m: Matr4): this {\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n    const te = m.data,\n      m11 = te[0],\n      m12 = te[4],\n      m13 = te[8],\n      m21 = te[1],\n      m22 = te[5],\n      m23 = te[9],\n      m31 = te[2],\n      m32 = te[6],\n      m33 = te[10],\n      trace = m11 + m22 + m33;\n\n    if (trace > 0) {\n      const s = 0.5 / Math.sqrt(trace + 1.0);\n\n      this.w = 0.25 / s;\n      this.x = (m32 - m23) * s;\n      this.y = (m13 - m31) * s;\n      this.z = (m21 - m12) * s;\n    } else if (m11 > m22 && m11 > m33) {\n      const s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);\n\n      this.w = (m32 - m23) / s;\n      this.x = 0.25 * s;\n      this.y = (m12 + m21) / s;\n      this.z = (m13 + m31) / s;\n    } else if (m22 > m33) {\n      const s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);\n\n      this.w = (m13 - m31) / s;\n      this.x = (m12 + m21) / s;\n      this.y = 0.25 * s;\n      this.z = (m23 + m32) / s;\n    } else {\n      const s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);\n\n      this.w = (m21 - m12) / s;\n      this.x = (m13 + m31) / s;\n      this.y = (m23 + m32) / s;\n      this.z = 0.25 * s;\n    }\n\n    return this;\n  }\n\n  setFromAxisAngle(axis: { x: number; y: number; z: number }, angle: number): this {\n    // assumes axis is normalized\n\n    const halfAngle = angle / 2;\n    const s = Math.sin(halfAngle);\n\n    this.x = axis.x * s;\n    this.y = axis.y * s;\n    this.z = axis.z * s;\n    this.w = Math.cos(halfAngle);\n\n    return this;\n  }\n\n  clone(): Quat {\n    return new Quat(this);\n  }\n\n  set(x: number, y: number, z: number, w: number): this {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    this.w = w;\n    return this;\n  }\n}\n", "import { Matr4Data } from \"./Matr4\";\n\nexport type IVect3 = { x: number; y: number; z: number };\n\nexport class Vect3 {\n  public x: number;\n  public y: number;\n  public z: number;\n\n  constructor(x?: number | IVect3, y?: number, z?: number) {\n    if (x && typeof x === \"object\") {\n      this.x = x.x;\n      this.y = x.y;\n      this.z = x.z;\n      return;\n    }\n    this.x = x || 0;\n    this.y = y || 0;\n    this.z = z || 0;\n  }\n\n  copy(other: IVect3): this {\n    this.x = other.x || 0;\n    this.y = other.y || 0;\n    this.z = other.z || 0;\n    return this;\n  }\n\n  length(): number {\n    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n  }\n\n  lengthSquared(): number {\n    return this.x * this.x + this.y * this.y + this.z * this.z;\n  }\n\n  clone(): Vect3 {\n    return new Vect3(this);\n  }\n\n  set(x: number, y: number, z: number): this {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    return this;\n  }\n\n  applyMatrix4(matrix: { data: Matr4Data }): this {\n    const x = this.x;\n    const y = this.y;\n    const z = this.z;\n    const e = matrix.data;\n\n    const w = 1 / (e[3] * x + e[7] * y + e[11] * z + e[15]);\n\n    this.x = (e[0] * x + e[4] * y + e[8] * z + e[12]) * w;\n    this.y = (e[1] * x + e[5] * y + e[9] * z + e[13]) * w;\n    this.z = (e[2] * x + e[6] * y + e[10] * z + e[14]) * w;\n\n    return this;\n  }\n\n  add(other: IVect3) {\n    this.x += other.x || 0;\n    this.y += other.y || 0;\n    this.z += other.z || 0;\n    return this;\n  }\n\n  sub(other: IVect3) {\n    this.x -= other.x || 0;\n    this.y -= other.y || 0;\n    this.z -= other.z || 0;\n    return this;\n  }\n}\n", "// Largely based on https://github.com/mrdoob/three.js/blob/master/src/math/Matrix4.js\nimport { Quat } from \"./Quat\";\nimport { Vect3 } from \"./Vect3\";\n\nconst Vect3Zeroes = { x: 0, y: 0, z: 0 };\nconst Vect3Ones = { x: 1, y: 1, z: 1 };\n\nexport type Matr4Data = [\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n  number,\n];\n\nexport class Matr4 {\n  static tempMatr4 = new Matr4();\n  static tempVect3 = new Vect3();\n  static tempQuat = new Quat();\n\n  public data: Matr4Data;\n\n  constructor(data?: Matr4Data | Matr4 | Float32Array) {\n    if (data instanceof Matr4) {\n      this.data = [...data.data];\n    } else if (data instanceof Array) {\n      this.data = [...data];\n    } else if (data instanceof Float32Array) {\n      this.data = [...data] as Matr4Data;\n    } else {\n      this.data = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n    }\n  }\n\n  identity(): this {\n    this.data = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n    return this;\n  }\n\n  copy(m: Matr4): Matr4 {\n    this.data = [...m.data];\n    return this;\n  }\n\n  set(...args: Matr4Data | [Matr4Data]): this {\n    if (args[0] instanceof Array) {\n      this.data = args[0];\n    } else {\n      this.data = args as Matr4Data;\n    }\n    return this;\n  }\n\n  public setRotationFromQuaternion(q: { x: number; y: number; z: number; w: number }): this {\n    return this.compose(Vect3Zeroes, q, Vect3Ones);\n  }\n\n  clone(): Matr4 {\n    return new Matr4(this.data);\n  }\n\n  determinant(): number {\n    const te = this.data;\n\n    const n11 = te[0],\n      n12 = te[4],\n      n13 = te[8],\n      n14 = te[12];\n    const n21 = te[1],\n      n22 = te[5],\n      n23 = te[9],\n      n24 = te[13];\n    const n31 = te[2],\n      n32 = te[6],\n      n33 = te[10],\n      n34 = te[14];\n    const n41 = te[3],\n      n42 = te[7],\n      n43 = te[11],\n      n44 = te[15];\n\n    return (\n      n41 *\n        (+n14 * n23 * n32 -\n          n13 * n24 * n32 -\n          n14 * n22 * n33 +\n          n12 * n24 * n33 +\n          n13 * n22 * n34 -\n          n12 * n23 * n34) +\n      n42 *\n        (+n11 * n23 * n34 -\n          n11 * n24 * n33 +\n          n14 * n21 * n33 -\n          n13 * n21 * n34 +\n          n13 * n24 * n31 -\n          n14 * n23 * n31) +\n      n43 *\n        (+n11 * n24 * n32 -\n          n11 * n22 * n34 -\n          n14 * n21 * n32 +\n          n12 * n21 * n34 +\n          n14 * n22 * n31 -\n          n12 * n24 * n31) +\n      n44 *\n        (-n13 * n22 * n31 -\n          n11 * n23 * n32 +\n          n11 * n22 * n33 +\n          n13 * n21 * n32 -\n          n12 * n21 * n33 +\n          n12 * n23 * n31)\n    );\n  }\n\n  makeRotationX(theta: number) {\n    const c = Math.cos(theta),\n      s = Math.sin(theta);\n\n    this.set(1, 0, 0, 0, 0, c, -s, 0, 0, s, c, 0, 0, 0, 0, 1);\n\n    return this;\n  }\n\n  makeRotationY(theta: number) {\n    const c = Math.cos(theta),\n      s = Math.sin(theta);\n\n    this.set(c, 0, s, 0, 0, 1, 0, 0, -s, 0, c, 0, 0, 0, 0, 1);\n\n    return this;\n  }\n\n  makeRotationZ(theta: number) {\n    const c = Math.cos(theta),\n      s = Math.sin(theta);\n\n    this.set(c, -s, 0, 0, s, c, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);\n    return this;\n  }\n\n  makeTranslation(x: number, y: number, z: number) {\n    this.set(1, 0, 0, x, 0, 1, 0, y, 0, 0, 1, z, 0, 0, 0, 1);\n    return this;\n  }\n\n  makeScale(x: number, y: number, z: number) {\n    this.set(x, 0, 0, 0, 0, y, 0, 0, 0, 0, z, 0, 0, 0, 0, 1);\n    return this;\n  }\n\n  compose(\n    position: { x: number; y: number; z: number },\n    quaternion: { x: number; y: number; z: number; w: number },\n    scale: { x: number; y: number; z: number },\n  ): this {\n    const te = this.data;\n\n    const x = quaternion.x,\n      y = quaternion.y,\n      z = quaternion.z,\n      w = quaternion.w;\n    const x2 = x + x,\n      y2 = y + y,\n      z2 = z + z;\n    const xx = x * x2,\n      xy = x * y2,\n      xz = x * z2;\n    const yy = y * y2,\n      yz = y * z2,\n      zz = z * z2;\n    const wx = w * x2,\n      wy = w * y2,\n      wz = w * z2;\n\n    const sx = scale.x,\n      sy = scale.y,\n      sz = scale.z;\n\n    te[0] = (1 - (yy + zz)) * sx;\n    te[1] = (xy + wz) * sx;\n    te[2] = (xz - wy) * sx;\n    te[3] = 0;\n\n    te[4] = (xy - wz) * sy;\n    te[5] = (1 - (xx + zz)) * sy;\n    te[6] = (yz + wx) * sy;\n    te[7] = 0;\n\n    te[8] = (xz + wy) * sz;\n    te[9] = (yz - wx) * sz;\n    te[10] = (1 - (xx + yy)) * sz;\n    te[11] = 0;\n\n    te[12] = position.x;\n    te[13] = position.y;\n    te[14] = position.z;\n    te[15] = 1;\n\n    return this;\n  }\n\n  decompose(\n    position: { x: number; y: number; z: number },\n    quaternion: { x: number; y: number; z: number; w: number },\n    scale: { x: number; y: number; z: number },\n  ): this {\n    const te = this.data;\n\n    const _v1 = Matr4.tempVect3;\n    let sx = _v1.set(te[0], te[1], te[2]).length();\n    const sy = _v1.set(te[4], te[5], te[6]).length();\n    const sz = _v1.set(te[8], te[9], te[10]).length();\n\n    // if determine is negative, we need to invert one scale\n    const det = this.determinant();\n    if (det < 0) sx = -sx;\n\n    position.x = te[12];\n    position.y = te[13];\n    position.z = te[14];\n\n    // scale the rotation part\n    const _m1 = Matr4.tempMatr4;\n    _m1.copy(this);\n\n    const invSX = 1 / sx;\n    const invSY = 1 / sy;\n    const invSZ = 1 / sz;\n\n    _m1.data[0] *= invSX;\n    _m1.data[1] *= invSX;\n    _m1.data[2] *= invSX;\n\n    _m1.data[4] *= invSY;\n    _m1.data[5] *= invSY;\n    _m1.data[6] *= invSY;\n\n    _m1.data[8] *= invSZ;\n    _m1.data[9] *= invSZ;\n    _m1.data[10] *= invSZ;\n\n    const _q1 = Matr4.tempQuat;\n    _q1.setFromRotationMatrix(_m1);\n\n    quaternion.x = _q1.x;\n    quaternion.y = _q1.y;\n    quaternion.z = _q1.z;\n    quaternion.w = _q1.w;\n\n    scale.x = sx;\n    scale.y = sy;\n    scale.z = sz;\n\n    return this;\n  }\n\n  multiply(m: Matr4): this {\n    return this.multiplyMatrices(this, m);\n  }\n\n  premultiply(m: Matr4): this {\n    return this.multiplyMatrices(m, this);\n  }\n\n  multiplyMatrices(a: Matr4, b: Matr4): this {\n    const ae = a.data;\n    const be = b.data;\n    const te = this.data;\n\n    const a11 = ae[0],\n      a12 = ae[4],\n      a13 = ae[8],\n      a14 = ae[12];\n    const a21 = ae[1],\n      a22 = ae[5],\n      a23 = ae[9],\n      a24 = ae[13];\n    const a31 = ae[2],\n      a32 = ae[6],\n      a33 = ae[10],\n      a34 = ae[14];\n    const a41 = ae[3],\n      a42 = ae[7],\n      a43 = ae[11],\n      a44 = ae[15];\n\n    const b11 = be[0],\n      b12 = be[4],\n      b13 = be[8],\n      b14 = be[12];\n    const b21 = be[1],\n      b22 = be[5],\n      b23 = be[9],\n      b24 = be[13];\n    const b31 = be[2],\n      b32 = be[6],\n      b33 = be[10],\n      b34 = be[14];\n    const b41 = be[3],\n      b42 = be[7],\n      b43 = be[11],\n      b44 = be[15];\n\n    te[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n    te[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n    te[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n    te[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n\n    te[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n    te[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n    te[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n    te[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n\n    te[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n    te[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n    te[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n    te[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n\n    te[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n    te[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n    te[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n    te[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n\n    return this;\n  }\n\n  invert(): this {\n    // based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n    const te = this.data,\n      n11 = te[0],\n      n21 = te[1],\n      n31 = te[2],\n      n41 = te[3],\n      n12 = te[4],\n      n22 = te[5],\n      n32 = te[6],\n      n42 = te[7],\n      n13 = te[8],\n      n23 = te[9],\n      n33 = te[10],\n      n43 = te[11],\n      n14 = te[12],\n      n24 = te[13],\n      n34 = te[14],\n      n44 = te[15],\n      t11 =\n        n23 * n34 * n42 -\n        n24 * n33 * n42 +\n        n24 * n32 * n43 -\n        n22 * n34 * n43 -\n        n23 * n32 * n44 +\n        n22 * n33 * n44,\n      t12 =\n        n14 * n33 * n42 -\n        n13 * n34 * n42 -\n        n14 * n32 * n43 +\n        n12 * n34 * n43 +\n        n13 * n32 * n44 -\n        n12 * n33 * n44,\n      t13 =\n        n13 * n24 * n42 -\n        n14 * n23 * n42 +\n        n14 * n22 * n43 -\n        n12 * n24 * n43 -\n        n13 * n22 * n44 +\n        n12 * n23 * n44,\n      t14 =\n        n14 * n23 * n32 -\n        n13 * n24 * n32 -\n        n14 * n22 * n33 +\n        n12 * n24 * n33 +\n        n13 * n22 * n34 -\n        n12 * n23 * n34;\n\n    const det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\n\n    if (det === 0) {\n      return this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\n    }\n\n    const detInv = 1 / det;\n\n    te[0] = t11 * detInv;\n    te[1] =\n      (n24 * n33 * n41 -\n        n23 * n34 * n41 -\n        n24 * n31 * n43 +\n        n21 * n34 * n43 +\n        n23 * n31 * n44 -\n        n21 * n33 * n44) *\n      detInv;\n    te[2] =\n      (n22 * n34 * n41 -\n        n24 * n32 * n41 +\n        n24 * n31 * n42 -\n        n21 * n34 * n42 -\n        n22 * n31 * n44 +\n        n21 * n32 * n44) *\n      detInv;\n    te[3] =\n      (n23 * n32 * n41 -\n        n22 * n33 * n41 -\n        n23 * n31 * n42 +\n        n21 * n33 * n42 +\n        n22 * n31 * n43 -\n        n21 * n32 * n43) *\n      detInv;\n\n    te[4] = t12 * detInv;\n    te[5] =\n      (n13 * n34 * n41 -\n        n14 * n33 * n41 +\n        n14 * n31 * n43 -\n        n11 * n34 * n43 -\n        n13 * n31 * n44 +\n        n11 * n33 * n44) *\n      detInv;\n    te[6] =\n      (n14 * n32 * n41 -\n        n12 * n34 * n41 -\n        n14 * n31 * n42 +\n        n11 * n34 * n42 +\n        n12 * n31 * n44 -\n        n11 * n32 * n44) *\n      detInv;\n    te[7] =\n      (n12 * n33 * n41 -\n        n13 * n32 * n41 +\n        n13 * n31 * n42 -\n        n11 * n33 * n42 -\n        n12 * n31 * n43 +\n        n11 * n32 * n43) *\n      detInv;\n\n    te[8] = t13 * detInv;\n    te[9] =\n      (n14 * n23 * n41 -\n        n13 * n24 * n41 -\n        n14 * n21 * n43 +\n        n11 * n24 * n43 +\n        n13 * n21 * n44 -\n        n11 * n23 * n44) *\n      detInv;\n    te[10] =\n      (n12 * n24 * n41 -\n        n14 * n22 * n41 +\n        n14 * n21 * n42 -\n        n11 * n24 * n42 -\n        n12 * n21 * n44 +\n        n11 * n22 * n44) *\n      detInv;\n    te[11] =\n      (n13 * n22 * n41 -\n        n12 * n23 * n41 -\n        n13 * n21 * n42 +\n        n11 * n23 * n42 +\n        n12 * n21 * n43 -\n        n11 * n22 * n43) *\n      detInv;\n\n    te[12] = t14 * detInv;\n    te[13] =\n      (n13 * n24 * n31 -\n        n14 * n23 * n31 +\n        n14 * n21 * n33 -\n        n11 * n24 * n33 -\n        n13 * n21 * n34 +\n        n11 * n23 * n34) *\n      detInv;\n    te[14] =\n      (n14 * n22 * n31 -\n        n12 * n24 * n31 -\n        n14 * n21 * n32 +\n        n11 * n24 * n32 +\n        n12 * n21 * n34 -\n        n11 * n22 * n34) *\n      detInv;\n    te[15] =\n      (n12 * n23 * n31 -\n        n13 * n22 * n31 +\n        n13 * n21 * n32 -\n        n11 * n23 * n32 -\n        n12 * n21 * n33 +\n        n11 * n22 * n33) *\n      detInv;\n\n    return this;\n  }\n}\n", "import { Matr4 } from \"../math/Matr4\";\nimport { IVect3, Vect3 } from \"../math/Vect3\";\n\n// Amount to tolerate on bounds (to avoid floating point errors)\nconst epsilon = 0.0001;\n\nconst matrix1 = new Matr4();\nconst vector1 = new Vect3();\n\nexport class OrientedBoundingBox {\n  private constructor(\n    public size: IVect3,\n    public matr4: Matr4,\n    public centerOffset: IVect3 | null = null,\n  ) {}\n\n  static fromSizeAndMatrixWorld(size: Vect3, matr4: Matr4): OrientedBoundingBox {\n    return new OrientedBoundingBox(size, matr4);\n  }\n\n  static fromSizeMatrixWorldAndCenter(\n    size: IVect3,\n    matr4: Matr4,\n    centerOffset: IVect3,\n  ): OrientedBoundingBox {\n    return new OrientedBoundingBox(size, matr4, centerOffset);\n  }\n\n  static fromMatrixWorld(matr4: Matr4): OrientedBoundingBox {\n    return new OrientedBoundingBox(new Vect3(), matr4);\n  }\n\n  public getCorners(): Vect3[] {\n    const corners: Vect3[] = [];\n    for (let x = -1; x <= 1; x += 2) {\n      for (let y = -1; y <= 1; y += 2) {\n        for (let z = -1; z <= 1; z += 2) {\n          const point = vector1.set(\n            x * (this.size.x / 2),\n            y * (this.size.y / 2),\n            z * (this.size.z / 2),\n          );\n\n          if (this.centerOffset !== null) {\n            point.add(this.centerOffset);\n          }\n\n          point.applyMatrix4(this.matr4);\n          corners.push(point.clone());\n        }\n      }\n    }\n    return corners;\n  }\n\n  public completelyContainsBoundingBox(childOBB: OrientedBoundingBox): boolean {\n    const invertedMatrix = matrix1.copy(this.matr4).invert();\n\n    for (let x = -1; x <= 1; x += 2) {\n      for (let y = -1; y <= 1; y += 2) {\n        for (let z = -1; z <= 1; z += 2) {\n          const point = vector1.set(\n            x * (childOBB.size.x / 2),\n            y * (childOBB.size.y / 2),\n            z * (childOBB.size.z / 2),\n          );\n\n          if (childOBB.centerOffset !== null) {\n            point.add(childOBB.centerOffset);\n          }\n\n          point.applyMatrix4(childOBB.matr4);\n\n          const localPoint = point.applyMatrix4(invertedMatrix);\n          if (this.centerOffset !== null) {\n            localPoint.sub(this.centerOffset);\n          }\n          const isWithin =\n            Math.abs(localPoint.x) <= this.size.x / 2 + epsilon &&\n            Math.abs(localPoint.y) <= this.size.y / 2 + epsilon &&\n            Math.abs(localPoint.z) <= this.size.z / 2 + epsilon;\n\n          if (!isWithin) {\n            return false;\n          }\n        }\n      }\n    }\n\n    return true;\n  }\n\n  public containsPoint(point: { x: number; y: number; z: number }): boolean {\n    const invertedMatrix = matrix1.copy(this.matr4).invert();\n\n    const localPoint = vector1.copy(point).applyMatrix4(invertedMatrix);\n    if (this.centerOffset !== null) {\n      localPoint.sub(this.centerOffset);\n    }\n    return (\n      Math.abs(localPoint.x) <= this.size.x / 2 + epsilon &&\n      Math.abs(localPoint.y) <= this.size.y / 2 + epsilon &&\n      Math.abs(localPoint.z) <= this.size.z / 2 + epsilon\n    );\n  }\n}\n", "export type RGBA = {\n  r: number;\n  g: number;\n  b: number;\n  a: number;\n};\n\nexport type CanvasTextOptions = {\n  fontSize: number;\n  textColorRGB255A1: RGBA;\n  backgroundColorRGB255A1?: RGBA;\n  font?: string;\n  bold?: boolean;\n  paddingPx?: number;\n  alignment?: string;\n  dimensions?: {\n    width: number;\n    height: number;\n  };\n};\n\nexport class CanvasText {\n  private canvas: HTMLCanvasElement;\n  private context: CanvasRenderingContext2D;\n\n  constructor() {\n    this.canvas = document.createElement(\"canvas\");\n    this.context = this.canvas.getContext(\"2d\") as CanvasRenderingContext2D;\n  }\n\n  public renderText(message: string, options: CanvasTextOptions): HTMLCanvasElement {\n    const fontsize = options.fontSize;\n    const textColor = options.textColorRGB255A1;\n    const backgroundColor = options.backgroundColorRGB255A1 || { r: 255, g: 255, b: 255, a: 1 };\n    const padding = options.paddingPx || 0;\n    const font = options.font || \"Arial\";\n    const fontString = (options.bold ? \"bold \" : \"\") + fontsize + \"px \" + font;\n\n    // calculate text alignment offset\n    const textAlign = (options.alignment as CanvasTextAlign) ?? \"left\";\n\n    if (options.dimensions) {\n      // NOTE: setting the canvas dimensions resets the context properties, so\n      // we always do it first\n      this.canvas.width = options.dimensions.width;\n      this.canvas.height = options.dimensions.height;\n      this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n      this.context.font = fontString;\n      this.context.textAlign = textAlign;\n      this.context.fillStyle = `rgba(${backgroundColor.r}, ${backgroundColor.g}, ${backgroundColor.b}, ${backgroundColor.a})`;\n      this.context.lineWidth = 0;\n      this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\n      this.context.fillStyle = `rgba(${textColor.r}, ${textColor.g}, ${textColor.b}, ${textColor.a})`;\n      this.context.font = fontString;\n      printAtWordWrap(\n        this.context,\n        message,\n        textAlign,\n        fontsize,\n        fontsize,\n        this.canvas.width,\n        padding,\n      );\n    } else {\n      // NOTE: setting the this.canvas dimensions resets the context properties, so\n      // we always do it first. However, we also need to take into account the\n      // font size to measure the text in the first place.\n      this.context.font = fontString;\n      const metrics = this.context.measureText(message);\n      const textWidth = metrics.width;\n      const textHeight = metrics.fontBoundingBoxAscent + metrics.fontBoundingBoxDescent;\n      this.canvas.width = textWidth + padding * 2;\n      this.canvas.height = textHeight + padding;\n      this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n      this.context.font = fontString;\n      this.context.textAlign = textAlign;\n      this.context.fillStyle = `rgba(${backgroundColor.r}, ${backgroundColor.g}, ${backgroundColor.b}, ${backgroundColor.a})`;\n      this.context.lineWidth = 0;\n      this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\n      this.context.fillStyle = `rgba(${textColor.r}, ${textColor.g}, ${textColor.b}, ${textColor.a})`;\n      this.context.font = fontString;\n      this.context.fillText(\n        message,\n        padding + getTextAlignOffset(textAlign, textWidth),\n        textHeight,\n      );\n    }\n\n    return this.canvas;\n  }\n}\n\nfunction printAtWordWrap(\n  context: CanvasRenderingContext2D,\n  fullText: string,\n  textAlign: CanvasTextAlign,\n  y: number,\n  lineHeight: number,\n  fitWidth: number,\n  padding: number,\n) {\n  const x = getTextAlignOffset(textAlign, fitWidth - padding * 2);\n  const lines = fullText.split(\"\\n\");\n  let currentLine = 0;\n  for (const text of lines) {\n    fitWidth = fitWidth || 0;\n\n    if (fitWidth <= 0) {\n      context.fillText(text, x, y + lineHeight * currentLine);\n      currentLine++;\n      continue;\n    }\n    let words = text.split(\" \");\n    let lastWordIndex = 1;\n    while (words.length > 0 && lastWordIndex <= words.length) {\n      const str = words.slice(0, lastWordIndex).join(\" \");\n      const textWidth = context.measureText(str).width;\n      if (textWidth + padding * 2 > fitWidth) {\n        if (lastWordIndex === 1) {\n          lastWordIndex = 2;\n        }\n        context.fillText(\n          words.slice(0, lastWordIndex - 1).join(\" \"),\n          x + padding,\n          y + lineHeight * currentLine + padding,\n        );\n        currentLine++;\n        words = words.splice(lastWordIndex - 1);\n        lastWordIndex = 1;\n      } else {\n        lastWordIndex++;\n      }\n    }\n    if (lastWordIndex > 0 && words.length > 0) {\n      context.fillText(words.join(\" \"), x + padding, y + lineHeight * currentLine + padding);\n      currentLine++;\n    }\n  }\n}\n\nfunction getTextAlignOffset(textAlign: CanvasTextAlign, width: number) {\n  switch (textAlign) {\n    case \"center\":\n      return width / 2;\n    case \"right\":\n      return width;\n    default:\n      return 0;\n  }\n}\n", "import { AttributeHandler, parseBoolAttribute } from \"../attributes\";\nimport { MElement } from \"../elements\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { IMMLScene } from \"../scene\";\n\nconst collideAttributeName = \"collide\";\nconst collisionIntervalAttributeName = \"collision-interval\";\nconst defaultCollideable = true;\n\n/**\n * CollideableHelper is a helper class for MML elements that have meshes that should be able to be collided with.\n *\n * It reacts to the attribute values for the collide and collision-interval attributes and adds, updates, or removes the\n * collider from the MMLScene as appropriate.\n */\nexport class CollideableHelper<G extends GraphicsAdapter = GraphicsAdapter> {\n  private element: MElement<G>;\n\n  private props = {\n    collide: defaultCollideable,\n  };\n\n  static AttributeHandler = new AttributeHandler<CollideableHelper<GraphicsAdapter>>({\n    [collideAttributeName]: (instance, newValue) => {\n      const collide = parseBoolAttribute(newValue, defaultCollideable);\n      if (collide !== instance.props.collide) {\n        instance.props.collide = collide;\n        instance.updateCollider(instance.collider);\n      }\n    },\n    [collisionIntervalAttributeName]: () => {\n      // Collision interval is handled by the MMLCollisionTrigger, but is here for completeness of attribute handling\n    },\n  });\n  static observedAttributes = CollideableHelper.AttributeHandler.getAttributes();\n\n  constructor(element: MElement<G>) {\n    this.element = element;\n  }\n\n  private scene: IMMLScene<G> | null = null;\n  private collider: unknown | null = null;\n  private added: boolean = false;\n  private enabled: boolean = true;\n\n  public enable() {\n    if (this.enabled) {\n      return;\n    }\n\n    this.enabled = true;\n    this.updateCollider(this.collider);\n  }\n\n  public disable() {\n    if (!this.enabled) {\n      return;\n    }\n\n    this.enabled = false;\n    this.updateCollider(this.collider);\n  }\n\n  public updateCollider(collider: unknown | null) {\n    if (!this.element.isConnected) {\n      //element not connected to scene yet - keep track of the collider for when it is connected\n      this.collider = collider;\n      return;\n    }\n\n    // store the scene so that colliders can be removed from it even after this node has been removed from the DOM.\n    this.scene = this.element.getScene();\n\n    const previousCollider = this.collider;\n    const colliderChanged = previousCollider !== collider;\n    if (colliderChanged) {\n      this.added = false;\n    }\n    this.collider = collider;\n\n    const shouldEnableCollider = this.props.collide && this.enabled;\n    if (!shouldEnableCollider && previousCollider === null) {\n      this.added = false;\n      return;\n    }\n\n    if (shouldEnableCollider) {\n      if (colliderChanged && previousCollider !== null) {\n        this.scene.removeCollider?.(previousCollider, this.element);\n      }\n      if (collider !== null) {\n        if (this.added) {\n          this.scene.updateCollider?.(collider, this.element);\n        } else {\n          this.added = true;\n          this.scene.addCollider?.(collider, this.element);\n        }\n      }\n    } else {\n      if (previousCollider !== null) {\n        this.added = false;\n        this.scene.removeCollider?.(previousCollider, this.element);\n      }\n    }\n  }\n\n  public removeColliders() {\n    const scene = this.scene;\n    if (!scene) {\n      // colliders were never added or the scene was already torn down\n      return;\n    }\n\n    if (!this.collider) {\n      // no primary object yet, so nothing to collide with\n      return;\n    }\n\n    scene.removeCollider?.(this.collider, this.element);\n\n    this.scene = null;\n  }\n\n  public handle(name: string, newValue: string) {\n    CollideableHelper.AttributeHandler.handle(this, name, newValue);\n  }\n\n  public parentTransformed() {\n    this.updateCollider(this.collider);\n  }\n}\n", "import { MElement } from \"../elements\";\nimport { GraphicsAdapter } from \"../graphics\";\n\nexport type CollisionData = {\n  position: { x: number; y: number; z: number };\n};\n\nexport type ColliderData<T> = {\n  collider: T;\n  mElement: MElement<GraphicsAdapter>;\n  currentlyColliding: boolean;\n  lastUpdate: number;\n};\n\nconst collisionIntervalMinimumMilliseconds = 100;\nconst collisionIntervalAttrName = \"collision-interval\";\nexport const collisionStartEventName = \"collisionstart\";\nexport const collisionMoveEventName = \"collisionmove\";\nexport const collisionEndEventName = \"collisionend\";\n\nexport function getCollisionInterval(mElement: MElement<GraphicsAdapter>): null | number {\n  const collisionEventsAttr = mElement.getAttribute(collisionIntervalAttrName);\n  if (collisionEventsAttr === null) {\n    return null;\n  }\n  const parsed = parseFloat(collisionEventsAttr);\n  if (isNaN(parsed)) {\n    return null;\n  }\n  return parsed;\n}\n\n/**\n * The MMLCollisionTrigger class is responsible for keeping track of which colliders the \"user\" (avatar) is currently\n * colliding with, and dispatches events to the elements if they are listening for collisions.\n */\nexport class MMLCollisionTrigger<T> {\n  private colliderToElementMap = new Map<T, ColliderData<T>>();\n  private currentCollidingColliders = new Set<T>();\n\n  static init<T>(): MMLCollisionTrigger<T> {\n    return new MMLCollisionTrigger();\n  }\n\n  public setCurrentCollisions(currentCollisions: Map<T, CollisionData> | null) {\n    const currentTime = performance.now();\n    if (currentCollisions) {\n      for (const [collider, collisionData] of currentCollisions) {\n        const colliderData = this.colliderToElementMap.get(collider);\n        if (colliderData) {\n          let listeningInterval = getCollisionInterval(colliderData.mElement);\n          if (listeningInterval === null) {\n            // Not listening for collisions - if colliding then record stopping\n            if (colliderData.currentlyColliding) {\n              colliderData.lastUpdate = currentTime;\n              colliderData.currentlyColliding = false;\n            }\n          } else {\n            if (listeningInterval < collisionIntervalMinimumMilliseconds) {\n              listeningInterval = collisionIntervalMinimumMilliseconds;\n            }\n            if (colliderData.lastUpdate < currentTime - listeningInterval) {\n              colliderData.lastUpdate = currentTime;\n              if (!colliderData.currentlyColliding) {\n                colliderData.currentlyColliding = true;\n                colliderData.mElement.dispatchEvent(\n                  new CustomEvent(collisionStartEventName, {\n                    bubbles: true,\n                    detail: {\n                      position: collisionData.position,\n                    },\n                  }),\n                );\n                this.currentCollidingColliders.add(collider);\n              } else {\n                colliderData.mElement.dispatchEvent(\n                  new CustomEvent(collisionMoveEventName, {\n                    bubbles: true,\n                    detail: {\n                      position: collisionData.position,\n                    },\n                  }),\n                );\n              }\n            }\n          }\n        }\n      }\n    }\n    for (const collider of this.currentCollidingColliders) {\n      if (!currentCollisions?.has(collider)) {\n        this.currentCollidingColliders.delete(collider);\n        const colliderData = this.colliderToElementMap.get(collider);\n        if (colliderData) {\n          colliderData.lastUpdate = currentTime;\n          colliderData.currentlyColliding = false;\n          colliderData.mElement.dispatchEvent(\n            new CustomEvent(collisionEndEventName, {\n              bubbles: true,\n              detail: {},\n            }),\n          );\n        }\n      }\n    }\n  }\n\n  public addCollider(collider: T, mElement: MElement<GraphicsAdapter>) {\n    this.colliderToElementMap.set(collider, {\n      collider,\n      currentlyColliding: false,\n      mElement,\n      lastUpdate: 0,\n    });\n  }\n\n  public removeCollider(collider: T) {\n    this.colliderToElementMap.delete(collider);\n    this.currentCollidingColliders.delete(collider);\n  }\n}\n", "import { AttributeHandler, parseBoolAttribute } from \"../attributes\";\n\nconst clickableAttributeName = \"clickable\";\nconst defaultClickable = true;\n\n/**\n * ClickableHelper is a helper class for MML elements that have a \"clickable\" attribute that can be changed.\n *\n * It reacts to the attribute values for clickable. It is minimal, but avoids the boilerplate being present in many classes.\n */\nexport class ClickableHelper {\n  private props = {\n    clickable: defaultClickable,\n  };\n\n  static AttributeHandler = new AttributeHandler<ClickableHelper>({\n    [clickableAttributeName]: (instance, newValue) => {\n      const clickable = parseBoolAttribute(newValue, defaultClickable);\n      if (clickable !== instance.props.clickable) {\n        instance.props.clickable = clickable;\n      }\n    },\n  });\n  static observedAttributes = ClickableHelper.AttributeHandler.getAttributes();\n\n  constructor() {}\n\n  public isClickable(): boolean {\n    return this.props.clickable;\n  }\n\n  public handle(name: string, newValue: string) {\n    ClickableHelper.AttributeHandler.handle(this, name, newValue);\n  }\n}\n", "import { parseBoolAttribute } from \"../attributes\";\nimport { MElement } from \"../elements\";\nimport { DebugHelperGraphics, GraphicsAdapter } from \"../graphics\";\n\nconst debugAttributeName = \"debug\";\n\nexport class DebugHelper<G extends GraphicsAdapter = GraphicsAdapter> {\n  static observedAttributes = [debugAttributeName];\n\n  private debugGraphics: DebugHelperGraphics<G> | null = null;\n\n  constructor(public element: MElement<G>) {}\n\n  public getContainer(): G[\"containerType\"] {\n    return this.element.getContainer();\n  }\n\n  public handle(name: string, newValue: string) {\n    if (name === debugAttributeName) {\n      if (parseBoolAttribute(newValue, false)) {\n        if (!this.debugGraphics) {\n          this.debugGraphics = this.element\n            .getScene()\n            .getGraphicsAdapter()\n            .getGraphicsAdapterFactory()\n            .MMLDebugHelperGraphicsInterface(this);\n        }\n      } else {\n        this.debugGraphics?.dispose();\n        this.debugGraphics = null;\n      }\n    }\n  }\n\n  public dispose() {\n    this.debugGraphics?.dispose();\n    this.debugGraphics = null;\n  }\n}\n", "// Largely based on https://github.com/mrdoob/three.js/blob/master/src/math/Euler.js\nimport { Matr4 } from \"./Matr4\";\n\nfunction clamp(value: number, min: number, max: number) {\n  return Math.max(min, Math.min(max, value));\n}\n\nexport class EulXYZ {\n  private static tempMatrix = new Matr4();\n  public x: number;\n  public y: number;\n  public z: number;\n\n  constructor(x?: number | EulXYZ, y?: number, z?: number) {\n    if (x instanceof EulXYZ) {\n      this.x = x.x;\n      this.y = x.y;\n      this.z = x.z;\n      return;\n    }\n    this.x = x || 0;\n    this.y = y || 0;\n    this.z = z || 0;\n  }\n\n  setFromRotationMatrix(m: Matr4): this {\n    const d = m.data;\n    const m11 = d[0];\n    const m12 = d[4];\n    const m13 = d[8];\n    const m22 = d[5];\n    const m23 = d[9];\n    const m32 = d[6];\n    const m33 = d[10];\n\n    this.y = Math.asin(clamp(m13, -1, 1));\n\n    if (Math.abs(m13) < 0.9999999) {\n      this.x = Math.atan2(-m23, m33);\n      this.z = Math.atan2(-m12, m11);\n    } else {\n      this.x = Math.atan2(m32, m22);\n      this.z = 0;\n    }\n\n    return this;\n  }\n\n  setFromQuaternion(q: { x: number; y: number; z: number; w: number }): this {\n    const matrix = EulXYZ.tempMatrix;\n    matrix.setRotationFromQuaternion(q);\n    return this.setFromRotationMatrix(matrix);\n  }\n\n  copy(other: { x?: number; y?: number; z?: number }): this {\n    this.x = other.x || 0;\n    this.y = other.y || 0;\n    this.z = other.z || 0;\n    return this;\n  }\n\n  length(): number {\n    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n  }\n\n  lengthSquared(): number {\n    return this.x * this.x + this.y * this.y + this.z * this.z;\n  }\n\n  clone(): EulXYZ {\n    return new EulXYZ(this);\n  }\n\n  set(x: number, y: number, z: number): this {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    return this;\n  }\n}\n", "export function radToDeg(rad: number): number {\n  return rad * (180 / Math.PI);\n}\n\nexport function degToRad(deg: number): number {\n  return deg * (Math.PI / 180);\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport { AttributeHandler, parseBoolAttribute, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { DebugHelper } from \"../debug-helper\";\nimport { GraphicsAdapter, TransformableGraphics } from \"../graphics\";\nimport { degToRad, IVect3, Matr4, Quat, Vect3 } from \"../math\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\n\n// Workaround for zero-scale values breaking audio playback in THREE PositionalAudio\nfunction minimumNonZero(value: number): number {\n  return value === 0 ? 0.000001 : value;\n}\n\nconst defaultVisible = true;\n\nexport type TransformableElementProps = {\n  socket: string | null;\n  x: number;\n  y: number;\n  z: number;\n  rx: number;\n  ry: number;\n  rz: number;\n  sx: number;\n  sy: number;\n  sz: number;\n};\n\nexport abstract class TransformableElement<\n  G extends GraphicsAdapter = GraphicsAdapter,\n> extends MElement<G> {\n  public readonly isTransformableElement = true;\n\n  private static tempQuat = new Quat();\n\n  private transformableElementProps: TransformableElementProps = {\n    socket: null,\n    x: 0,\n    y: 0,\n    z: 0,\n    rx: 0,\n    ry: 0,\n    rz: 0,\n    sx: 1,\n    sy: 1,\n    sz: 1,\n  };\n\n  private desiredVisible = defaultVisible;\n  private appliedBounds = new Map<unknown, OrientedBoundingBox>();\n  protected directlyDisabledByBounds = false;\n  protected disabledByParent = false;\n\n  protected transformableElementGraphics: TransformableGraphics<G> | null = null;\n\n  public static isTransformableElement(element: object): element is TransformableElement {\n    return (element as TransformableElement).isTransformableElement;\n  }\n\n  private getTransformableElementParent(): TransformableElement<G> | null {\n    let parentNode = this.parentNode;\n    while (parentNode != null) {\n      if (TransformableElement.isTransformableElement(parentNode)) {\n        return parentNode as TransformableElement<G>;\n      }\n      parentNode = parentNode.parentNode;\n    }\n    return null;\n  }\n\n  calculateLocalMatrix(matrix: Matr4): void {\n    const pos = {\n      x: this.transformableElementProps.x,\n      y: this.transformableElementProps.y,\n      z: this.transformableElementProps.z,\n    };\n    const eulerXYZRotation = {\n      x: degToRad(this.transformableElementProps.rx),\n      y: degToRad(this.transformableElementProps.ry),\n      z: degToRad(this.transformableElementProps.rz),\n    };\n    const scale = {\n      x: this.transformableElementProps.sx,\n      y: this.transformableElementProps.sy,\n      z: this.transformableElementProps.sz,\n    };\n    const quaternion = TransformableElement.tempQuat;\n    quaternion.setFromEulerXYZ(eulerXYZRotation);\n    matrix.compose(pos, quaternion, scale);\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.transformableElementGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.transformableElementGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLTransformableGraphicsInterface(this);\n\n    const mElementParent = this.getTransformableElementParent();\n    if (mElementParent) {\n      const parentBounds = mElementParent.getAppliedBounds();\n      parentBounds.forEach((orientedBox, ref) => {\n        this.addOrUpdateParentBound(ref, orientedBox);\n      });\n      return;\n    }\n  }\n\n  disconnectedCallback(): void {\n    this.transformableAnimatedAttributeHelper.reset();\n    this.transformableElementGraphics?.dispose();\n    this.debugHelper.dispose();\n    this.transformableElementGraphics = null;\n    super.disconnectedCallback();\n  }\n\n  private transformableAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    x: [\n      AnimationType.Number,\n      0,\n      (newValue: number) => {\n        this.transformableElementProps.x = newValue;\n        this.transformableElementGraphics?.setX(newValue, this.transformableElementProps);\n        this.didUpdateTransformation();\n      },\n    ],\n    y: [\n      AnimationType.Number,\n      0,\n      (newValue: number) => {\n        this.transformableElementProps.y = newValue;\n        this.transformableElementGraphics?.setY(newValue, this.transformableElementProps);\n        this.didUpdateTransformation();\n      },\n    ],\n    z: [\n      AnimationType.Number,\n      0,\n      (newValue: number) => {\n        this.transformableElementProps.z = newValue;\n        this.transformableElementGraphics?.setZ(newValue, this.transformableElementProps);\n        this.didUpdateTransformation();\n      },\n    ],\n    rx: [\n      AnimationType.Degrees,\n      0,\n      (newValue: number) => {\n        this.transformableElementProps.rx = newValue;\n        this.transformableElementGraphics?.setRotationX(newValue, this.transformableElementProps);\n        this.didUpdateTransformation();\n      },\n    ],\n    ry: [\n      AnimationType.Degrees,\n      0,\n      (newValue: number) => {\n        this.transformableElementProps.ry = newValue;\n        this.transformableElementGraphics?.setRotationY(newValue, this.transformableElementProps);\n        this.didUpdateTransformation();\n      },\n    ],\n    rz: [\n      AnimationType.Degrees,\n      0,\n      (newValue: number) => {\n        this.transformableElementProps.rz = newValue;\n        this.transformableElementGraphics?.setRotationZ(newValue, this.transformableElementProps);\n        this.didUpdateTransformation();\n      },\n    ],\n    sx: [\n      AnimationType.Number,\n      1,\n      (newValue: number) => {\n        this.transformableElementProps.sx = newValue;\n        this.transformableElementGraphics?.setScaleX(\n          minimumNonZero(newValue),\n          this.transformableElementProps,\n        );\n        this.didUpdateTransformation();\n      },\n    ],\n    sy: [\n      AnimationType.Number,\n      1,\n      (newValue: number) => {\n        this.transformableElementProps.sy = newValue;\n        this.transformableElementGraphics?.setScaleY(\n          minimumNonZero(newValue),\n          this.transformableElementProps,\n        );\n        this.didUpdateTransformation();\n      },\n    ],\n    sz: [\n      AnimationType.Number,\n      1,\n      (newValue: number) => {\n        this.transformableElementProps.sz = newValue;\n        this.transformableElementGraphics?.setScaleZ(\n          minimumNonZero(newValue),\n          this.transformableElementProps,\n        );\n        this.didUpdateTransformation();\n      },\n    ],\n  });\n\n  private static TransformableElementAttributeHandler = new AttributeHandler<\n    TransformableElement<GraphicsAdapter>\n  >({\n    x: (instance, newValue) => {\n      instance.transformableAnimatedAttributeHelper.elementSetAttribute(\n        \"x\",\n        parseFloatAttribute(newValue, 0),\n      );\n    },\n    y: (instance, newValue) => {\n      instance.transformableAnimatedAttributeHelper.elementSetAttribute(\n        \"y\",\n        parseFloatAttribute(newValue, 0),\n      );\n    },\n    z: (instance, newValue) => {\n      instance.transformableAnimatedAttributeHelper.elementSetAttribute(\n        \"z\",\n        parseFloatAttribute(newValue, 0),\n      );\n    },\n    rx: (instance, newValue) => {\n      instance.transformableAnimatedAttributeHelper.elementSetAttribute(\n        \"rx\",\n        parseFloatAttribute(newValue, 0),\n      );\n    },\n    ry: (instance, newValue) => {\n      instance.transformableAnimatedAttributeHelper.elementSetAttribute(\n        \"ry\",\n        parseFloatAttribute(newValue, 0),\n      );\n    },\n    rz: (instance, newValue) => {\n      instance.transformableAnimatedAttributeHelper.elementSetAttribute(\n        \"rz\",\n        parseFloatAttribute(newValue, 0),\n      );\n    },\n    sx: (instance, newValue) => {\n      instance.transformableAnimatedAttributeHelper.elementSetAttribute(\n        \"sx\",\n        parseFloatAttribute(newValue, 1),\n      );\n    },\n    sy: (instance, newValue) => {\n      instance.transformableAnimatedAttributeHelper.elementSetAttribute(\n        \"sy\",\n        parseFloatAttribute(newValue, 1),\n      );\n    },\n    sz: (instance, newValue) => {\n      instance.transformableAnimatedAttributeHelper.elementSetAttribute(\n        \"sz\",\n        parseFloatAttribute(newValue, 1),\n      );\n    },\n    visible: (instance, newValue) => {\n      instance.desiredVisible = parseBoolAttribute(newValue, defaultVisible);\n      instance.updateVisibility();\n    },\n    socket: (instance, newValue) => {\n      instance.transformableElementProps.socket = newValue;\n      instance.transformableElementGraphics?.setSocket(\n        newValue,\n        instance.transformableElementProps,\n      );\n      instance.applyBounds();\n    },\n  });\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.TransformableElementAttributeHandler.getAttributes(),\n      ...DebugHelper.observedAttributes,\n    ];\n  }\n\n  private debugHelper = new DebugHelper(this);\n\n  public abstract getContentBounds(): OrientedBoundingBox | null;\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.transformableAnimatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.transformableAnimatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  protected applyBounds() {\n    if (!this.transformableElementGraphics) {\n      // This element hasn't been connected yet - ignore the bounds application as it will be applied when connected\n      return;\n    }\n    const appliedBounds = this.getAppliedBounds();\n    if (appliedBounds.size > 0) {\n      const thisElementBounds = this.getContentBounds();\n      if (thisElementBounds) {\n        for (const [, orientedBox] of appliedBounds) {\n          if (!orientedBox.completelyContainsBoundingBox(thisElementBounds)) {\n            if (!this.directlyDisabledByBounds) {\n              this.disabledByBounds();\n            }\n            return;\n          }\n        }\n      }\n    }\n    this.reenableByBounds();\n  }\n\n  public didUpdateTransformation() {\n    this.applyBounds();\n    this.parentTransformed();\n    traverseImmediateTransformableElementChildren(this, (child) => {\n      child.didUpdateTransformation();\n    });\n  }\n\n  public attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.transformableElementGraphics) {\n      return;\n    }\n\n    TransformableElement.TransformableElementAttributeHandler.handle(this, name, newValue);\n    this.debugHelper.handle(name, newValue);\n  }\n\n  protected getAppliedBounds(): Map<unknown, OrientedBoundingBox> {\n    return this.appliedBounds;\n  }\n\n  public addOrUpdateParentBound(ref: unknown, orientedBox: OrientedBoundingBox): void {\n    this.appliedBounds.set(ref, orientedBox);\n    traverseImmediateTransformableElementChildren(this, (child) => {\n      child.addOrUpdateParentBound(ref, orientedBox);\n    });\n    this.applyBounds();\n  }\n\n  public removeParentBound(ref: unknown): void {\n    this.appliedBounds.delete(ref);\n    traverseImmediateTransformableElementChildren(this, (child) => {\n      child.removeParentBound(ref);\n    });\n    this.applyBounds();\n  }\n\n  protected disabledByBounds() {\n    if (this.directlyDisabledByBounds) {\n      return;\n    }\n    this.directlyDisabledByBounds = true;\n    this.updateVisibility();\n    if (this.disabledByParent) {\n      return;\n    }\n    this.disable();\n\n    traverseImmediateTransformableElementChildren(this, (child) => {\n      child.disabledByParentBounds();\n    });\n  }\n\n  public isDisabled() {\n    return this.directlyDisabledByBounds || this.disabledByParent;\n  }\n\n  protected disabledByParentBounds() {\n    if (this.disabledByParent) {\n      return;\n    }\n    this.disabledByParent = true;\n    this.updateVisibility();\n    if (this.directlyDisabledByBounds) {\n      return;\n    }\n    this.disable();\n\n    traverseImmediateTransformableElementChildren(this, (child) => {\n      child.disabledByParentBounds();\n    });\n  }\n\n  protected abstract disable(): void;\n\n  protected reenableByBounds() {\n    if (!this.directlyDisabledByBounds) {\n      return;\n    }\n\n    this.directlyDisabledByBounds = false;\n\n    if (!this.disabledByParent) {\n      this.updateVisibility();\n      this.enable();\n\n      traverseImmediateTransformableElementChildren(this, (child) => {\n        child.reenableByParentBounds();\n      });\n    }\n  }\n\n  protected reenableByParentBounds() {\n    if (!this.disabledByParent) {\n      return;\n    }\n    this.disabledByParent = false;\n\n    if (!this.directlyDisabledByBounds) {\n      this.updateVisibility();\n      this.enable();\n\n      traverseImmediateTransformableElementChildren(this, (child) => {\n        child.reenableByParentBounds();\n      });\n    }\n  }\n\n  protected abstract enable(): void;\n\n  private updateVisibility() {\n    this.transformableElementGraphics?.setVisible(\n      this.desiredVisible && !this.isDisabled(),\n      this.transformableElementProps,\n    );\n  }\n\n  public getVisible(): boolean {\n    return this.transformableElementGraphics?.getVisible() ?? false;\n  }\n\n  public getWorldPosition(): IVect3 {\n    return this.transformableElementGraphics?.getWorldPosition() ?? new Vect3(0, 0, 0);\n  }\n\n  public getLocalPosition(): IVect3 {\n    return this.transformableElementGraphics?.getLocalPosition() ?? new Vect3(0, 0, 0);\n  }\n}\n\nfunction traverseImmediateTransformableElementChildren<G extends GraphicsAdapter = GraphicsAdapter>(\n  element: ChildNode,\n  callback: (element: TransformableElement<G>) => void,\n) {\n  element.childNodes.forEach((child) => {\n    if (TransformableElement.isTransformableElement(child)) {\n      callback(child as TransformableElement<G>);\n    } else {\n      traverseImmediateTransformableElementChildren(child, callback);\n    }\n  });\n}\n", "import { AttributeHandler, parseBoolAttribute, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { ClickableHelper } from \"../clickable/ClickableHelper\";\nimport { CollideableHelper } from \"../collision\";\nimport { GraphicsAdapter, ModelGraphics } from \"../graphics\";\nimport { Animation } from \"./Animation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultModelSrc = null;\nconst defaultModelAnim = null;\nconst defaultModelAnimLoop = true;\nconst defaultModelAnimEnabled = true;\nconst defaultModelAnimStartTime = 0;\nconst defaultModelAnimPauseTime = null;\nconst defaultModelCastShadows = true;\nconst defaultModelDebug = false;\n\nexport type MModelProps = {\n  src: string | null;\n  anim: string | null;\n  animLoop: boolean;\n  animEnabled: boolean;\n  animStartTime: number;\n  animPauseTime: number | null;\n  castShadows: boolean;\n  debug: boolean;\n};\n\nexport class Model<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-model\";\n\n  public props: MModelProps = {\n    src: defaultModelSrc,\n    anim: defaultModelAnim,\n    animStartTime: defaultModelAnimStartTime,\n    animPauseTime: defaultModelAnimPauseTime as number | null,\n    animLoop: defaultModelAnimLoop,\n    animEnabled: defaultModelAnimEnabled,\n    castShadows: defaultModelCastShadows,\n    debug: defaultModelDebug,\n  };\n\n  private collideableHelper = new CollideableHelper(this);\n  private clickableHelper = new ClickableHelper();\n\n  private static attributeHandler = new AttributeHandler<Model<GraphicsAdapter>>({\n    src: (instance, newValue) => {\n      instance.props.src = newValue;\n      instance.modelGraphics?.setSrc(newValue, instance.props);\n    },\n    anim: (instance, newValue) => {\n      instance.props.anim = newValue;\n      instance.modelGraphics?.setAnim(newValue, instance.props);\n    },\n    debug: (instance, newValue) => {\n      instance.props.debug = parseBoolAttribute(newValue, defaultModelDebug);\n      instance.modelGraphics?.setDebug(instance.props.debug, instance.props);\n    },\n    \"cast-shadows\": (instance, newValue) => {\n      instance.props.castShadows = parseBoolAttribute(newValue, defaultModelCastShadows);\n      instance.modelGraphics?.setCastShadows(instance.props.castShadows, instance.props);\n    },\n    \"anim-enabled\": (instance, newValue) => {\n      instance.props.animEnabled = parseBoolAttribute(newValue, defaultModelAnimEnabled);\n      instance.modelGraphics?.setAnimEnabled(instance.props.animEnabled, instance.props);\n    },\n    \"anim-loop\": (instance, newValue) => {\n      instance.props.animLoop = parseBoolAttribute(newValue, defaultModelAnimLoop);\n      instance.modelGraphics?.setAnimLoop(instance.props.animLoop, instance.props);\n    },\n    \"anim-start-time\": (instance, newValue) => {\n      instance.props.animStartTime = parseFloatAttribute(newValue, defaultModelAnimStartTime);\n      instance.modelGraphics?.setAnimStartTime(instance.props.animStartTime, instance.props);\n    },\n    \"anim-pause-time\": (instance, newValue) => {\n      instance.props.animPauseTime = parseFloatAttribute(newValue, defaultModelAnimPauseTime);\n      instance.modelGraphics?.setAnimPauseTime(instance.props.animPauseTime, instance.props);\n    },\n  });\n\n  public modelGraphics: ModelGraphics<G> | null = null;\n\n  public readonly isModel = true;\n\n  public static isModel(element: object): element is Model {\n    return (element as Model).isModel;\n  }\n\n  protected enable() {\n    this.collideableHelper.enable();\n  }\n\n  protected disable() {\n    this.collideableHelper.disable();\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...Model.attributeHandler.getAttributes(),\n      ...CollideableHelper.observedAttributes,\n      ...ClickableHelper.observedAttributes,\n    ];\n  }\n\n  constructor() {\n    super();\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n    const boundingBox = this.modelGraphics?.getBoundingBox();\n    if (boundingBox) {\n      return OrientedBoundingBox.fromSizeMatrixWorldAndCenter(\n        boundingBox.size,\n        this.transformableElementGraphics.getWorldMatrix(),\n        boundingBox.centerOffset,\n      );\n    }\n    return null;\n  }\n\n  public parentTransformed(): void {\n    this.collideableHelper.parentTransformed();\n    this.modelGraphics?.transformed();\n  }\n\n  public isClickable(): boolean {\n    return this.clickableHelper.isClickable();\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    // Handle child animations\n    if (Animation.isAnimation(child)) {\n      // When an animation is added, we need to wait for it to load and then update the model\n      // The animation will call updateChildAnimation when it's ready via its graphics adapter\n\n      // If the modelGraphics is already ready, notify it immediately\n      if (this.modelGraphics && child.animationGraphics) {\n        const weight = child.props.weight;\n        child.animationGraphics.setWeight(weight, child.props);\n      }\n    } else {\n      // For other side effect children, delegate to parent\n      super.addSideEffectChild(child);\n    }\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    // Handle child animation removal\n    if (Animation.isAnimation(child)) {\n      // Notify the graphics adapter that this animation should be removed\n      this.modelGraphics?.removeChildAnimation?.(child);\n    } else {\n      // For other side effect children, delegate to parent\n      super.removeSideEffectChild(child);\n    }\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.modelGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Model.attributeHandler.handle(this, name, newValue);\n    this.collideableHelper.handle(name, newValue);\n    this.clickableHelper.handle(name, newValue);\n    if (TransformableElement.observedAttributes.includes(name)) {\n      // The element might have moved/scaled, so we need to call transformed\n      this.modelGraphics.transformed();\n    }\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.modelGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.modelGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLModelGraphicsInterface(this, () => {\n        this.applyBounds();\n        this.collideableHelper.updateCollider(this.modelGraphics?.getCollisionElement());\n      });\n\n    // Notify any existing child animations that the modelGraphics is now available\n    this.notifyChildAnimations();\n\n    for (const name of Model.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n  }\n\n  private notifyChildAnimations() {\n    // Find all child animations and notify them that the modelGraphics is ready\n    const childAnimations = this.querySelectorAll(\"m-animation\");\n\n    childAnimations.forEach((animation) => {\n      if (Animation.isAnimation(animation)) {\n        // The animation's graphics adapter will handle the notification\n        if (animation.animationGraphics) {\n          animation.animationGraphics.parentModelUpdated();\n        }\n      }\n    });\n  }\n\n  disconnectedCallback() {\n    // stop listening to document time ticking\n    this.collideableHelper.removeColliders();\n    this.modelGraphics?.dispose();\n    this.modelGraphics = null;\n    super.disconnectedCallback();\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation/AnimatedAttributeHelper\";\nimport { AttributeHandler, parseBoolAttribute, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { AnimationGraphics } from \"../graphics\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { Model } from \"./Model\";\n\nconst defaultAnimationSrc = null;\nconst defaultAnimationWeight = 1;\nconst defaultAnimationSpeed = 1;\nconst defaultAnimationLoop = true;\nconst defaultAnimationStartTime = 0;\nconst defaultAnimationPauseTime = null;\nconst defaultAnimationRatio = null;\n\nexport type MAnimationProps = {\n  src: string | null;\n  weight: number;\n  speed: number;\n  ratio: number | null;\n  loop: boolean;\n  startTime: number;\n  pauseTime: number | null;\n};\n\nexport class Animation<G extends GraphicsAdapter = GraphicsAdapter> extends MElement<G> {\n  static tagName = \"m-animation\";\n\n  public props: MAnimationProps = {\n    src: defaultAnimationSrc,\n    weight: defaultAnimationWeight,\n    speed: defaultAnimationSpeed,\n    ratio: defaultAnimationRatio,\n    loop: defaultAnimationLoop,\n    startTime: defaultAnimationStartTime,\n    pauseTime: defaultAnimationPauseTime,\n  };\n\n  private animatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    weight: [\n      AnimationType.Number,\n      defaultAnimationWeight,\n      (value: number | null) => {\n        if (value !== null) {\n          this.props.weight = value;\n          this.animationGraphics?.setWeight(value, this.props);\n        }\n      },\n    ],\n    ratio: [\n      AnimationType.Number,\n      defaultAnimationRatio,\n      (value: number | null) => {\n        this.props.ratio = value;\n        this.animationGraphics?.setRatio(value, this.props);\n      },\n    ],\n  });\n\n  private static attributeHandler = new AttributeHandler<Animation<GraphicsAdapter>>({\n    src: (instance, newValue) => {\n      instance.props.src = newValue;\n      instance.animationGraphics?.setSrc(newValue, instance.props);\n    },\n    weight: (instance, newValue) => {\n      instance.animatedAttributeHelper.elementSetAttribute(\n        \"weight\",\n        parseFloatAttribute(newValue, defaultAnimationWeight),\n      );\n    },\n    ratio: (instance, newValue) => {\n      instance.animatedAttributeHelper.elementSetAttribute(\n        \"ratio\",\n        parseFloatAttribute(newValue, defaultAnimationRatio),\n      );\n    },\n    speed: (instance, newValue) => {\n      instance.props.speed = parseFloatAttribute(newValue, defaultAnimationSpeed);\n      instance.animationGraphics?.setSpeed(instance.props.speed, instance.props);\n    },\n    loop: (instance, newValue) => {\n      instance.props.loop = parseBoolAttribute(newValue, defaultAnimationLoop);\n      instance.animationGraphics?.setLoop(instance.props.loop, instance.props);\n    },\n    \"start-time\": (instance, newValue) => {\n      instance.props.startTime = parseFloatAttribute(newValue, defaultAnimationStartTime);\n      instance.animationGraphics?.setStartTime(instance.props.startTime, instance.props);\n    },\n    \"pause-time\": (instance, newValue) => {\n      instance.props.pauseTime = parseFloatAttribute(newValue, defaultAnimationPauseTime);\n      instance.animationGraphics?.setPauseTime(instance.props.pauseTime, instance.props);\n    },\n  });\n\n  public animationGraphics: AnimationGraphics<G> | null = null;\n\n  public readonly isAnimation = true;\n\n  public static isAnimation(element: object): element is Animation {\n    return (element as Animation).isAnimation;\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [...Animation.attributeHandler.getAttributes()];\n  }\n\n  constructor() {\n    super();\n  }\n\n  protected enable() {}\n\n  protected disable() {}\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    return null;\n  }\n\n  public parentTransformed(): void {}\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.animatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.animatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Animation.attributeHandler.handle(this, name, newValue);\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.animationGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.animationGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLAnimationGraphicsInterface(this);\n\n    if (this.parentElement && Model.isModel(this.parentElement)) {\n      this.parentElement.addSideEffectChild(this);\n    }\n\n    // Process attributes in the correct order: src first, then weight\n    for (const name of Animation.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    // Ensure the initial weight is set immediately after src is processed\n    const weightValue = this.getAttribute(\"weight\");\n    if (weightValue !== null) {\n      const parsedWeight = parseFloatAttribute(weightValue, defaultAnimationWeight);\n      this.props.weight = parsedWeight;\n      // Set the weight directly on the graphics adapter to ensure immediate application\n      this.animationGraphics?.setWeight(parsedWeight, this.props);\n    }\n  }\n\n  disconnectedCallback() {\n    if (this.parentElement && Model.isModel(this.parentElement)) {\n      this.parentElement.removeSideEffectChild(this);\n    }\n    this.animatedAttributeHelper?.reset();\n    this.animationGraphics?.dispose();\n    this.animationGraphics = null;\n    super.disconnectedCallback();\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport { AttributeHandler, parseBoolAttribute, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { AudioGraphics } from \"../graphics/AudioGraphics\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultAudioVolume = 1;\nconst defaultAudioLoop = true;\nconst defaultAudioEnabled = true;\nconst defaultAudioStartTime = 0;\nconst defaultAudioPauseTime = null;\nconst defaultAudioSrc = null;\nconst defaultAudioInnerConeAngle: number = 360;\nconst defaultAudioOuterConeAngle = 0;\nconst defaultAudioDebug = false;\n\nfunction clampAudioConeAngle(angle: number) {\n  return Math.max(Math.min(angle, 360), 0);\n}\n\nexport type MAudioProps = {\n  src: string | null;\n  startTime: number;\n  pauseTime: number | null;\n  loop: boolean;\n  loopDuration: number | null;\n  enabled: boolean;\n  volume: number;\n  coneAngle: number;\n  coneFalloffAngle: number | null;\n  debug: boolean;\n};\n\nexport class Audio<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-audio\";\n\n  public props: MAudioProps = {\n    src: defaultAudioSrc as string | null,\n    startTime: defaultAudioStartTime,\n    pauseTime: defaultAudioPauseTime as number | null,\n    loop: defaultAudioLoop,\n    loopDuration: null,\n    enabled: defaultAudioEnabled,\n    volume: defaultAudioVolume,\n    coneAngle: defaultAudioInnerConeAngle,\n    coneFalloffAngle: defaultAudioOuterConeAngle as number | null,\n    debug: false,\n  };\n\n  private audioGraphics: AudioGraphics<G> | null = null;\n\n  private audioAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    volume: [\n      AnimationType.Number,\n      defaultAudioVolume,\n      (newValue: number) => {\n        this.props.volume = newValue;\n        this.audioGraphics?.setVolume(newValue, this.props);\n      },\n    ],\n    \"cone-angle\": [\n      AnimationType.Number,\n      defaultAudioInnerConeAngle,\n      (newValue: number | null) => {\n        this.props.coneAngle =\n          newValue === null ? defaultAudioInnerConeAngle : clampAudioConeAngle(newValue);\n        this.audioGraphics?.setConeAngle(this.props.coneAngle, this.props);\n      },\n    ],\n    \"cone-falloff-angle\": [\n      AnimationType.Number,\n      defaultAudioOuterConeAngle,\n      (newValue: number) => {\n        this.props.coneFalloffAngle = clampAudioConeAngle(newValue);\n        this.audioGraphics?.setConeFalloffAngle(this.props.coneFalloffAngle, this.props);\n      },\n    ],\n  });\n\n  private documentTimeListener: { remove: () => void };\n\n  static get observedAttributes(): Array<string> {\n    return [...TransformableElement.observedAttributes, ...Audio.attributeHandler.getAttributes()];\n  }\n\n  private static attributeHandler = new AttributeHandler<Audio<GraphicsAdapter>>({\n    enabled: (instance, newValue) => {\n      instance.props.enabled = parseBoolAttribute(newValue, defaultAudioEnabled);\n      instance.audioGraphics?.setEnabled(instance.props.enabled, instance.props);\n    },\n    loop: (instance, newValue) => {\n      instance.props.loop = parseBoolAttribute(newValue, defaultAudioLoop);\n      instance.audioGraphics?.setLoop(instance.props.loop, instance.props);\n    },\n    \"loop-duration\": (instance, newValue) => {\n      instance.props.loopDuration = parseFloatAttribute(newValue, null);\n      instance.audioGraphics?.setLoopDuration(instance.props.loopDuration, instance.props);\n    },\n    \"start-time\": (instance, newValue) => {\n      instance.props.startTime = parseFloatAttribute(newValue, defaultAudioStartTime);\n      instance.audioGraphics?.setStartTime(instance.props.startTime, instance.props);\n    },\n    \"pause-time\": (instance, newValue) => {\n      instance.props.pauseTime = parseFloatAttribute(newValue, defaultAudioPauseTime);\n      instance.audioGraphics?.setPauseTime(instance.props.pauseTime, instance.props);\n    },\n    src: (instance, newValue) => {\n      instance.props.src = newValue;\n      instance.audioGraphics?.setSrc(newValue, instance.props);\n    },\n    volume: (instance, newValue) => {\n      instance.audioAnimatedAttributeHelper.elementSetAttribute(\n        \"volume\",\n        parseFloatAttribute(newValue, defaultAudioVolume),\n      );\n    },\n    \"cone-angle\": (instance, newValue) => {\n      instance.audioAnimatedAttributeHelper.elementSetAttribute(\n        \"cone-angle\",\n        parseFloatAttribute(newValue, null),\n      );\n    },\n    \"cone-falloff-angle\": (instance, newValue) => {\n      instance.audioAnimatedAttributeHelper.elementSetAttribute(\n        \"cone-falloff-angle\",\n        parseFloatAttribute(newValue, defaultAudioOuterConeAngle),\n      );\n    },\n    debug: (instance, newValue) => {\n      instance.props.debug = parseBoolAttribute(newValue, defaultAudioDebug);\n      instance.audioGraphics?.setDebug(instance.props.debug, instance.props);\n    },\n  });\n\n  constructor() {\n    super();\n  }\n\n  protected enable() {\n    this.audioGraphics?.syncAudioTime();\n  }\n\n  protected disable() {\n    this.audioGraphics?.syncAudioTime();\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n    return OrientedBoundingBox.fromMatrixWorld(this.transformableElementGraphics.getWorldMatrix());\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.audioAnimatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.audioAnimatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  public parentTransformed(): void {\n    // no-op\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.audioGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Audio.attributeHandler.handle(this, name, newValue);\n  }\n\n  private documentTimeChanged() {\n    this.audioGraphics?.syncAudioTime();\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.audioGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.audioGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLAudioGraphicsInterface(this);\n\n    this.documentTimeListener = this.addDocumentTimeListener(() => {\n      this.documentTimeChanged();\n    });\n\n    for (const name of Audio.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n  }\n\n  disconnectedCallback() {\n    this.audioAnimatedAttributeHelper.reset();\n    this.audioGraphics?.dispose();\n    this.audioGraphics = null;\n    this.documentTimeListener.remove();\n    super.disconnectedCallback();\n  }\n}\n", "import { GraphicsAdapter } from \"../graphics\";\nimport { Model } from \"./Model\";\n\nexport class Character<G extends GraphicsAdapter = GraphicsAdapter> extends Model<G> {\n  static tagName = \"m-character\";\n\n  static get observedAttributes(): Array<string> {\n    return [...Model.observedAttributes];\n  }\n\n  constructor() {\n    super();\n  }\n\n  public parentTransformed(): void {\n    super.parentTransformed();\n  }\n\n  public connectedCallback() {\n    super.connectedCallback();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n  }\n}\n", "import { MElement, TransformableElement } from \"../elements\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { degToRad, EulXYZ, Matr4, Quat, radToDeg, Vect3 } from \"../math\";\nimport { PositionAndRotation } from \"../scene\";\n\nconst tempContainerMatrix = new Matr4();\nconst tempTargetMatrix = new Matr4();\nconst tempPositionVector = new Vect3();\nconst tempRotationEuler = new EulXYZ();\nconst tempRotationQuaternion = new Quat();\nconst tempScaleVector = new Vect3();\n\nexport function getRelativePositionAndRotationRelativeToObject(\n  positionAndRotation: PositionAndRotation,\n  container: MElement<GraphicsAdapter>,\n): PositionAndRotation {\n  const { x, y, z } = positionAndRotation.position;\n\n  // Rotation in degrees\n  const { x: rx, y: ry, z: rz } = positionAndRotation.rotation;\n\n  tempContainerMatrix.identity();\n  const tempMatr4 = new Matr4();\n  for (let obj: ParentNode | null = container; obj; obj = obj.parentNode) {\n    if (TransformableElement.isTransformableElement(obj)) {\n      obj.calculateLocalMatrix(tempMatr4);\n      tempContainerMatrix.premultiply(tempMatr4);\n    }\n  }\n\n  tempContainerMatrix.invert();\n\n  tempPositionVector.set(x, y, z);\n  tempRotationEuler.set(degToRad(rx), degToRad(ry), degToRad(rz));\n  tempRotationQuaternion.setFromEulerXYZ(tempRotationEuler);\n  tempScaleVector.set(1, 1, 1);\n  tempTargetMatrix.compose(tempPositionVector, tempRotationQuaternion, tempScaleVector);\n\n  tempTargetMatrix.premultiply(tempContainerMatrix);\n  tempTargetMatrix.decompose(tempPositionVector, tempRotationQuaternion, tempScaleVector);\n  tempRotationEuler.setFromQuaternion(tempRotationQuaternion);\n\n  return {\n    position: {\n      x: tempPositionVector.x,\n      y: tempPositionVector.y,\n      z: tempPositionVector.z,\n    },\n    rotation: {\n      x: radToDeg(tempRotationEuler.x),\n      y: radToDeg(tempRotationEuler.y),\n      z: radToDeg(tempRotationEuler.z),\n    },\n  };\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport { AttributeHandler, parseBoolAttribute, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { ChatProbeGraphics } from \"../graphics/ChatProbeGraphics\";\nimport { Vect3 } from \"../math/Vect3\";\nimport { getRelativePositionAndRotationRelativeToObject } from \"../position\";\nimport { IMMLScene } from \"../scene\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultChatProbeRange = 10;\nconst defaultChatProbeDebug = false;\nconst chatProbeChatEventName = \"chat\";\n\nexport type MChatProbeProps = {\n  debug: boolean;\n  range: number;\n};\n\nexport class ChatProbe<\n  G extends GraphicsAdapter = GraphicsAdapter,\n> extends TransformableElement<G> {\n  static tagName = \"m-chat-probe\";\n  private chatProbeGraphics: ChatProbeGraphics<G> | null = null;\n  private registeredScene: IMMLScene<G> | null = null;\n\n  private chatProbeAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    range: [\n      AnimationType.Number,\n      defaultChatProbeRange,\n      (newValue: number) => {\n        this.props.range = newValue;\n        this.chatProbeGraphics?.setRange(newValue, this.props);\n        this.applyBounds();\n      },\n    ],\n  });\n\n  public props: MChatProbeProps = {\n    debug: defaultChatProbeDebug,\n    range: defaultChatProbeRange,\n  };\n\n  private static attributeHandler = new AttributeHandler<ChatProbe<GraphicsAdapter>>({\n    range: (instance, newValue) => {\n      instance.chatProbeAnimatedAttributeHelper.elementSetAttribute(\n        \"range\",\n        parseFloatAttribute(newValue, defaultChatProbeRange),\n      );\n    },\n    debug: (instance, newValue) => {\n      instance.props.debug = parseBoolAttribute(newValue, defaultChatProbeDebug);\n      instance.chatProbeGraphics?.setDebug(instance.props.debug, instance.props);\n    },\n  });\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...ChatProbe.attributeHandler.getAttributes(),\n    ];\n  }\n\n  constructor() {\n    super();\n  }\n\n  protected enable() {\n    // no-op (the probe only sends events if the position is within range)\n  }\n\n  protected disable() {\n    // no-op (the probe only sends events if the position is within range)\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n    return OrientedBoundingBox.fromSizeAndMatrixWorld(\n      new Vect3(this.props.range * 2, this.props.range * 2, this.props.range * 2),\n      this.transformableElementGraphics.getWorldMatrix(),\n    );\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.chatProbeAnimatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.chatProbeAnimatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  public parentTransformed(): void {\n    this.registeredScene?.updateChatProbe?.(this);\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    super.attributeChangedCallback(name, oldValue, newValue);\n    ChatProbe.attributeHandler.handle(this, name, newValue);\n  }\n\n  public trigger(message: string) {\n    const userPositionAndRotation = this.getUserPositionAndRotation();\n    const elementRelative = getRelativePositionAndRotationRelativeToObject(\n      userPositionAndRotation,\n      this,\n    );\n\n    // Check if the position is within range\n    const distance = new Vect3().copy(elementRelative.position).length();\n\n    let withinBounds = true;\n    this.getAppliedBounds().forEach((bounds) => {\n      if (!bounds.containsPoint(userPositionAndRotation.position)) {\n        withinBounds = false;\n      }\n    });\n\n    if (withinBounds && distance <= this.props.range) {\n      this.dispatchEvent(\n        new CustomEvent(chatProbeChatEventName, {\n          detail: {\n            message,\n          },\n        }),\n      );\n    }\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.chatProbeGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.chatProbeGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLChatProbeGraphicsInterface(this);\n\n    for (const name of ChatProbe.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    this.applyBounds();\n    this.registerChatProbe();\n  }\n\n  public disconnectedCallback(): void {\n    this.unregisterChatProbe();\n    this.chatProbeAnimatedAttributeHelper.reset();\n    this.chatProbeGraphics?.dispose();\n    this.chatProbeGraphics = null;\n    super.disconnectedCallback();\n  }\n\n  private registerChatProbe() {\n    const scene = this.getScene();\n    this.registeredScene = scene;\n    scene.addChatProbe?.(this);\n  }\n\n  private unregisterChatProbe() {\n    if (this.registeredScene !== null) {\n      this.registeredScene.removeChatProbe?.(this);\n      this.registeredScene = null;\n    }\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport {\n  AttributeHandler,\n  parseBoolAttribute,\n  parseColorAttribute,\n  parseFloatAttribute,\n} from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { ClickableHelper } from \"../clickable/ClickableHelper\";\nimport { CollideableHelper } from \"../collision\";\nimport { MMLColor } from \"../color\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { CubeGraphics } from \"../graphics/CubeGraphics\";\nimport { Vect3 } from \"../math/Vect3\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultCubeColor: MMLColor = { r: 1, g: 1, b: 1 };\nconst defaultCubeWidth = 1;\nconst defaultCubeHeight = 1;\nconst defaultCubeDepth = 1;\nconst defaultCubeOpacity = 1;\nconst defaultCubeCastShadows = true;\n\nexport type MCubeProps = {\n  width: number;\n  height: number;\n  depth: number;\n  color: MMLColor;\n  opacity: number;\n  castShadows: boolean;\n};\n\nexport class Cube<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-cube\";\n  private cubeGraphics: CubeGraphics<G> | null = null;\n\n  public props: MCubeProps = {\n    width: defaultCubeWidth,\n    height: defaultCubeHeight,\n    depth: defaultCubeDepth,\n    color: defaultCubeColor,\n    opacity: defaultCubeOpacity,\n    castShadows: defaultCubeCastShadows,\n  };\n\n  private cubeAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    color: [\n      AnimationType.Color,\n      defaultCubeColor,\n      (newValue: MMLColor) => {\n        this.props.color = newValue;\n        this.cubeGraphics?.setColor(newValue, this.props);\n      },\n    ],\n    width: [\n      AnimationType.Number,\n      defaultCubeWidth,\n      (newValue: number) => {\n        this.props.width = newValue;\n        this.cubeGraphics?.setWidth(newValue, this.props);\n        this.applyBounds();\n        this.collideableHelper.updateCollider(this.cubeGraphics?.getCollisionElement());\n      },\n    ],\n    height: [\n      AnimationType.Number,\n      defaultCubeHeight,\n      (newValue: number) => {\n        this.props.height = newValue;\n        this.cubeGraphics?.setHeight(newValue, this.props);\n        this.applyBounds();\n        this.collideableHelper.updateCollider(this.cubeGraphics?.getCollisionElement());\n      },\n    ],\n    depth: [\n      AnimationType.Number,\n      defaultCubeDepth,\n      (newValue: number) => {\n        this.props.depth = newValue;\n        this.cubeGraphics?.setDepth(newValue, this.props);\n        this.applyBounds();\n        this.collideableHelper.updateCollider(this.cubeGraphics?.getCollisionElement());\n      },\n    ],\n    opacity: [\n      AnimationType.Number,\n      defaultCubeOpacity,\n      (newValue: number) => {\n        this.props.opacity = newValue;\n        this.cubeGraphics?.setOpacity(newValue, this.props);\n      },\n    ],\n  });\n  private collideableHelper = new CollideableHelper(this);\n  private clickableHelper = new ClickableHelper();\n\n  private static attributeHandler = new AttributeHandler<Cube<GraphicsAdapter>>({\n    width: (instance, newValue) => {\n      instance.cubeAnimatedAttributeHelper.elementSetAttribute(\n        \"width\",\n        parseFloatAttribute(newValue, defaultCubeWidth),\n      );\n    },\n    height: (instance, newValue) => {\n      instance.cubeAnimatedAttributeHelper.elementSetAttribute(\n        \"height\",\n        parseFloatAttribute(newValue, defaultCubeHeight),\n      );\n    },\n    depth: (instance, newValue) => {\n      instance.cubeAnimatedAttributeHelper.elementSetAttribute(\n        \"depth\",\n        parseFloatAttribute(newValue, defaultCubeDepth),\n      );\n    },\n    color: (instance, newValue) => {\n      instance.cubeAnimatedAttributeHelper.elementSetAttribute(\n        \"color\",\n        parseColorAttribute(newValue, defaultCubeColor),\n      );\n    },\n    opacity: (instance, newValue) => {\n      instance.cubeAnimatedAttributeHelper.elementSetAttribute(\n        \"opacity\",\n        parseFloatAttribute(newValue, defaultCubeOpacity),\n      );\n    },\n    \"cast-shadows\": (instance, newValue) => {\n      instance.props.castShadows = parseBoolAttribute(newValue, defaultCubeCastShadows);\n      instance.cubeGraphics?.setCastShadows(instance.props.castShadows, instance.props);\n    },\n  });\n\n  protected enable() {\n    this.collideableHelper.enable();\n  }\n\n  protected disable() {\n    this.collideableHelper.disable();\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n    return OrientedBoundingBox.fromSizeAndMatrixWorld(\n      new Vect3(this.props.width, this.props.height, this.props.depth),\n      this.transformableElementGraphics.getWorldMatrix(),\n    );\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...Cube.attributeHandler.getAttributes(),\n      ...CollideableHelper.observedAttributes,\n      ...ClickableHelper.observedAttributes,\n    ];\n  }\n\n  constructor() {\n    super();\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.cubeAnimatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.cubeAnimatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  public parentTransformed(): void {\n    this.collideableHelper.parentTransformed();\n  }\n\n  public isClickable(): boolean {\n    return this.clickableHelper.isClickable();\n  }\n\n  public attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.cubeGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Cube.attributeHandler.handle(this, name, newValue);\n    this.collideableHelper.handle(name, newValue);\n    this.clickableHelper.handle(name, newValue);\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.cubeGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.cubeGraphics = graphicsAdapter.getGraphicsAdapterFactory().MMLCubeGraphicsInterface(this);\n\n    for (const name of Cube.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    this.applyBounds();\n    this.collideableHelper.updateCollider(this.cubeGraphics?.getCollisionElement());\n  }\n\n  public disconnectedCallback(): void {\n    this.collideableHelper.removeColliders();\n    this.cubeAnimatedAttributeHelper.reset();\n    this.cubeGraphics?.dispose();\n    this.cubeGraphics = null;\n    super.disconnectedCallback();\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport {\n  AttributeHandler,\n  parseBoolAttribute,\n  parseColorAttribute,\n  parseFloatAttribute,\n} from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { ClickableHelper } from \"../clickable/ClickableHelper\";\nimport { CollideableHelper } from \"../collision\";\nimport { MMLColor } from \"../color\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { CylinderGraphics } from \"../graphics/CylinderGraphics\";\nimport { Vect3 } from \"../math/Vect3\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultCylinderColor: MMLColor = { r: 1, g: 1, b: 1 };\nconst defaultCylinderRadius = 0.5;\nconst defaultCylinderHeight = 1;\nconst defaultCylinderOpacity = 1;\nconst defaultCylinderCastShadows = true;\n\nexport type MCylinderProps = {\n  radius: number;\n  height: number;\n  color: MMLColor;\n  opacity: number;\n  castShadows: boolean;\n};\n\nexport class Cylinder<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-cylinder\";\n  private cylinderGraphics: CylinderGraphics<G> | null;\n\n  public props: MCylinderProps = {\n    radius: defaultCylinderRadius,\n    height: defaultCylinderHeight,\n    color: defaultCylinderColor,\n    opacity: defaultCylinderOpacity,\n    castShadows: defaultCylinderCastShadows,\n  };\n\n  private cylinderAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    color: [\n      AnimationType.Color,\n      defaultCylinderColor,\n      (newValue: MMLColor) => {\n        this.props.color = newValue;\n        this.cylinderGraphics?.setColor(newValue, this.props);\n      },\n    ],\n    radius: [\n      AnimationType.Number,\n      defaultCylinderRadius,\n      (newValue: number) => {\n        this.props.radius = newValue;\n        this.cylinderGraphics?.setRadius(newValue, this.props);\n        this.applyBounds();\n        this.collideableHelper.updateCollider(this.cylinderGraphics?.getCollisionElement());\n      },\n    ],\n    height: [\n      AnimationType.Number,\n      defaultCylinderHeight,\n      (newValue: number) => {\n        this.props.height = newValue;\n        this.cylinderGraphics?.setHeight(newValue, this.props);\n        this.applyBounds();\n        this.collideableHelper.updateCollider(this.cylinderGraphics?.getCollisionElement());\n      },\n    ],\n    opacity: [\n      AnimationType.Number,\n      defaultCylinderOpacity,\n      (newValue: number) => {\n        this.props.opacity = newValue;\n        this.cylinderGraphics?.setOpacity(newValue, this.props);\n      },\n    ],\n  });\n  private collideableHelper = new CollideableHelper(this);\n  private clickableHelper = new ClickableHelper();\n\n  private static attributeHandler = new AttributeHandler<Cylinder<GraphicsAdapter>>({\n    radius: (instance, newValue) => {\n      instance.cylinderAnimatedAttributeHelper.elementSetAttribute(\n        \"radius\",\n        parseFloatAttribute(newValue, defaultCylinderRadius),\n      );\n    },\n    height: (instance, newValue) => {\n      instance.cylinderAnimatedAttributeHelper.elementSetAttribute(\n        \"height\",\n        parseFloatAttribute(newValue, defaultCylinderHeight),\n      );\n    },\n    color: (instance, newValue) => {\n      instance.cylinderAnimatedAttributeHelper.elementSetAttribute(\n        \"color\",\n        parseColorAttribute(newValue, defaultCylinderColor),\n      );\n    },\n    opacity: (instance, newValue) => {\n      instance.cylinderAnimatedAttributeHelper.elementSetAttribute(\n        \"opacity\",\n        parseFloatAttribute(newValue, defaultCylinderOpacity),\n      );\n    },\n    \"cast-shadows\": (instance, newValue) => {\n      instance.props.castShadows = parseBoolAttribute(newValue, defaultCylinderCastShadows);\n      instance.cylinderGraphics?.setCastShadows(instance.props.castShadows, instance.props);\n    },\n  });\n\n  protected enable() {\n    this.collideableHelper.enable();\n  }\n\n  protected disable() {\n    this.collideableHelper.disable();\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n    return OrientedBoundingBox.fromSizeAndMatrixWorld(\n      new Vect3(this.props.radius * 2, this.props.height, this.props.radius * 2),\n      this.transformableElementGraphics.getWorldMatrix(),\n    );\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...Cylinder.attributeHandler.getAttributes(),\n      ...CollideableHelper.observedAttributes,\n      ...ClickableHelper.observedAttributes,\n    ];\n  }\n\n  constructor() {\n    super();\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.cylinderAnimatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.cylinderAnimatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  public parentTransformed(): void {\n    this.collideableHelper.parentTransformed();\n  }\n\n  public isClickable(): boolean {\n    return this.clickableHelper.isClickable();\n  }\n\n  public attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.cylinderGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Cylinder.attributeHandler.handle(this, name, newValue);\n    this.collideableHelper.handle(name, newValue);\n    this.clickableHelper.handle(name, newValue);\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.cylinderGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.cylinderGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLCylinderGraphicsInterface(this);\n\n    for (const name of Cylinder.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    this.applyBounds();\n    this.collideableHelper.updateCollider(this.cylinderGraphics?.getCollisionElement());\n  }\n\n  public disconnectedCallback(): void {\n    this.collideableHelper.removeColliders();\n    this.cylinderAnimatedAttributeHelper.reset();\n    this.cylinderGraphics?.dispose();\n    this.cylinderGraphics = null;\n    super.disconnectedCallback();\n  }\n}\n", "import { ChatProbe, Interaction, MElement } from \"../elements\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { LoadingProgressManager } from \"../loading\";\nimport { IMMLScene, LinkProps, PromptProps } from \"../scene\";\n\nexport function createWrappedScene<G extends GraphicsAdapter = GraphicsAdapter>(\n  scene: IMMLScene<G>,\n  loadingProgressManager: LoadingProgressManager | null,\n): IMMLScene<G> {\n  return {\n    addCollider(collider: unknown, element: MElement<G>): void {\n      if (scene.addCollider) {\n        scene.addCollider(collider, element);\n      }\n    },\n    updateCollider(collider: unknown, element: MElement<G>): void {\n      if (scene.updateCollider) {\n        scene.updateCollider(collider, element);\n      }\n    },\n    removeCollider(collider: unknown, element: MElement<G>): void {\n      if (scene.removeCollider) {\n        scene.removeCollider(collider, element);\n      }\n    },\n    addInteraction(interaction: Interaction<G>): void {\n      if (scene.addInteraction) {\n        scene.addInteraction(interaction);\n      }\n    },\n    updateInteraction(interaction: Interaction<G>): void {\n      if (scene.updateInteraction) {\n        scene.updateInteraction(interaction);\n      }\n    },\n    removeInteraction(interaction: Interaction<G>): void {\n      if (scene.removeInteraction) {\n        scene.removeInteraction(interaction);\n      }\n    },\n    addChatProbe(chatProbe: ChatProbe<G>): void {\n      if (scene.addChatProbe) {\n        scene.addChatProbe(chatProbe);\n      }\n    },\n    updateChatProbe(chatProbe: ChatProbe<G>): void {\n      if (scene.updateChatProbe) {\n        scene.updateChatProbe(chatProbe);\n      }\n    },\n    removeChatProbe(chatProbe: ChatProbe<G>): void {\n      if (scene.removeChatProbe) {\n        scene.removeChatProbe(chatProbe);\n      }\n    },\n    getOverlayElement() {\n      if (scene.getOverlayElement) {\n        return scene.getOverlayElement();\n      }\n      return null;\n    },\n    hasGraphicsAdapter() {\n      return scene.hasGraphicsAdapter();\n    },\n    getGraphicsAdapter() {\n      return scene.getGraphicsAdapter();\n    },\n    prompt(\n      promptProps: PromptProps,\n      abortSignal: AbortSignal,\n      callback: (result: string | null) => void,\n    ) {\n      scene.prompt(promptProps, abortSignal, callback);\n    },\n    link(\n      linkProps: LinkProps,\n      abortSignal: AbortSignal,\n      windowCallback: (openedWindow: Window | null) => void,\n    ) {\n      scene.link(linkProps, abortSignal, windowCallback);\n    },\n    getUserPositionAndRotation: () => {\n      return scene.getUserPositionAndRotation();\n    },\n    getLoadingProgressManager: () => {\n      return loadingProgressManager;\n    },\n  };\n}\n", "import { LoadingProgressManager } from \"./LoadingProgressManager\";\n\nconst noManagerSymbol = Symbol(\"NoLoadingProgressManagerProvided\");\n\nexport class LoadingInstanceManager {\n  // Only set if the instance is loading / has loaded / has errored\n  private currentlyLoadingProgressManager: LoadingProgressManager | typeof noManagerSymbol | null =\n    null;\n\n  constructor(private type: string) {}\n\n  public start(loadingProgressManager: LoadingProgressManager | null, url: string) {\n    if (this.currentlyLoadingProgressManager !== null) {\n      if (this.currentlyLoadingProgressManager === noManagerSymbol && !loadingProgressManager) {\n        // Already loading with no progress manager, and no progress manager provided - do nothing\n        return;\n      }\n      if (this.currentlyLoadingProgressManager !== loadingProgressManager) {\n        throw new Error(\"Already loading with a different progress manager\");\n      }\n      // else the instance is already reported as loading with this progress manager (could be a change in content)\n    } else {\n      // This instance is now loading - report to the progress manager\n      if (!loadingProgressManager) {\n        this.currentlyLoadingProgressManager = noManagerSymbol;\n      } else {\n        this.currentlyLoadingProgressManager = loadingProgressManager;\n        this.currentlyLoadingProgressManager.addLoadingAsset(this, url, this.type);\n      }\n    }\n  }\n\n  public setProgress(ratio: number) {\n    if (!this.currentlyLoadingProgressManager) {\n      throw new Error(\"Not currently loading - cannot finish\");\n    }\n    if (this.currentlyLoadingProgressManager !== noManagerSymbol) {\n      this.currentlyLoadingProgressManager.updateAssetProgress(this, ratio);\n    }\n  }\n\n  // The content being loaded is no longer needed, but the instance may still request content load start again\n  public abortIfLoading() {\n    if (\n      this.currentlyLoadingProgressManager &&\n      this.currentlyLoadingProgressManager !== noManagerSymbol\n    ) {\n      this.currentlyLoadingProgressManager.disposeOfLoadingAsset(this);\n    }\n    this.currentlyLoadingProgressManager = null;\n  }\n\n  // The instance is no longer needed, and will not request content load start again (content may not be loading)\n  public dispose() {\n    this.abortIfLoading();\n  }\n\n  public finish() {\n    if (!this.currentlyLoadingProgressManager) {\n      throw new Error(\"Not currently loading - cannot finish\");\n    }\n    if (this.currentlyLoadingProgressManager !== noManagerSymbol) {\n      this.currentlyLoadingProgressManager.completedLoadingAsset(this);\n    }\n  }\n\n  public error(err?: Error | null) {\n    if (!this.currentlyLoadingProgressManager) {\n      throw new Error(\"Not currently loading - cannot error\");\n    }\n    if (this.currentlyLoadingProgressManager !== noManagerSymbol) {\n      if (err) {\n        this.currentlyLoadingProgressManager.errorLoadingAsset(this, err);\n      } else {\n        this.currentlyLoadingProgressManager.errorLoadingAsset(this, new Error(\"Unknown error\"));\n      }\n    }\n  }\n}\n", "type AssetStatus = {\n  type: string;\n  assetUrl: string;\n  progressRatio: number;\n  loadStatus: boolean | Error;\n};\n\ntype LoadingCountSummary = {\n  totalLoaded: number;\n  totalErrored: number;\n  totalToLoad: number;\n};\n\ntype LoadingProgressSummary = {\n  initialLoad: boolean | Error;\n  summary: LoadingCountSummary;\n  summaryByType: { [key: string]: LoadingCountSummary & { assetErrors: Array<[string, Error]> } };\n  innerDocuments: Array<[string, LoadingProgressSummary]>;\n};\n\nexport class LoadingProgressManager {\n  public summary: LoadingCountSummary = {\n    totalLoaded: 0,\n    totalErrored: 0,\n    totalToLoad: 0,\n  };\n\n  public initialLoad: boolean | Error = false;\n\n  public loadingAssets = new Map<unknown, AssetStatus>();\n  public summaryByType = new Map<\n    string,\n    LoadingCountSummary & {\n      assets: Map<unknown, AssetStatus>;\n    }\n  >();\n  public loadingDocuments = new Map<\n    unknown,\n    { documentUrl: string; progressManager: LoadingProgressManager }\n  >();\n\n  private onProgressCallbacks = new Set<() => void>();\n\n  constructor() {}\n\n  public addProgressCallback(callback: () => void): void {\n    this.onProgressCallbacks.add(callback);\n  }\n\n  public removeProgressCallback(callback: () => void): void {\n    this.onProgressCallbacks.delete(callback);\n  }\n\n  private onProgress(): void {\n    for (const callback of this.onProgressCallbacks) {\n      callback();\n    }\n  }\n\n  public addLoadingAsset(ref: unknown, url: string, type: string): void {\n    if (this.loadingAssets.has(ref)) {\n      throw new Error(\"Asset reference already exists\");\n    }\n    const assetRecord: AssetStatus = { type, assetUrl: url, progressRatio: 0, loadStatus: false };\n    this.loadingAssets.set(ref, assetRecord);\n\n    let typeSummary = this.summaryByType.get(type);\n    if (!typeSummary) {\n      typeSummary = { totalLoaded: 0, totalToLoad: 0, totalErrored: 0, assets: new Map() };\n      this.summaryByType.set(type, typeSummary);\n    }\n    typeSummary.assets.set(ref, assetRecord);\n    typeSummary.totalToLoad++;\n    this.summary.totalToLoad++;\n    this.onProgress();\n  }\n\n  public setInitialLoad(result: true | Error): void {\n    if (result instanceof Error) {\n      this.initialLoad = result;\n    } else {\n      this.initialLoad = true;\n    }\n    this.onProgress();\n  }\n\n  public disposeOfLoadingAsset(ref: unknown): void {\n    const asset = this.loadingAssets.get(ref);\n    if (asset) {\n      this.loadingAssets.delete(ref);\n      const { type, loadStatus } = asset;\n      const typeSummary = this.summaryByType.get(type);\n      if (typeSummary) {\n        typeSummary.assets.delete(ref);\n        typeSummary.totalToLoad--;\n        this.summary.totalToLoad--;\n        if (loadStatus === true) {\n          typeSummary.totalLoaded--;\n          this.summary.totalLoaded--;\n        } else if (loadStatus instanceof Error) {\n          typeSummary.totalErrored--;\n          this.summary.totalErrored--;\n        }\n        this.onProgress();\n      }\n    }\n  }\n\n  public errorLoadingAsset(ref: unknown, err: Error) {\n    const asset = this.loadingAssets.get(ref);\n    if (asset) {\n      const { type } = asset;\n      asset.loadStatus = err;\n      const typeSummary = this.summaryByType.get(type);\n      if (typeSummary) {\n        typeSummary.totalErrored++;\n        this.summary.totalErrored++;\n        this.onProgress();\n      }\n    }\n  }\n\n  public updateAssetProgress(ref: unknown, progressRatio: number): void {\n    const asset = this.loadingAssets.get(ref);\n    if (asset) {\n      asset.progressRatio = progressRatio;\n      this.onProgress();\n    }\n  }\n\n  public completedLoadingAsset(ref: unknown): void {\n    const asset = this.loadingAssets.get(ref);\n    if (asset) {\n      const { type } = asset;\n      asset.loadStatus = true;\n      const typeSummary = this.summaryByType.get(type);\n      if (typeSummary) {\n        typeSummary.totalLoaded++;\n        this.summary.totalLoaded++;\n        this.onProgress();\n      }\n    }\n  }\n\n  public addLoadingDocument(\n    ref: unknown,\n    documentUrl: string,\n    progressManager: LoadingProgressManager,\n  ): void {\n    this.loadingDocuments.set(ref, { documentUrl, progressManager });\n    this.onProgress();\n  }\n\n  public removeLoadingDocument(ref: unknown): void {\n    this.loadingDocuments.delete(ref);\n    this.onProgress();\n  }\n\n  public updateDocumentProgress(ref: unknown): void {\n    const loadingDocument = this.loadingDocuments.get(ref);\n    if (loadingDocument) {\n      this.onProgress();\n    }\n  }\n\n  public toSummary(): LoadingProgressSummary {\n    const loadingProgressSummary: LoadingProgressSummary = {\n      initialLoad: this.initialLoad,\n      summary: { ...this.summary },\n      summaryByType: {},\n      innerDocuments: [],\n    };\n\n    for (const [key, ofType] of this.summaryByType) {\n      const ofTypeSummary: LoadingCountSummary & { assetErrors: Array<[string, Error]> } = {\n        totalToLoad: ofType.totalToLoad,\n        totalLoaded: ofType.totalLoaded,\n        totalErrored: ofType.totalErrored,\n        assetErrors: [],\n      };\n      if (ofType.totalErrored > 0) {\n        for (const [, asset] of ofType.assets) {\n          if (asset.loadStatus instanceof Error) {\n            ofTypeSummary.assetErrors.push([asset.assetUrl, asset.loadStatus]);\n          }\n        }\n      }\n      loadingProgressSummary.summaryByType[key] = ofTypeSummary;\n    }\n    for (const [, innerDocProgress] of this.loadingDocuments) {\n      loadingProgressSummary.innerDocuments.push([\n        innerDocProgress.documentUrl,\n        innerDocProgress.progressManager.toSummary(),\n      ]);\n    }\n    return loadingProgressSummary;\n  }\n\n  public static LoadingProgressSummaryToString(\n    loadingProgressSummary: LoadingProgressSummary,\n  ): string {\n    const text: Array<string> = [];\n    const showDocProgress = (docUrl: string, docProgress: LoadingProgressSummary) => {\n      if (docProgress.initialLoad instanceof Error) {\n        text.push(`${docUrl}: Error: ${docProgress.initialLoad.message}`);\n        return;\n      } else if (!docProgress.initialLoad) {\n        text.push(`${docUrl}: Loading...`);\n        return;\n      }\n      text.push(\n        `${docUrl}: (${docProgress.summary.totalLoaded} loaded, ${\n          docProgress.summary.totalErrored\n        } errors) / (${docProgress.summary.totalToLoad} to load) = ${\n          docProgress.summary.totalLoaded + docProgress.summary.totalErrored\n        }/${docProgress.summary.totalToLoad}`,\n      );\n      for (const key in docProgress.summaryByType) {\n        const ofType = docProgress.summaryByType[key];\n        text.push(\n          ` - ${key}: (${ofType.totalLoaded} loaded, ${ofType.totalErrored} errors) / (${\n            ofType.totalToLoad\n          } to load) = ${ofType.totalLoaded + ofType.totalErrored}/${ofType.totalToLoad}`,\n        );\n        if (ofType.totalErrored > 0) {\n          text.push(`   - Errors:`);\n          for (const [assetUrl, error] of ofType.assetErrors) {\n            text.push(`     - ${assetUrl}: ${error.message}`);\n          }\n        }\n      }\n      for (const [innerDocumentUrl, innerDocProgress] of docProgress.innerDocuments) {\n        showDocProgress(innerDocumentUrl, innerDocProgress);\n      }\n    };\n    showDocProgress(\"root\", loadingProgressSummary);\n    return text.join(\"\\n\");\n  }\n\n  public toRatio(): [number, boolean] {\n    if (!this.initialLoad) {\n      return [0, false];\n    }\n    if (this.initialLoad instanceof Error) {\n      return [1, true];\n    }\n\n    let totalRatio = 0;\n    let complete = true;\n\n    let numberOfDocuments = this.loadingDocuments.size;\n\n    if (this.summary.totalToLoad > 0) {\n      numberOfDocuments += 1;\n      const loadedAndErrored = this.summary.totalLoaded + this.summary.totalErrored;\n      complete = complete && loadedAndErrored === this.summary.totalToLoad;\n      let directAssetsLoadedRatio = 0;\n      for (const [, asset] of this.loadingAssets) {\n        if (asset.loadStatus instanceof Error || asset.loadStatus) {\n          directAssetsLoadedRatio += 1;\n        } else {\n          directAssetsLoadedRatio += asset.progressRatio;\n        }\n      }\n      directAssetsLoadedRatio /= this.summary.totalToLoad;\n      totalRatio += directAssetsLoadedRatio / numberOfDocuments;\n    } else if (this.loadingDocuments.size === 0) {\n      // There are no assets to load and no inner documents, so loading is complete\n      return [1, true];\n    }\n\n    for (const [, innerDocument] of this.loadingDocuments) {\n      const [innerDocumentRatio, innerDocumentComplete] = innerDocument.progressManager.toRatio();\n      totalRatio += innerDocumentRatio / numberOfDocuments;\n      complete = complete && innerDocumentComplete;\n    }\n\n    return [totalRatio, complete];\n  }\n}\n", "import { LoadingProgressManager } from \"./LoadingProgressManager\";\n\nexport class LoadingProgressBar {\n  public readonly element: HTMLDivElement;\n\n  private progressBarHolder: HTMLDivElement;\n  private progressBar: HTMLDivElement;\n  private loadingStatusText: HTMLDivElement;\n\n  private progressDebugView: HTMLDivElement;\n  private progressDebugElement: HTMLPreElement;\n\n  private debugLabel: HTMLLabelElement;\n  private debugCheckbox: HTMLInputElement;\n\n  private hasCompleted = false;\n  private disposed = false;\n  private loadingCallback: () => void;\n\n  constructor(\n    private loadingProgressManager: LoadingProgressManager,\n    private showDebugLoading: boolean,\n  ) {\n    this.element = document.createElement(\"div\");\n    this.element.addEventListener(\"click\", (event) => {\n      event.stopPropagation();\n    });\n    this.element.addEventListener(\"mousedown\", (event) => {\n      event.stopPropagation();\n    });\n    this.element.addEventListener(\"mousemove\", (event) => {\n      event.stopPropagation();\n    });\n    this.element.addEventListener(\"mouseup\", (event) => {\n      event.stopPropagation();\n    });\n\n    this.progressDebugView = document.createElement(\"div\");\n    this.progressDebugView.style.position = \"absolute\";\n    this.progressDebugView.style.backgroundColor = \"rgba(128, 128, 128, 0.25)\";\n    this.progressDebugView.style.top = \"20px\";\n    this.progressDebugView.style.left = \"0\";\n    this.progressDebugView.style.border = \"1px solid black\";\n    this.progressDebugView.style.maxHeight = \"calc(100% - 20px)\";\n    this.progressDebugView.style.maxWidth = \"100%\";\n    this.progressDebugView.style.overflow = \"auto\";\n    this.element.append(this.progressDebugView);\n\n    this.debugCheckbox = document.createElement(\"input\");\n    this.debugCheckbox.type = \"checkbox\";\n    this.debugCheckbox.addEventListener(\"change\", () => {\n      this.progressDebugElement.style.display = this.debugCheckbox.checked ? \"block\" : \"none\";\n      if (this.hasCompleted) {\n        this.dispose();\n      }\n    });\n\n    if (this.showDebugLoading) {\n      this.debugLabel = document.createElement(\"label\");\n      this.debugLabel.textContent = \"Debug loading\";\n      this.debugLabel.style.fontFamily = \"sans-serif\";\n      this.debugLabel.style.padding = \"5px\";\n      this.debugLabel.style.display = \"inline-block\";\n      this.debugLabel.style.userSelect = \"none\";\n      this.debugLabel.append(this.debugCheckbox);\n      this.progressDebugView.append(this.debugLabel);\n    }\n\n    this.progressDebugElement = document.createElement(\"pre\");\n    this.progressDebugElement.style.margin = \"0\";\n    this.progressDebugElement.style.display = this.debugCheckbox.checked ? \"block\" : \"none\";\n    this.progressDebugView.append(this.progressDebugElement);\n\n    this.progressBarHolder = document.createElement(\"div\");\n    this.progressBarHolder.style.position = \"absolute\";\n    this.progressBarHolder.style.top = \"0\";\n    this.progressBarHolder.style.left = \"0\";\n    this.progressBarHolder.style.width = \"100%\";\n    this.progressBarHolder.style.backgroundColor = \"gray\";\n    this.progressBarHolder.style.height = \"20px\";\n    this.element.append(this.progressBarHolder);\n\n    this.progressBar = document.createElement(\"div\");\n    this.progressBar.style.position = \"absolute\";\n    this.progressBar.style.top = \"0\";\n    this.progressBar.style.left = \"0\";\n    this.progressBar.style.width = \"0\";\n    this.progressBar.style.height = \"100%\";\n    this.progressBar.style.backgroundColor = \"#0050a4\";\n    this.progressBarHolder.append(this.progressBar);\n\n    this.loadingStatusText = document.createElement(\"div\");\n    this.loadingStatusText.style.position = \"absolute\";\n    this.loadingStatusText.style.top = \"0\";\n    this.loadingStatusText.style.left = \"0\";\n    this.loadingStatusText.style.width = \"100%\";\n    this.loadingStatusText.style.height = \"100%\";\n    this.loadingStatusText.style.color = \"white\";\n    this.loadingStatusText.style.textAlign = \"center\";\n    this.loadingStatusText.style.verticalAlign = \"middle\";\n    this.loadingStatusText.style.lineHeight = \"20px\";\n    this.loadingStatusText.style.fontFamily = \"sans-serif\";\n    this.loadingStatusText.textContent = \"Loading...\";\n    this.progressBarHolder.append(this.loadingStatusText);\n\n    this.loadingCallback = () => {\n      const [loadingRatio, completedLoading] = this.loadingProgressManager.toRatio();\n      if (completedLoading) {\n        if (!this.hasCompleted) {\n          this.hasCompleted = true;\n          if (!this.debugCheckbox.checked) {\n            this.dispose();\n          }\n        }\n        this.loadingStatusText.textContent = \"Completed\";\n        this.progressBar.style.width = \"100%\";\n      } else {\n        this.loadingStatusText.textContent = `Loading... ${(loadingRatio * 100).toFixed(2)}%`;\n        this.progressBar.style.width = `${loadingRatio * 100}%`;\n      }\n      this.progressDebugElement.textContent = LoadingProgressManager.LoadingProgressSummaryToString(\n        this.loadingProgressManager.toSummary(),\n      );\n    };\n\n    this.loadingProgressManager.addProgressCallback(this.loadingCallback);\n  }\n\n  public dispose() {\n    if (this.disposed) {\n      return;\n    }\n    this.disposed = true;\n    this.loadingProgressManager.removeProgressCallback(this.loadingCallback);\n    this.element.remove();\n  }\n}\n", "import { LoadingProgressManager } from \"./LoadingProgressManager\";\n\nexport class LoadingSpinner {\n  public readonly element: HTMLDivElement;\n\n  private progressBarHolder: HTMLDivElement;\n  private progressBar: HTMLDivElement;\n\n  private hasCompleted = false;\n  private disposed = false;\n  private loadingCallback: () => void;\n\n  constructor(private loadingProgressManager: LoadingProgressManager) {\n    this.element = document.createElement(\"div\");\n\n    this.progressBarHolder = document.createElement(\"div\");\n    this.progressBarHolder.style.position = \"absolute\";\n    this.progressBarHolder.style.top = \"50%\";\n    this.progressBarHolder.style.left = \"50%\";\n    this.progressBarHolder.style.transform = \"translate(-50%, -50%)\";\n    this.progressBarHolder.style.width = \"60px\";\n    this.progressBarHolder.style.height = \"60px\";\n    this.element.append(this.progressBarHolder);\n\n    this.progressBar = document.createElement(\"div\");\n    this.progressBar.style.position = \"absolute\";\n    this.progressBar.style.top = \"0\";\n    this.progressBar.style.left = \"0\";\n    this.progressBar.style.width = \"100%\";\n    this.progressBar.style.height = \"100%\";\n    this.progressBar.style.border = \"6px solid #f3f3f3\";\n    this.progressBar.style.borderTop = \"6px solid rgba(0, 0, 0, 0)\";\n    this.progressBar.style.borderRadius = \"50%\";\n    this.progressBarHolder.append(this.progressBar);\n\n    this.progressBar.animate([{ transform: \"rotate(0deg)\" }, { transform: \"rotate(360deg)\" }], {\n      duration: 1000,\n      iterations: Infinity,\n    });\n\n    this.loadingCallback = () => {\n      const [, completedLoading] = this.loadingProgressManager.toRatio();\n      if (completedLoading) {\n        if (!this.hasCompleted) {\n          this.hasCompleted = true;\n          this.dispose();\n        }\n        this.progressBar.style.display = \"none\";\n      } else {\n        this.progressBar.style.display = \"block\";\n      }\n    };\n\n    this.loadingProgressManager.addProgressCallback(this.loadingCallback);\n  }\n\n  public dispose() {\n    if (this.disposed) {\n      return;\n    }\n    this.disposed = true;\n    this.loadingProgressManager.removeProgressCallback(this.loadingCallback);\n    this.element.remove();\n  }\n}\n", "import { DOMSanitizer } from \"@mml-io/networked-dom-web\";\n\nlet domParser: DOMParser;\n\nexport async function fetchRemoteStaticMML(address: string): Promise<HTMLElement> {\n  const response = await fetch(address);\n  const text = await response.text();\n  if (!domParser) {\n    domParser = new DOMParser();\n  }\n  const remoteDocumentAsHTMLNode = domParser.parseFromString(text, \"text/html\");\n  return DOMSanitizer.sanitise(remoteDocumentAsHTMLNode.body, {\n    tagPrefix: \"m-\",\n    replacementTagPrefix: \"x-\",\n  });\n}\n", "import { consumeEventEventName } from \"../elements\";\nimport { RemoteDocument } from \"../elements\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { IMMLScene } from \"../scene\";\n\n/**\n * The RemoteDocumentWrapper class creates an m-remote-document (RemoteDocument) element and initialises it with the\n * given address. It is expected that the `remoteDocument` element will be added to the DOM by the caller.\n */\nexport class RemoteDocumentWrapper<G extends GraphicsAdapter = GraphicsAdapter> {\n  public readonly remoteDocument: RemoteDocument<G>;\n\n  constructor(\n    address: string,\n    targetWindow: Window,\n    mmlScene: IMMLScene<G>,\n    handleEvent: (element: HTMLElement, event: CustomEvent) => void,\n  ) {\n    this.remoteDocument = targetWindow.document.createElement(\n      RemoteDocument.tagName,\n    ) as RemoteDocument<G>;\n    this.remoteDocument.addEventListener(consumeEventEventName, (wrappedEvent: CustomEvent) => {\n      const { originalEvent, element } = wrappedEvent.detail;\n      handleEvent(element, originalEvent);\n    });\n    this.remoteDocument.init(mmlScene, address);\n  }\n\n  public setDocumentTime(documentTime: number) {\n    this.remoteDocument.getDocumentTimeManager().setDocumentTime(documentTime);\n  }\n\n  public overrideDocumentTime(documentTime: number) {\n    this.remoteDocument.getDocumentTimeManager().overrideDocumentTime(documentTime);\n  }\n}\n", "import { MElement } from \"../elements\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { LoadingProgressManager } from \"../loading\";\nimport { fetchRemoteStaticMML, RemoteDocumentWrapper } from \"../remote-document\";\nimport { IMMLScene } from \"../scene\";\nimport { createWrappedScene } from \"./CreateWrappedScene\";\n\nexport class StaticHTMLFrameInstance<G extends GraphicsAdapter = GraphicsAdapter> {\n  public readonly src: string;\n  private readonly remoteDocumentWrapper: RemoteDocumentWrapper<G>;\n  private readonly targetForWrapper: MElement<G>;\n  private readonly scene: IMMLScene<G>;\n  private loadingProgressManager: LoadingProgressManager;\n\n  constructor(targetElement: MElement<G>, src: string, scene: IMMLScene<G>) {\n    this.targetForWrapper = targetElement;\n    this.src = src;\n    this.scene = scene;\n\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const windowTarget = targetElement.ownerDocument.defaultView!;\n\n    this.loadingProgressManager = new LoadingProgressManager();\n    this.loadingProgressManager.addProgressCallback(() => {\n      scene.getLoadingProgressManager?.()?.updateDocumentProgress(this);\n    });\n\n    const address = this.targetForWrapper.contentSrcToContentAddress(this.src);\n\n    scene\n      .getLoadingProgressManager?.()\n      ?.addLoadingDocument(this, address, this.loadingProgressManager);\n\n    const wrappedScene: IMMLScene<G> = createWrappedScene(this.scene, this.loadingProgressManager);\n\n    this.remoteDocumentWrapper = new RemoteDocumentWrapper(\n      address,\n      windowTarget,\n      wrappedScene,\n      () => {\n        // Events targeting static MML frames should not be sent\n      },\n    );\n    this.targetForWrapper.append(this.remoteDocumentWrapper.remoteDocument);\n    // Promise is intentionally ignored here\n    fetchRemoteStaticMML(address)\n      .then((remoteDocumentBody) => {\n        this.remoteDocumentWrapper.remoteDocument.append(remoteDocumentBody);\n        this.loadingProgressManager.setInitialLoad(true);\n      })\n      .catch((err) => {\n        this.loadingProgressManager.setInitialLoad(err);\n      });\n  }\n\n  public dispose() {\n    this.targetForWrapper.removeChild(this.remoteDocumentWrapper.remoteDocument);\n    this.loadingProgressManager.removeLoadingDocument(this);\n  }\n}\n", "import { NetworkedDOMWebsocket, NetworkedDOMWebsocketStatus } from \"@mml-io/networked-dom-web\";\n\nimport { consumeEventEventName, MElement } from \"../elements\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { LoadingProgressManager } from \"../loading\";\nimport { MMLNetworkSource } from \"../network\";\nimport { RemoteDocumentWrapper } from \"../remote-document\";\nimport { IMMLScene } from \"../scene\";\nimport { createWrappedScene } from \"./CreateWrappedScene\";\n\nexport class WebSocketFrameInstance<G extends GraphicsAdapter = GraphicsAdapter> {\n  public readonly src: string;\n  private domWebsocket: NetworkedDOMWebsocket;\n  private targetForWrapper: MElement<G>;\n  private readonly remoteDocumentWrapper: RemoteDocumentWrapper<G>;\n  private scene: IMMLScene<G>;\n  private loadingProgressManager: LoadingProgressManager;\n\n  constructor(targetElement: MElement<G>, src: string, scene: IMMLScene<G>) {\n    this.targetForWrapper = targetElement;\n    this.src = src;\n    this.scene = scene;\n\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const windowTarget = targetElement.ownerDocument.defaultView!;\n\n    let overriddenHandler: ((element: MElement<G>, event: CustomEvent) => void) | null = null;\n    const eventHandler = (element: MElement<G>, event: CustomEvent) => {\n      if (!overriddenHandler) {\n        throw new Error(\"overriddenHandler not set\");\n      }\n      overriddenHandler(element, event);\n    };\n\n    this.loadingProgressManager = new LoadingProgressManager();\n    this.loadingProgressManager.addProgressCallback(() => {\n      scene.getLoadingProgressManager?.()?.updateDocumentProgress(this);\n    });\n\n    const websocketAddress = MMLNetworkSource.resolveRelativeUrl(this.getDocumentHost(), this.src);\n\n    scene\n      .getLoadingProgressManager?.()\n      ?.addLoadingDocument(this, websocketAddress, this.loadingProgressManager);\n\n    const wrappedScene: IMMLScene<G> = createWrappedScene(this.scene, this.loadingProgressManager);\n\n    this.remoteDocumentWrapper = new RemoteDocumentWrapper(\n      websocketAddress,\n      windowTarget,\n      wrappedScene,\n      () => {\n        // Events targeting static MML frames should not be sent\n      },\n    );\n\n    this.targetForWrapper.append(this.remoteDocumentWrapper.remoteDocument);\n\n    this.remoteDocumentWrapper.remoteDocument.addEventListener(\n      consumeEventEventName,\n      (wrappedEvent: CustomEvent) => {\n        const { originalEvent, element } = wrappedEvent.detail;\n        eventHandler(element, originalEvent);\n      },\n    );\n\n    this.domWebsocket = new NetworkedDOMWebsocket(\n      websocketAddress,\n      NetworkedDOMWebsocket.createWebSocket,\n      this.remoteDocumentWrapper.remoteDocument,\n      (time: number) => {\n        this.remoteDocumentWrapper.remoteDocument.getDocumentTimeManager().setDocumentTime(time);\n      },\n      (status: NetworkedDOMWebsocketStatus) => {\n        if (status === NetworkedDOMWebsocketStatus.Reconnecting) {\n          this.remoteDocumentWrapper.remoteDocument.showError(true);\n          this.loadingProgressManager.setInitialLoad(new Error(\"Failed to connect\"));\n        } else if (status === NetworkedDOMWebsocketStatus.Connected) {\n          this.remoteDocumentWrapper.remoteDocument.showError(false);\n          this.loadingProgressManager.setInitialLoad(true);\n        } else {\n          this.remoteDocumentWrapper.remoteDocument.showError(false);\n        }\n      },\n      {\n        tagPrefix: \"m-\",\n      },\n    );\n    overriddenHandler = (element: MElement<G>, event: CustomEvent) => {\n      this.domWebsocket.handleEvent(element, event);\n    };\n  }\n\n  private getDocumentHost(): string {\n    const remoteDocument = this.targetForWrapper.getInitiatedRemoteDocument();\n    if (remoteDocument) {\n      const remoteDocumentAddress = remoteDocument.getDocumentAddress();\n      if (remoteDocumentAddress) {\n        const url = new URL(remoteDocumentAddress);\n        return url.host;\n      }\n    }\n    return window.location.host;\n  }\n\n  dispose() {\n    this.domWebsocket.stop();\n    this.targetForWrapper.removeChild(this.remoteDocumentWrapper.remoteDocument);\n    this.scene.getLoadingProgressManager?.()?.removeLoadingDocument(this);\n  }\n}\n", "import { NetworkedDOMWebsocket, NetworkedDOMWebsocketStatus } from \"@mml-io/networked-dom-web\";\n\nimport { createWrappedScene } from \"../frame\";\nimport { LoadingProgressManager } from \"../loading\";\nimport { fetchRemoteStaticMML, RemoteDocumentWrapper } from \"../remote-document\";\nimport { IMMLScene } from \"../scene\";\n\nexport type MMLNetworkSourceOptions = {\n  url: string;\n  connectionToken?: string | null;\n  mmlScene: IMMLScene;\n  statusUpdated: (status: NetworkedDOMWebsocketStatus) => void;\n  windowTarget: Window;\n  targetForWrappers: HTMLElement;\n  allowOverlay?: boolean;\n};\n\nexport class MMLNetworkSource {\n  private websocket: NetworkedDOMWebsocket | null = null;\n  public remoteDocumentWrapper: RemoteDocumentWrapper;\n\n  private constructor(private options: MMLNetworkSourceOptions) {}\n\n  static create(options: MMLNetworkSourceOptions) {\n    const mmlNetworkSource = new MMLNetworkSource(options);\n    mmlNetworkSource.init();\n    return mmlNetworkSource;\n  }\n\n  private init() {\n    let overriddenHandler: ((element: HTMLElement, event: CustomEvent) => void) | null = null;\n    const eventHandler = (element: HTMLElement, event: CustomEvent) => {\n      if (!overriddenHandler) {\n        throw new Error(\"overriddenHandler not set\");\n      }\n      overriddenHandler(element, event);\n    };\n\n    const loadingProgressManager = new LoadingProgressManager();\n\n    const wrappedScene = createWrappedScene(this.options.mmlScene, loadingProgressManager);\n\n    const src = this.options.url;\n    this.remoteDocumentWrapper = new RemoteDocumentWrapper(\n      src,\n      this.options.windowTarget,\n      wrappedScene,\n      eventHandler,\n    );\n    this.options.targetForWrappers.append(this.remoteDocumentWrapper.remoteDocument);\n\n    let sceneLoadingProgressManager: LoadingProgressManager | null = null;\n    if (this.options.mmlScene.getLoadingProgressManager) {\n      sceneLoadingProgressManager = this.options.mmlScene.getLoadingProgressManager();\n      loadingProgressManager.addProgressCallback(() => {\n        sceneLoadingProgressManager?.updateDocumentProgress(this);\n      });\n    }\n\n    const isWebsocket = src.startsWith(\"ws://\") || src.startsWith(\"wss://\");\n    if (isWebsocket) {\n      const websocket = new NetworkedDOMWebsocket(\n        this.options.url,\n        NetworkedDOMWebsocket.createWebSocket,\n        this.remoteDocumentWrapper.remoteDocument,\n        (time: number) => {\n          this.remoteDocumentWrapper.setDocumentTime(time);\n        },\n        (status: NetworkedDOMWebsocketStatus) => {\n          if (status === NetworkedDOMWebsocketStatus.Reconnecting) {\n            this.remoteDocumentWrapper.remoteDocument.showError(true);\n            loadingProgressManager.setInitialLoad(new Error(\"Failed to connect\"));\n          } else if (status === NetworkedDOMWebsocketStatus.Connected) {\n            this.remoteDocumentWrapper.remoteDocument.showError(false);\n            loadingProgressManager.setInitialLoad(true);\n          } else {\n            this.remoteDocumentWrapper.remoteDocument.showError(false);\n          }\n          this.options.statusUpdated(status);\n        },\n        {\n          tagPrefix: \"m-\",\n          // If overlays are allowed, allow SVG elements to populate them\n          allowSVGElements: this.options.allowOverlay,\n          connectionToken: this.options.connectionToken ?? null,\n        },\n      );\n      this.websocket = websocket;\n      overriddenHandler = (element: HTMLElement, event: CustomEvent) => {\n        websocket.handleEvent(element, event);\n      };\n    } else {\n      fetchRemoteStaticMML(this.options.url)\n        .then((remoteDocumentBody) => {\n          this.remoteDocumentWrapper.remoteDocument.append(remoteDocumentBody);\n          loadingProgressManager?.setInitialLoad(true);\n        })\n        .catch((err) => {\n          loadingProgressManager?.setInitialLoad(err);\n        });\n      overriddenHandler = () => {\n        // Do nothing\n      };\n    }\n\n    sceneLoadingProgressManager?.addLoadingDocument(this, this.options.url, loadingProgressManager);\n  }\n\n  /**\n   * Returns a URL relative to the given host if the src starts with \"ws:///\" or \"wss:///\".\n   * If the src does not start with either prefix, it is returned unchanged.\n   *\n   * @param {string} host - The host to use for constructing the potentially relative URL.\n   * @param {string} src - The URL, which may be relative (starting with \"ws:///\" or \"wss:///\") or absolute.\n   * @returns {string} The absolute URL (if it were previously relative ws:/// or wss:///).\n   */\n  public static resolveRelativeUrl(host: string, src: string): string {\n    const insecurePrefix = \"ws:///\";\n    const securePrefix = \"wss:///\";\n    if (src.startsWith(insecurePrefix)) {\n      // Relative insecure websocket path\n      return `ws://${host}/${src.substring(insecurePrefix.length)}`;\n    } else if (src.startsWith(securePrefix)) {\n      // Relative secure websocket path\n      return `wss://${host}/${src.substring(securePrefix.length)}`;\n    } else {\n      return src;\n    }\n  }\n\n  dispose() {\n    if (this.websocket) {\n      this.websocket.stop();\n      this.websocket = null;\n    }\n    this.options.mmlScene.getLoadingProgressManager?.()?.removeLoadingDocument(this);\n    this.remoteDocumentWrapper.remoteDocument.remove();\n  }\n}\n", "import { AttributeHandler, parseBoolAttribute, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { StaticHTMLFrameInstance, WebSocketFrameInstance } from \"../frame\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { FrameGraphics } from \"../graphics/FrameGraphics\";\nimport { Vect3 } from \"../math/Vect3\";\nimport { getRelativePositionAndRotationRelativeToObject } from \"../position\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultUnloadRange = 1;\nconst defaultFrameDebug = false;\n\nexport type MFrameProps = {\n  src: string | null;\n  loadRange: number | null;\n  unloadRange: number;\n\n  debug: boolean;\n\n  minX: number | null;\n  maxX: number | null;\n  minY: number | null;\n  maxY: number | null;\n  minZ: number | null;\n  maxZ: number | null;\n};\n\nexport class Frame<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-frame\";\n  private frameGraphics: FrameGraphics<G> | null;\n  private hasInitialized = false;\n\n  private static attributeHandler = new AttributeHandler<Frame<GraphicsAdapter>>({\n    src: (instance, newValue) => {\n      instance.props.src = newValue;\n      if (instance.frameContentsInstance) {\n        instance.disposeInstance();\n      }\n      instance.syncLoadState();\n      instance.frameGraphics?.setSrc(instance.props.src, instance.props);\n    },\n    \"load-range\": (instance, newValue) => {\n      instance.props.loadRange = parseFloatAttribute(newValue, null);\n      instance.syncLoadState();\n      instance.frameGraphics?.setLoadRange(instance.props.loadRange, instance.props);\n    },\n    \"unload-range\": (instance, newValue) => {\n      instance.props.unloadRange = parseFloatAttribute(newValue, defaultUnloadRange);\n      instance.syncLoadState();\n      instance.frameGraphics?.setUnloadRange(instance.props.unloadRange, instance.props);\n    },\n    debug: (instance, newValue) => {\n      instance.props.debug = parseBoolAttribute(newValue, defaultFrameDebug);\n      instance.frameGraphics?.setDebug(instance.props.debug, instance.props);\n    },\n    \"min-x\": (instance, newValue) => {\n      instance.props.minX = parseFloatAttribute(newValue, null);\n      instance.boundsUpdated();\n      instance.frameGraphics?.setMinX(instance.props.minX, instance.props);\n    },\n    \"max-x\": (instance, newValue) => {\n      instance.props.maxX = parseFloatAttribute(newValue, null);\n      instance.boundsUpdated();\n      instance.frameGraphics?.setMaxX(instance.props.maxX, instance.props);\n    },\n    \"min-y\": (instance, newValue) => {\n      instance.props.minY = parseFloatAttribute(newValue, null);\n      instance.boundsUpdated();\n      instance.frameGraphics?.setMinY(instance.props.minY, instance.props);\n    },\n    \"max-y\": (instance, newValue) => {\n      instance.props.maxY = parseFloatAttribute(newValue, null);\n      instance.boundsUpdated();\n      instance.frameGraphics?.setMaxY(instance.props.maxY, instance.props);\n    },\n    \"min-z\": (instance, newValue) => {\n      instance.props.minZ = parseFloatAttribute(newValue, null);\n      instance.boundsUpdated();\n      instance.frameGraphics?.setMinZ(instance.props.minZ, instance.props);\n    },\n    \"max-z\": (instance, newValue) => {\n      instance.props.maxZ = parseFloatAttribute(newValue, null);\n      instance.boundsUpdated();\n      instance.frameGraphics?.setMaxZ(instance.props.maxZ, instance.props);\n    },\n  });\n\n  protected enable() {\n    // no-op\n  }\n\n  protected disable() {\n    // no-op\n  }\n\n  private frameContentsInstance: WebSocketFrameInstance<G> | StaticHTMLFrameInstance<G> | null =\n    null;\n  private isActivelyLoaded = false;\n  private timer: NodeJS.Timeout | null = null;\n\n  private boundsUpdated() {\n    if (!this.transformableElementGraphics) {\n      return;\n    }\n    const boxBounds = this.getDefinedBoxBounds();\n    if (boxBounds) {\n      const [minX, maxX, minY, maxY, minZ, maxZ] = boxBounds;\n      const obb = OrientedBoundingBox.fromSizeMatrixWorldAndCenter(\n        new Vect3(maxX - minX, maxY - minY, maxZ - minZ),\n        this.transformableElementGraphics.getWorldMatrix(),\n        new Vect3((maxX + minX) / 2, (maxY + minY) / 2, (maxZ + minZ) / 2),\n      );\n      this.addOrUpdateParentBound(this, obb);\n    } else {\n      this.removeParentBound(this);\n    }\n  }\n\n  public props: MFrameProps = {\n    src: null,\n    loadRange: null,\n    unloadRange: defaultUnloadRange,\n\n    debug: defaultFrameDebug,\n\n    minX: null,\n    maxX: null,\n    minY: null,\n    maxY: null,\n    minZ: null,\n    maxZ: null,\n  };\n\n  private shouldBeLoaded() {\n    if (!this.hasInitialized) {\n      return false;\n    }\n    if (!this.isConnected) {\n      return false;\n    }\n    if (this.props.loadRange === null) {\n      return true;\n    }\n\n    const userPositionAndRotation = this.getUserPositionAndRotation();\n    const elementRelative = getRelativePositionAndRotationRelativeToObject(\n      userPositionAndRotation,\n      this,\n    );\n\n    let boxBounds = this.getDefinedBoxBounds();\n    if (!boxBounds) {\n      boxBounds = [0, 0, 0, 0, 0, 0];\n    }\n    const [minX, maxX, minY, maxY, minZ, maxZ] = boxBounds;\n    if (\n      elementRelative.position.x >= minX - this.props.loadRange &&\n      elementRelative.position.x <= maxX + this.props.loadRange &&\n      elementRelative.position.y >= minY - this.props.loadRange &&\n      elementRelative.position.y <= maxY + this.props.loadRange &&\n      elementRelative.position.z >= minZ - this.props.loadRange &&\n      elementRelative.position.z <= maxZ + this.props.loadRange\n    ) {\n      return true;\n    }\n    // If the user is within the unload-range range, keep the current state\n    if (\n      elementRelative.position.x >= minX - this.props.loadRange - this.props.unloadRange &&\n      elementRelative.position.x <= maxX + this.props.loadRange + this.props.unloadRange &&\n      elementRelative.position.y >= minY - this.props.loadRange - this.props.unloadRange &&\n      elementRelative.position.y <= maxY + this.props.loadRange + this.props.unloadRange &&\n      elementRelative.position.z >= minZ - this.props.loadRange - this.props.unloadRange &&\n      elementRelative.position.z <= maxZ + this.props.loadRange + this.props.unloadRange\n    ) {\n      return this.isActivelyLoaded;\n    }\n  }\n\n  private syncLoadState() {\n    const shouldBeLoaded = this.shouldBeLoaded();\n    if (shouldBeLoaded && !this.isActivelyLoaded) {\n      if (this.props.src) {\n        this.isActivelyLoaded = true;\n        this.createFrameContentsInstance(this.props.src);\n      }\n    } else if (!shouldBeLoaded && this.isActivelyLoaded) {\n      this.isActivelyLoaded = false;\n      this.disposeInstance();\n    }\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [...TransformableElement.observedAttributes, ...Frame.attributeHandler.getAttributes()];\n  }\n\n  constructor() {\n    super();\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    return null;\n  }\n\n  public parentTransformed(): void {\n    this.boundsUpdated();\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  private startEmitting() {\n    if (this.timer) {\n      clearInterval(this.timer);\n    }\n\n    this.timer = setInterval(() => {\n      this.syncLoadState();\n    }, 100);\n  }\n\n  private createFrameContentsInstance(src: string) {\n    if (this.frameContentsInstance) {\n      if (this.frameContentsInstance.src !== src) {\n        console.error(\"Instance already existed with a different src\");\n        this.disposeInstance();\n      } else {\n        return;\n      }\n    }\n\n    if (src.startsWith(\"ws://\") || src.startsWith(\"wss://\")) {\n      this.frameContentsInstance = new WebSocketFrameInstance(this, src, this.getScene());\n    } else {\n      this.frameContentsInstance = new StaticHTMLFrameInstance(this, src, this.getScene());\n    }\n  }\n\n  public getDefinedBoxBounds(): [number, number, number, number, number, number] | null {\n    if (\n      this.props.minX !== null ||\n      this.props.maxX !== null ||\n      this.props.minY !== null ||\n      this.props.maxY !== null ||\n      this.props.minZ !== null ||\n      this.props.maxZ !== null\n    ) {\n      const minX = this.props.minX ?? this.props.maxX ?? 0;\n      let maxX = this.props.maxX ?? this.props.minX ?? 0;\n      const minY = this.props.minY ?? this.props.maxY ?? 0;\n      let maxY = this.props.maxY ?? this.props.minY ?? 0;\n      const minZ = this.props.minZ ?? this.props.maxZ ?? 0;\n      let maxZ = this.props.maxZ ?? this.props.minZ ?? 0;\n      // If any bounds are incorrect make them equal (and therefore not able to contain anything, but visually debuggable)\n      if (minX > maxX) {\n        maxX = minX;\n      }\n      if (minY > maxY) {\n        maxY = minY;\n      }\n      if (minZ > maxZ) {\n        maxZ = minZ;\n      }\n      return [minX, maxX, minY, maxY, minZ, maxZ];\n    }\n    return null;\n  }\n\n  private disposeInstance() {\n    if (this.frameContentsInstance !== null) {\n      this.frameContentsInstance.dispose();\n      this.frameContentsInstance = null;\n      this.isActivelyLoaded = false;\n    }\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.frameGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Frame.attributeHandler.handle(this, name, newValue);\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.frameGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.frameGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLFrameGraphicsInterface(this);\n\n    for (const name of Frame.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    // Don't allow the frame to be loaded until after all attributes have been observed\n    this.hasInitialized = true;\n    this.startEmitting();\n    this.syncLoadState();\n\n    this.applyBounds();\n  }\n\n  public disconnectedCallback(): void {\n    this.frameGraphics?.dispose();\n    this.frameGraphics = null;\n\n    if (this.timer) {\n      clearInterval(this.timer);\n    }\n    this.disposeInstance();\n    super.disconnectedCallback();\n  }\n}\n", "import { OrientedBoundingBox } from \"../bounding-box\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nexport class Group<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-group\";\n  static get observedAttributes(): Array<string> {\n    return [...TransformableElement.observedAttributes];\n  }\n\n  protected enable() {\n    // no-op\n  }\n\n  protected disable() {\n    // no-op\n  }\n\n  constructor() {\n    super();\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    return null;\n  }\n\n  public parentTransformed(): void {\n    // no-op\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.transformableElementGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter()) {\n      return;\n    }\n\n    for (const name of Group.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport { AttributeHandler, parseBoolAttribute, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { ClickableHelper } from \"../clickable/ClickableHelper\";\nimport { CollideableHelper } from \"../collision\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { ImageGraphics } from \"../graphics/ImageGraphics\";\nimport { Vect3 } from \"../math/Vect3\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultImageSrc = null;\nconst defaultImageWidth = null;\nconst defaultImageHeight = null;\nconst defaultImageOpacity = 1;\nconst defaultImageCastShadows = true;\nconst defaultImageEmissive = 0;\n\nexport type MImageProps = {\n  src: string | null;\n  width: number | null;\n  height: number | null;\n  opacity: number;\n  castShadows: boolean;\n  emissive: number;\n};\n\nexport class Image<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-image\";\n\n  public props: MImageProps = {\n    src: defaultImageSrc,\n    width: defaultImageWidth,\n    height: defaultImageHeight,\n    opacity: defaultImageOpacity,\n    castShadows: defaultImageCastShadows,\n    emissive: defaultImageEmissive as number,\n  };\n\n  private imageAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    width: [\n      AnimationType.Number,\n      defaultImageWidth,\n      (newValue: number) => {\n        this.props.width = newValue;\n        this.imageGraphics?.setWidth(newValue, this.props);\n      },\n    ],\n    height: [\n      AnimationType.Number,\n      defaultImageHeight,\n      (newValue: number) => {\n        this.props.height = newValue;\n        this.imageGraphics?.setHeight(newValue, this.props);\n      },\n    ],\n    opacity: [\n      AnimationType.Number,\n      defaultImageOpacity,\n      (newValue: number) => {\n        this.props.opacity = newValue;\n        this.imageGraphics?.setOpacity(newValue, this.props);\n      },\n    ],\n    emissive: [\n      AnimationType.Number,\n      defaultImageEmissive,\n      (newValue: number) => {\n        this.props.emissive = newValue;\n        this.imageGraphics?.setEmissive(newValue, this.props);\n      },\n    ],\n  });\n\n  private collideableHelper = new CollideableHelper(this);\n  private clickableHelper = new ClickableHelper();\n\n  private static attributeHandler = new AttributeHandler<Image<GraphicsAdapter>>({\n    width: (instance, newValue) => {\n      instance.imageAnimatedAttributeHelper.elementSetAttribute(\n        \"width\",\n        parseFloatAttribute(newValue, defaultImageWidth),\n      );\n    },\n    height: (instance, newValue) => {\n      instance.imageAnimatedAttributeHelper.elementSetAttribute(\n        \"height\",\n        parseFloatAttribute(newValue, defaultImageHeight),\n      );\n    },\n    src: (instance, newValue) => {\n      instance.props.src = newValue;\n      instance.imageGraphics?.setSrc(newValue, instance.props);\n    },\n    opacity: (instance, newValue) => {\n      instance.imageAnimatedAttributeHelper.elementSetAttribute(\n        \"opacity\",\n        parseFloatAttribute(newValue, defaultImageOpacity),\n      );\n    },\n    emissive: (instance, newValue) => {\n      instance.imageAnimatedAttributeHelper.elementSetAttribute(\n        \"emissive\",\n        parseFloatAttribute(newValue, defaultImageEmissive),\n      );\n    },\n    \"cast-shadows\": (instance, newValue) => {\n      instance.props.castShadows = parseBoolAttribute(newValue, defaultImageCastShadows);\n      instance.imageGraphics?.setCastShadows(instance.props.castShadows, instance.props);\n    },\n  });\n  private imageGraphics: ImageGraphics<G> | null;\n\n  protected enable() {\n    this.collideableHelper.enable();\n  }\n\n  protected disable() {\n    this.collideableHelper.disable();\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...Image.attributeHandler.getAttributes(),\n      ...CollideableHelper.observedAttributes,\n      ...ClickableHelper.observedAttributes,\n    ];\n  }\n\n  constructor() {\n    super();\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n    const { width, height } = this.imageGraphics?.getWidthAndHeight() || { width: 0, height: 0 };\n    return OrientedBoundingBox.fromSizeAndMatrixWorld(\n      new Vect3(width, height, 0),\n      this.transformableElementGraphics.getWorldMatrix(),\n    );\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.imageAnimatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.imageAnimatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  public parentTransformed(): void {\n    this.collideableHelper.parentTransformed();\n  }\n\n  public isClickable(): boolean {\n    return this.clickableHelper.isClickable();\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.imageGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Image.attributeHandler.handle(this, name, newValue);\n    this.collideableHelper.handle(name, newValue);\n    this.clickableHelper.handle(name, newValue);\n  }\n\n  connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.imageGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.imageGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLImageGraphicsInterface(this, () => {\n        this.applyBounds();\n        this.collideableHelper.updateCollider(this.imageGraphics?.getCollisionElement());\n      });\n\n    for (const name of Image.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    this.collideableHelper.updateCollider(this.imageGraphics?.getCollisionElement());\n  }\n\n  disconnectedCallback() {\n    this.imageAnimatedAttributeHelper.reset();\n    this.imageGraphics?.dispose();\n    this.imageGraphics = null;\n    super.disconnectedCallback();\n    this.collideableHelper.removeColliders();\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport { AttributeHandler, parseBoolAttribute, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { GraphicsAdapter, InteractionGraphics } from \"../graphics\";\nimport { Vect3 } from \"../math\";\nimport { IMMLScene } from \"../scene\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultInteractionRange = 5;\nconst defaultInteractionInFocus = true;\nconst defaultInteractionLineOfSight = false;\nconst defaultInteractionPriority = 1;\nconst defaultInteractionPrompt = null;\nconst defaultInteractionDebug = false;\n\nexport type MInteractionProps = {\n  range: number;\n  inFocus: boolean;\n  lineOfSight: boolean;\n  priority: number;\n  prompt: string | null;\n  debug: boolean;\n};\n\nexport class Interaction<\n  G extends GraphicsAdapter = GraphicsAdapter,\n> extends TransformableElement<G> {\n  static tagName = \"m-interaction\";\n  private interactionGraphics: InteractionGraphics<G> | null;\n\n  private interactionAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    range: [\n      AnimationType.Number,\n      defaultInteractionRange,\n      (newValue: number) => {\n        this.props.range = newValue;\n        this.applyBounds();\n        this.interactionGraphics?.setRange(newValue, this.props);\n      },\n    ],\n  });\n\n  private static attributeHandler = new AttributeHandler<Interaction<GraphicsAdapter>>({\n    range: (instance, newValue) => {\n      instance.interactionAnimatedAttributeHelper.elementSetAttribute(\n        \"range\",\n        parseFloatAttribute(newValue, defaultInteractionRange),\n      );\n    },\n    \"in-focus\": (instance, newValue) => {\n      instance.props.inFocus = parseBoolAttribute(newValue, defaultInteractionInFocus);\n      instance.interactionGraphics?.setInFocus(instance.props.inFocus, instance.props);\n    },\n    \"line-of-sight\": (instance, newValue) => {\n      instance.props.lineOfSight = parseBoolAttribute(newValue, defaultInteractionLineOfSight);\n      instance.interactionGraphics?.setLineOfSight(instance.props.lineOfSight, instance.props);\n    },\n    priority: (instance, newValue) => {\n      instance.props.priority = parseFloatAttribute(newValue, defaultInteractionPriority);\n      instance.interactionGraphics?.setPriority(instance.props.priority, instance.props);\n    },\n    prompt: (instance, newValue) => {\n      instance.props.prompt = newValue;\n      instance.interactionGraphics?.setPrompt(instance.props.prompt, instance.props);\n    },\n    debug: (instance, newValue) => {\n      instance.props.debug = parseBoolAttribute(newValue, defaultInteractionDebug);\n      instance.interactionGraphics?.setDebug(instance.props.debug, instance.props);\n    },\n  });\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...Interaction.attributeHandler.getAttributes(),\n    ];\n  }\n\n  public props: MInteractionProps = {\n    range: defaultInteractionRange as number,\n    inFocus: defaultInteractionInFocus as boolean,\n    lineOfSight: defaultInteractionLineOfSight as boolean,\n    priority: defaultInteractionPriority as number,\n    prompt: defaultInteractionPrompt as string | null,\n    debug: defaultInteractionDebug as boolean,\n  };\n\n  private registeredScene: IMMLScene<G> | null = null;\n\n  constructor() {\n    super();\n  }\n\n  protected enable() {\n    // TODO\n  }\n\n  protected disable() {\n    // TODO\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n    return OrientedBoundingBox.fromSizeAndMatrixWorld(\n      new Vect3(this.props.range * 2, this.props.range * 2, this.props.range * 2),\n      this.transformableElementGraphics.getWorldMatrix(),\n    );\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.interactionAnimatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.interactionAnimatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  public parentTransformed(): void {\n    this.registeredScene?.updateInteraction?.(this);\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.interactionGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.interactionGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLInteractionGraphicsInterface(this);\n\n    for (const name of Interaction.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    this.registerInteraction();\n  }\n\n  public disconnectedCallback(): void {\n    this.unregisterInteraction();\n    this.interactionAnimatedAttributeHelper.reset();\n    this.interactionGraphics?.dispose();\n    this.interactionGraphics = null;\n    super.disconnectedCallback();\n  }\n\n  public attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    super.attributeChangedCallback(name, oldValue, newValue);\n    if (Interaction.attributeHandler.handle(this, name, newValue)) {\n      if (this.registeredScene !== null) {\n        this.registeredScene.updateInteraction?.(this);\n      }\n    }\n  }\n\n  public trigger() {\n    this.dispatchEvent(new CustomEvent(\"interact\", { detail: {} }));\n  }\n\n  private registerInteraction() {\n    const scene = this.getScene();\n    this.registeredScene = scene;\n    scene.addInteraction?.(this);\n  }\n\n  private unregisterInteraction() {\n    if (this.registeredScene !== null) {\n      this.registeredScene.removeInteraction?.(this);\n      this.registeredScene = null;\n    }\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport {\n  AttributeHandler,\n  parseBoolAttribute,\n  parseColorAttribute,\n  parseEnumAttribute,\n  parseFloatAttribute,\n} from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { ClickableHelper } from \"../clickable/ClickableHelper\";\nimport { CollideableHelper } from \"../collision\";\nimport { MMLColor } from \"../color\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { LabelGraphics } from \"../graphics\";\nimport { Vect3 } from \"../math\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nexport enum MLabelAlignment {\n  left = \"left\",\n  center = \"center\",\n  right = \"right\",\n}\n\nconst defaultLabelColor = { r: 1, g: 1, b: 1 };\nconst defaultFontColor = { r: 0, g: 0, b: 0 };\nconst defaultLabelAlignment = MLabelAlignment.left;\nconst defaultLabelFontSize = 24;\nconst defaultLabelPadding = 8;\nconst defaultLabelWidth = 1;\nconst defaultLabelHeight = 1;\nconst defaultLabelCastShadows = true;\nconst defaultEmissive = 0;\n\nexport type MLabelProps = {\n  content: string;\n  alignment: MLabelAlignment;\n  width: number;\n  height: number;\n  fontSize: number;\n  padding: number;\n  color: MMLColor;\n  fontColor: MMLColor;\n  castShadows: boolean;\n  emissive: number;\n};\n\nexport class Label<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-label\";\n  private labelGraphics: LabelGraphics<G> | null;\n  private collideableHelper = new CollideableHelper(this);\n  private clickableHelper = new ClickableHelper();\n\n  private labelAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    color: [\n      AnimationType.Color,\n      defaultLabelColor,\n      (newValue: MMLColor) => {\n        this.props.color = newValue;\n        this.labelGraphics?.setColor(this.props.color, this.props);\n      },\n    ],\n    \"font-color\": [\n      AnimationType.Color,\n      defaultFontColor,\n      (newValue: MMLColor) => {\n        this.props.fontColor = newValue;\n        this.labelGraphics?.setFontColor(this.props.fontColor, this.props);\n      },\n    ],\n    width: [\n      AnimationType.Number,\n      defaultLabelWidth,\n      (newValue: number) => {\n        this.props.width = newValue;\n        this.labelGraphics?.setWidth(this.props.width, this.props);\n        this.collideableHelper.updateCollider(this.labelGraphics?.getCollisionElement());\n      },\n    ],\n    height: [\n      AnimationType.Number,\n      defaultLabelHeight,\n      (newValue: number) => {\n        this.props.height = newValue;\n        this.labelGraphics?.setHeight(this.props.height, this.props);\n        this.collideableHelper.updateCollider(this.labelGraphics?.getCollisionElement());\n      },\n    ],\n    padding: [\n      AnimationType.Number,\n      defaultLabelPadding,\n      (newValue: number) => {\n        this.props.padding = newValue;\n        this.labelGraphics?.setPadding(this.props.padding, this.props);\n      },\n    ],\n    \"font-size\": [\n      AnimationType.Number,\n      defaultLabelFontSize,\n      (newValue: number) => {\n        this.props.fontSize = newValue;\n        this.labelGraphics?.setFontSize(this.props.fontSize, this.props);\n      },\n    ],\n  });\n\n  public props: MLabelProps = {\n    content: \"\",\n    alignment: defaultLabelAlignment,\n    width: defaultLabelWidth,\n    height: defaultLabelHeight,\n    fontSize: defaultLabelFontSize,\n    padding: defaultLabelPadding,\n    color: defaultLabelColor,\n    fontColor: defaultFontColor,\n    castShadows: defaultLabelCastShadows,\n    emissive: defaultEmissive as number,\n  };\n\n  private static attributeHandler = new AttributeHandler<Label<GraphicsAdapter>>({\n    width: (instance, newValue) => {\n      instance.labelAnimatedAttributeHelper.elementSetAttribute(\n        \"width\",\n        parseFloatAttribute(newValue, defaultLabelWidth),\n      );\n    },\n    height: (instance, newValue) => {\n      instance.labelAnimatedAttributeHelper.elementSetAttribute(\n        \"height\",\n        parseFloatAttribute(newValue, defaultLabelHeight),\n      );\n    },\n    color: (instance, newValue) => {\n      instance.labelAnimatedAttributeHelper.elementSetAttribute(\n        \"color\",\n        parseColorAttribute(newValue, defaultLabelColor),\n      );\n    },\n    \"font-color\": (instance, newValue) => {\n      instance.labelAnimatedAttributeHelper.elementSetAttribute(\n        \"font-color\",\n        parseColorAttribute(newValue, defaultFontColor),\n      );\n    },\n    \"font-size\": (instance, newValue) => {\n      instance.labelAnimatedAttributeHelper.elementSetAttribute(\n        \"font-size\",\n        parseFloatAttribute(newValue, defaultLabelFontSize),\n      );\n    },\n    padding: (instance, newValue) => {\n      instance.labelAnimatedAttributeHelper.elementSetAttribute(\n        \"padding\",\n        parseFloatAttribute(newValue, defaultLabelPadding),\n      );\n    },\n    content: (instance, newValue) => {\n      instance.props.content = newValue || \"\";\n      instance.labelGraphics?.setContent(instance.props.content, instance.props);\n    },\n    alignment: (instance, newValue) => {\n      instance.props.alignment = parseEnumAttribute(\n        newValue,\n        MLabelAlignment,\n        defaultLabelAlignment,\n      );\n      instance.labelGraphics?.setAlignment(instance.props.alignment, instance.props);\n    },\n    \"cast-shadows\": (instance, newValue) => {\n      instance.props.castShadows = parseBoolAttribute(newValue, defaultLabelCastShadows);\n      instance.labelGraphics?.setCastShadows(instance.props.castShadows, instance.props);\n    },\n    emissive: (instance, newValue) => {\n      instance.props.emissive = parseFloatAttribute(newValue, defaultEmissive);\n      instance.labelGraphics?.setEmissive(instance.props.emissive, instance.props);\n    },\n  });\n\n  protected enable() {\n    // no-op\n  }\n\n  protected disable() {\n    // no-op\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...Label.attributeHandler.getAttributes(),\n      ...CollideableHelper.observedAttributes,\n      ...ClickableHelper.observedAttributes,\n    ];\n  }\n\n  constructor() {\n    super();\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n\n    return OrientedBoundingBox.fromSizeAndMatrixWorld(\n      new Vect3(this.props.width, this.props.height, 0),\n      this.transformableElementGraphics.getWorldMatrix(),\n    );\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.labelAnimatedAttributeHelper.addSideEffectChild(child);\n\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.labelAnimatedAttributeHelper.removeSideEffectChild(child);\n\n    super.removeSideEffectChild(child);\n  }\n\n  public parentTransformed(): void {\n    // no-op\n  }\n\n  public isClickable(): boolean {\n    return this.clickableHelper.isClickable();\n  }\n\n  public attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.labelGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Label.attributeHandler.handle(this, name, newValue);\n    this.collideableHelper.handle(name, newValue);\n    this.clickableHelper.handle(name, newValue);\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.labelGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.labelGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLLabelGraphicsInterface(this);\n\n    for (const name of Label.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    this.labelGraphics.allAttributesObserved();\n\n    this.applyBounds();\n    this.collideableHelper.updateCollider(this.labelGraphics?.getCollisionElement());\n  }\n\n  public disconnectedCallback(): void {\n    this.collideableHelper.removeColliders();\n    this.labelAnimatedAttributeHelper.reset();\n    this.labelGraphics?.dispose();\n    this.labelGraphics = null;\n    super.disconnectedCallback();\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport {\n  AttributeHandler,\n  parseBoolAttribute,\n  parseColorAttribute,\n  parseEnumAttribute,\n  parseFloatAttribute,\n} from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { MMLColor } from \"../color\";\nimport { GraphicsAdapter, LightGraphics } from \"../graphics\";\nimport { AnimationType, AttributeAnimation } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nexport enum LightTypes {\n  spotlight = \"spotlight\",\n  point = \"point\",\n}\n\nconst defaultLightColor: MMLColor = { r: 1, g: 1, b: 1 };\nconst defaultLightIntensity = 1;\nconst defaultLightAngle = 45;\nconst defaultLightEnabled = true;\nconst defaultLightDebug = false;\nconst defaultLightDistance = null;\nconst defaultLightCastShadows = true;\nconst defaultLightType = LightTypes.spotlight;\n\nexport type MLightProps = {\n  color: MMLColor;\n  intensity: number;\n  enabled: boolean;\n  angleDeg: number;\n  distance: number | null;\n  castShadows: boolean;\n  debug: boolean;\n  type: LightTypes;\n};\n\nexport class Light<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-light\";\n\n  private lightGraphics: LightGraphics<G> | null;\n\n  private lightAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    color: [\n      AnimationType.Color,\n      defaultLightColor,\n      (newValue: MMLColor) => {\n        this.props.color = newValue;\n        this.lightGraphics?.setColor(newValue, this.props);\n      },\n    ],\n    intensity: [\n      AnimationType.Number,\n      defaultLightIntensity,\n      (newValue: number) => {\n        this.props.intensity = newValue;\n        this.lightGraphics?.setIntensity(newValue, this.props);\n      },\n    ],\n    angle: [\n      AnimationType.Number,\n      defaultLightAngle,\n      (newValue: number) => {\n        this.props.angleDeg = newValue;\n        this.lightGraphics?.setAngle(newValue, this.props);\n      },\n    ],\n    distance: [\n      AnimationType.Number,\n      defaultLightDistance,\n      (newValue: number) => {\n        this.props.distance = newValue;\n        this.lightGraphics?.setDistance(newValue, this.props);\n      },\n    ],\n  });\n\n  public props: MLightProps = {\n    color: defaultLightColor,\n    intensity: defaultLightIntensity,\n    enabled: defaultLightEnabled,\n    angleDeg: defaultLightAngle,\n    distance: defaultLightDistance,\n    castShadows: defaultLightCastShadows,\n    debug: defaultLightDebug,\n    type: defaultLightType as LightTypes,\n  };\n\n  private static attributeHandler = new AttributeHandler<Light<GraphicsAdapter>>({\n    color: (instance, newValue) => {\n      instance.lightAnimatedAttributeHelper.elementSetAttribute(\n        \"color\",\n        parseColorAttribute(newValue, defaultLightColor),\n      );\n    },\n    intensity: (instance, newValue) => {\n      instance.lightAnimatedAttributeHelper.elementSetAttribute(\n        \"intensity\",\n        parseFloatAttribute(newValue, defaultLightIntensity),\n      );\n    },\n    angle: (instance, newValue) => {\n      instance.lightAnimatedAttributeHelper.elementSetAttribute(\n        \"angle\",\n        parseFloatAttribute(newValue, defaultLightAngle),\n      );\n    },\n    distance: (instance, newValue) => {\n      instance.lightAnimatedAttributeHelper.elementSetAttribute(\n        \"distance\",\n        parseFloatAttribute(newValue, defaultLightDistance),\n      );\n    },\n    enabled: (instance, newValue) => {\n      instance.props.enabled = parseBoolAttribute(newValue, defaultLightEnabled);\n      instance.lightGraphics?.setEnabled(instance.props.enabled, instance.props);\n    },\n    \"cast-shadows\": (instance, newValue) => {\n      instance.props.castShadows = parseBoolAttribute(newValue, defaultLightCastShadows);\n      instance.lightGraphics?.setCastShadows(instance.props.castShadows, instance.props);\n    },\n    debug: (instance, newValue) => {\n      instance.props.debug = parseBoolAttribute(newValue, defaultLightDebug);\n      instance.lightGraphics?.setDebug(instance.props.debug, instance.props);\n    },\n    type: (instance, newValue) => {\n      instance.props.type = parseEnumAttribute(newValue, LightTypes, defaultLightType);\n      instance.lightGraphics?.setType(instance.props.type, instance.props);\n    },\n  });\n\n  static get observedAttributes(): Array<string> {\n    return [...TransformableElement.observedAttributes, ...Light.attributeHandler.getAttributes()];\n  }\n\n  constructor() {\n    super();\n  }\n\n  protected enable() {\n    // no-op\n  }\n\n  protected disable() {\n    // no-op\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n    return OrientedBoundingBox.fromMatrixWorld(this.transformableElementGraphics.getWorldMatrix());\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    if (AttributeAnimation.isAttributeAnimation(child)) {\n      const attr = child.getAnimatedAttributeName();\n      if (attr) {\n        this.lightAnimatedAttributeHelper.addAnimation(child, attr);\n      }\n    }\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    if (AttributeAnimation.isAttributeAnimation(child)) {\n      const attr = child.getAnimatedAttributeName();\n      if (attr) {\n        this.lightAnimatedAttributeHelper.removeAnimation(child, attr);\n      }\n    }\n    super.removeSideEffectChild(child);\n  }\n\n  public parentTransformed(): void {\n    // no-op\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.lightGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Light.attributeHandler.handle(this, name, newValue);\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.lightGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.lightGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLLightGraphicsInterface(this);\n\n    for (const name of Light.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n  }\n\n  public disconnectedCallback() {\n    this.lightAnimatedAttributeHelper.reset();\n    this.lightGraphics?.dispose();\n    this.lightGraphics = null;\n    super.disconnectedCallback();\n  }\n}\n", "import { AttributeHandler } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { GraphicsAdapter, LinkGraphics } from \"../graphics\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nexport type MLinkProps = {\n  href: string | null;\n  target: string | null;\n};\n\nexport class Link<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-link\";\n  private linkGraphics: LinkGraphics<G> | null;\n\n  private abortController: AbortController | null = null;\n\n  public props: MLinkProps = {\n    href: null,\n    target: null,\n  };\n\n  private static attributeHandler = new AttributeHandler<Link<GraphicsAdapter>>({\n    href: (instance, newValue) => {\n      instance.props.href = newValue !== null ? newValue : null;\n    },\n    target: (instance, newValue) => {\n      instance.props.target = newValue !== null ? newValue : null;\n    },\n  });\n\n  static get observedAttributes(): Array<string> {\n    return [...TransformableElement.observedAttributes, ...Link.attributeHandler.getAttributes()];\n  }\n\n  /*\n   This is a simple check to ensure that the href is an acceptable URL and is\n   not a \"javascript:alert('foo')\" URL or something other than a navigable URL.\n  */\n  static isAcceptableHref(href: string): boolean {\n    const url = new URL(href, window.location.href);\n    if (url.protocol === \"http:\" || url.protocol === \"https:\") {\n      return true;\n    }\n    return false;\n  }\n\n  constructor() {\n    super();\n\n    this.addEventListener(\"click\", () => {\n      if (this.props.href) {\n        const href = this.props.href;\n        if (!Link.isAcceptableHref(href)) {\n          console.warn(\n            `Refusing to navigate to ${href} as it does not meet the acceptable href criteria.`,\n          );\n          return;\n        }\n\n        if (this.abortController) {\n          this.abortController.abort();\n          this.abortController = null;\n        }\n        this.abortController = new AbortController();\n        this.getScene().link(\n          { href, target: this.props.target ?? undefined, popup: false },\n          this.abortController.signal,\n          () => {\n            this.abortController = null;\n          },\n        );\n      }\n    });\n  }\n\n  public parentTransformed(): void {\n    // no-op\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.transformableElementGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Link.attributeHandler.handle(this, name, newValue);\n  }\n\n  protected disable(): void {\n    // no-op\n  }\n\n  protected enable(): void {\n    // no-op\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    return null;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.linkGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.linkGraphics = graphicsAdapter.getGraphicsAdapterFactory().MMLLinkGraphicsInterface(this);\n\n    for (const name of Link.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n  }\n\n  public disconnectedCallback(): void {\n    this.linkGraphics?.dispose();\n    this.linkGraphics = null;\n    super.disconnectedCallback();\n  }\n}\n", "import { AttributeHandler, parseEnumAttribute, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { GraphicsAdapter, OverlayGraphics } from \"../graphics\";\nimport { consumeEventEventName } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nexport enum OverlayAnchor {\n  \"top-left\" = \"top-left\",\n  \"top-center\" = \"top-center\",\n  \"top-right\" = \"top-right\",\n  \"center-left\" = \"center-left\",\n  \"center\" = \"center\",\n  \"center-right\" = \"center-right\",\n  \"bottom-left\" = \"bottom-left\",\n  \"bottom-center\" = \"bottom-center\",\n  \"bottom-right\" = \"bottom-right\",\n}\n\nexport type MOverlayProps = {\n  href: string | null;\n  target: string | null;\n  anchor: OverlayAnchor;\n  offsetX: number;\n  offsetY: number;\n};\n\nenum OverlayMode {\n  // The overlay element is not yet attached to the DOM\n  PENDING = \"pending\",\n  // The overlay element is from a remote document and the children are applied to a portal element\n  PORTAL = \"portal\",\n  // The overlay element is in a local document and the overlay element is directly styled as the presentational element\n  DIRECT = \"direct\",\n}\n\nexport class Overlay<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-overlay\";\n  private overlayGraphics: OverlayGraphics<G> | null = null;\n  private overlayElement: HTMLElement | null = null;\n\n  private mode: OverlayMode = OverlayMode.PENDING;\n\n  public props: MOverlayProps = {\n    href: null,\n    target: null,\n    anchor: OverlayAnchor[\"top-left\"],\n    offsetX: 0,\n    offsetY: 0,\n  };\n\n  private static attributeHandler = new AttributeHandler<Overlay<GraphicsAdapter>>({\n    href: (instance, newValue) => {\n      instance.props.href = newValue !== null ? newValue : null;\n    },\n    target: (instance, newValue) => {\n      instance.props.target = newValue !== null ? newValue : null;\n    },\n    anchor: (instance, newValue) => {\n      instance.props.anchor = parseEnumAttribute(\n        newValue,\n        OverlayAnchor,\n        OverlayAnchor[\"top-left\"],\n      );\n      instance.updateOverlayElementPosition();\n    },\n    \"offset-x\": (instance, newValue) => {\n      instance.props.offsetX = parseFloatAttribute(newValue, 0);\n      instance.updateOverlayElementPosition();\n    },\n    \"offset-y\": (instance, newValue) => {\n      instance.props.offsetY = parseFloatAttribute(newValue, 0);\n      instance.updateOverlayElementPosition();\n    },\n  });\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...Overlay.attributeHandler.getAttributes(),\n    ];\n  }\n\n  constructor() {\n    super();\n  }\n\n  private updateOverlayElementPosition(): void {\n    if (!this.overlayElement) {\n      return;\n    }\n\n    this.overlayElement.style.position = \"absolute\";\n    this.overlayElement.style.zIndex = \"1000\";\n\n    switch (this.props.anchor) {\n      case OverlayAnchor[\"top-left\"]:\n        this.overlayElement.style.top = `0`;\n        this.overlayElement.style.left = `0`;\n        this.overlayElement.style.right = ``;\n        this.overlayElement.style.bottom = ``;\n        this.overlayElement.style.transformOrigin = \"top left\";\n        this.overlayElement.style.transform = `translateX(calc(${this.props.offsetX}px)) translateY(${this.props.offsetY}px)`;\n        break;\n      case OverlayAnchor[\"top-center\"]:\n        this.overlayElement.style.top = `0`;\n        this.overlayElement.style.left = `50%`;\n        this.overlayElement.style.right = ``;\n        this.overlayElement.style.bottom = ``;\n        this.overlayElement.style.transformOrigin = \"top center\";\n        this.overlayElement.style.transform = `translateX(calc(-50% + ${this.props.offsetX}px)) translateY(${this.props.offsetY}px)`;\n        break;\n      case OverlayAnchor[\"top-right\"]:\n        this.overlayElement.style.top = `0`;\n        this.overlayElement.style.right = `0`;\n        this.overlayElement.style.left = ``;\n        this.overlayElement.style.bottom = ``;\n        this.overlayElement.style.transformOrigin = \"top right\";\n        this.overlayElement.style.transform = `translateX(${this.props.offsetX}px) translateY(${this.props.offsetY}px)`;\n        break;\n      case OverlayAnchor[\"center-left\"]:\n        this.overlayElement.style.top = \"50%\";\n        this.overlayElement.style.left = `0`;\n        this.overlayElement.style.right = ``;\n        this.overlayElement.style.bottom = ``;\n        this.overlayElement.style.transformOrigin = \"center left\";\n        this.overlayElement.style.transform = `translateX(calc(${this.props.offsetX}px)) translateY(calc(-50% + ${this.props.offsetY}px))`;\n        break;\n      case OverlayAnchor[\"center\"]:\n        this.overlayElement.style.top = \"50%\";\n        this.overlayElement.style.left = \"50%\";\n        this.overlayElement.style.right = ``;\n        this.overlayElement.style.bottom = ``;\n        this.overlayElement.style.transformOrigin = \"center\";\n        this.overlayElement.style.transform = `translate(calc(-50% + ${this.props.offsetX}px), calc(-50% + ${this.props.offsetY}px))`;\n        break;\n      case OverlayAnchor[\"center-right\"]:\n        this.overlayElement.style.top = \"50%\";\n        this.overlayElement.style.left = \"100%\";\n        this.overlayElement.style.right = ``;\n        this.overlayElement.style.bottom = ``;\n        this.overlayElement.style.transformOrigin = \"center right\";\n        this.overlayElement.style.transform = `translateX(calc(-100% + ${this.props.offsetX}px)) translateY(calc(-50% + ${this.props.offsetY}px))`;\n        break;\n      case OverlayAnchor[\"bottom-left\"]:\n        this.overlayElement.style.top = \"100%\";\n        this.overlayElement.style.left = `${this.props.offsetX}px`;\n        this.overlayElement.style.right = ``;\n        this.overlayElement.style.bottom = ``;\n        this.overlayElement.style.transformOrigin = \"bottom left\";\n        this.overlayElement.style.transform = `translateX(${this.props.offsetX}px) translateY(calc(-100% + ${this.props.offsetY}px))`;\n        break;\n      case OverlayAnchor[\"bottom-center\"]:\n        this.overlayElement.style.top = \"100%\";\n        this.overlayElement.style.left = \"50%\";\n        this.overlayElement.style.right = ``;\n        this.overlayElement.style.bottom = ``;\n        this.overlayElement.style.transformOrigin = \"bottom center\";\n        this.overlayElement.style.transform = `translateX(calc(-50% + ${this.props.offsetX}px)) translateY(calc(-100% + ${this.props.offsetY}px))`;\n        break;\n      case OverlayAnchor[\"bottom-right\"]:\n        this.overlayElement.style.top = \"100%\";\n        this.overlayElement.style.left = \"100%\";\n        this.overlayElement.style.right = ``;\n        this.overlayElement.style.bottom = ``;\n        this.overlayElement.style.transformOrigin = \"bottom right\";\n        this.overlayElement.style.transform = `translateX(calc(-100% + ${this.props.offsetX}px)) translateY(calc(-100% + ${this.props.offsetY}px))`;\n        break;\n      default:\n        throw new Error(`Unknown anchor: ${this.props.anchor}`);\n    }\n  }\n\n  public getPortalElement(): HTMLElement {\n    if (this.mode === OverlayMode.DIRECT) {\n      return this;\n    } else if (this.mode === OverlayMode.PORTAL) {\n      if (!this.overlayElement) {\n        throw new Error(\"Overlay element is not set\");\n      }\n      return this.overlayElement;\n    }\n    throw new Error(\"Unknown overlay mode\");\n  }\n\n  public parentTransformed(): void {\n    // no-op\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.transformableElementGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Overlay.attributeHandler.handle(this, name, newValue);\n  }\n\n  protected disable(): void {\n    // no-op\n  }\n\n  protected enable(): void {\n    // no-op\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    return null;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.overlayGraphics) {\n      return;\n    }\n\n    const remoteDocument = this.getInitiatedRemoteDocument();\n    if (remoteDocument) {\n      // This document is running remotely so the elements can be moved without affecting script logic\n      // Move the existing children of this element to the overlay element\n      this.mode = OverlayMode.PORTAL;\n\n      this.overlayElement = document.createElement(\"div\");\n      this.overlayElement.addEventListener(\"click\", (event) => {\n        event.stopImmediatePropagation();\n        event.preventDefault();\n\n        const remoteDocument = this.getInitiatedRemoteDocument();\n        if (remoteDocument) {\n          remoteDocument.dispatchEvent(\n            new CustomEvent(consumeEventEventName, {\n              bubbles: false,\n              detail: { element: event.target, originalEvent: event },\n            }),\n          );\n        }\n      });\n\n      const parentElement = this.getScene().getOverlayElement?.();\n      if (parentElement) {\n        parentElement.appendChild(this.overlayElement);\n      } else {\n        console.warn(\n          \"An m-overlay element was found but getOverlayElement was not provided by the scene\",\n        );\n      }\n      for (const child of Array.from(this.childNodes)) {\n        this.overlayElement.appendChild(child);\n      }\n    } else {\n      // This document is running locally so the elements can't be moved, but the overlay element can be used as the presentational element\n      this.mode = OverlayMode.DIRECT;\n      this.overlayElement = this;\n    }\n\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.overlayGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLOverlayGraphicsInterface(this);\n\n    for (const name of Overlay.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    this.updateOverlayElementPosition();\n  }\n\n  public disconnectedCallback(): void {\n    this.overlayGraphics?.dispose();\n    this.overlayGraphics = null;\n    this.overlayElement?.remove();\n    super.disconnectedCallback();\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport {\n  AttributeHandler,\n  parseBoolAttribute,\n  parseColorAttribute,\n  parseFloatAttribute,\n} from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { ClickableHelper } from \"../clickable/ClickableHelper\";\nimport { CollideableHelper } from \"../collision\";\nimport { MMLColor } from \"../color\";\nimport { GraphicsAdapter, PlaneGraphics } from \"../graphics\";\nimport { Vect3 } from \"../math\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultPlaneColor: MMLColor = { r: 1, g: 1, b: 1 };\nconst defaultPlaneWidth = 1;\nconst defaultPlaneHeight = 1;\nconst defaultPlaneOpacity = 1;\nconst defaultPlaneCastShadows = true;\n\nexport type MPlaneProps = {\n  width: number;\n  height: number;\n  color: MMLColor;\n  opacity: number;\n  castShadows: boolean;\n};\n\nexport class Plane<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-plane\";\n  private planeGraphics: PlaneGraphics<G> | null;\n\n  public props: MPlaneProps = {\n    width: defaultPlaneWidth,\n    height: defaultPlaneHeight,\n    color: defaultPlaneColor,\n    opacity: defaultPlaneOpacity,\n    castShadows: defaultPlaneCastShadows,\n  };\n\n  private planeAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    color: [\n      AnimationType.Color,\n      defaultPlaneColor,\n      (newValue: MMLColor) => {\n        this.props.color = newValue;\n        this.planeGraphics?.setColor(newValue, this.props);\n      },\n    ],\n    width: [\n      AnimationType.Number,\n      defaultPlaneWidth,\n      (newValue: number) => {\n        this.props.width = newValue;\n        this.planeGraphics?.setWidth(newValue, this.props);\n        this.applyBounds();\n        this.collideableHelper.updateCollider(this.planeGraphics?.getCollisionElement());\n      },\n    ],\n    height: [\n      AnimationType.Number,\n      defaultPlaneHeight,\n      (newValue: number) => {\n        this.props.height = newValue;\n        this.planeGraphics?.setHeight(newValue, this.props);\n        this.applyBounds();\n        this.collideableHelper.updateCollider(this.planeGraphics?.getCollisionElement());\n      },\n    ],\n    opacity: [\n      AnimationType.Number,\n      defaultPlaneOpacity,\n      (newValue: number) => {\n        this.props.opacity = newValue;\n        this.planeGraphics?.setOpacity(newValue, this.props);\n      },\n    ],\n  });\n  private collideableHelper = new CollideableHelper(this);\n  private clickableHelper = new ClickableHelper();\n\n  private static attributeHandler = new AttributeHandler<Plane<GraphicsAdapter>>({\n    width: (instance, newValue) => {\n      instance.planeAnimatedAttributeHelper.elementSetAttribute(\n        \"width\",\n        parseFloatAttribute(newValue, defaultPlaneWidth),\n      );\n    },\n    height: (instance, newValue) => {\n      instance.planeAnimatedAttributeHelper.elementSetAttribute(\n        \"height\",\n        parseFloatAttribute(newValue, defaultPlaneHeight),\n      );\n    },\n    color: (instance, newValue) => {\n      instance.planeAnimatedAttributeHelper.elementSetAttribute(\n        \"color\",\n        parseColorAttribute(newValue, defaultPlaneColor),\n      );\n    },\n    opacity: (instance, newValue) => {\n      instance.planeAnimatedAttributeHelper.elementSetAttribute(\n        \"opacity\",\n        parseFloatAttribute(newValue, defaultPlaneOpacity),\n      );\n    },\n    \"cast-shadows\": (instance, newValue) => {\n      instance.props.castShadows = parseBoolAttribute(newValue, defaultPlaneCastShadows);\n      instance.planeGraphics?.setCastShadows(instance.props.castShadows, instance.props);\n    },\n  });\n\n  protected enable() {\n    this.collideableHelper.enable();\n  }\n\n  protected disable() {\n    this.collideableHelper.disable();\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n    return OrientedBoundingBox.fromSizeAndMatrixWorld(\n      new Vect3(this.props.width, this.props.height, 0),\n      this.transformableElementGraphics.getWorldMatrix(),\n    );\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...Plane.attributeHandler.getAttributes(),\n      ...CollideableHelper.observedAttributes,\n      ...ClickableHelper.observedAttributes,\n    ];\n  }\n\n  constructor() {\n    super();\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.planeAnimatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.planeAnimatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  public parentTransformed(): void {\n    this.collideableHelper.parentTransformed();\n  }\n\n  public isClickable(): boolean {\n    return this.clickableHelper.isClickable();\n  }\n\n  public attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.planeGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Plane.attributeHandler.handle(this, name, newValue);\n    this.collideableHelper.handle(name, newValue);\n    this.clickableHelper.handle(name, newValue);\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.planeGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.planeGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLPlaneGraphicsInterface(this);\n\n    for (const name of Plane.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    this.applyBounds();\n    this.collideableHelper.updateCollider(this.planeGraphics?.getCollisionElement());\n  }\n\n  public disconnectedCallback(): void {\n    this.collideableHelper.removeColliders();\n    this.planeAnimatedAttributeHelper.reset();\n    this.planeGraphics?.dispose();\n    this.planeGraphics = null;\n    super.disconnectedCallback();\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport { AttributeHandler, parseBoolAttribute, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { GraphicsAdapter, PositionProbeGraphics } from \"../graphics\";\nimport { Vect3 } from \"../math\";\nimport { getRelativePositionAndRotationRelativeToObject } from \"../position\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultPositionProbeRange = 10;\nconst defaultPositionProbeInterval = 1000;\nconst defaultPositionProbeMinimumInterval = 100;\nconst defaultPositionProbeDebug = false;\nconst positionProbeEnterEventName = \"positionenter\";\nconst positionProbePositionMoveEventName = \"positionmove\";\nconst positionProbeLeaveEventName = \"positionleave\";\n\nexport type MPositionProbeProps = {\n  intervalMs: number;\n  debug: boolean;\n  range: number;\n};\n\nexport class PositionProbe<\n  G extends GraphicsAdapter = GraphicsAdapter,\n> extends TransformableElement<G> {\n  static tagName = \"m-position-probe\";\n  private positionProbeGraphics: PositionProbeGraphics<G> | null;\n\n  private positionProbeAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    range: [\n      AnimationType.Number,\n      defaultPositionProbeRange,\n      (newValue: number) => {\n        this.props.range = newValue;\n        this.positionProbeGraphics?.setRange(newValue, this.props);\n        this.applyBounds();\n      },\n    ],\n  });\n\n  public props: MPositionProbeProps = {\n    intervalMs: defaultPositionProbeInterval,\n    debug: defaultPositionProbeDebug,\n    range: defaultPositionProbeRange,\n  };\n\n  private static attributeHandler = new AttributeHandler<PositionProbe<GraphicsAdapter>>({\n    range: (instance, newValue) => {\n      instance.positionProbeAnimatedAttributeHelper.elementSetAttribute(\n        \"range\",\n        parseFloatAttribute(newValue, defaultPositionProbeRange),\n      );\n    },\n    interval: (instance, newValue) => {\n      instance.props.intervalMs = Math.max(\n        defaultPositionProbeMinimumInterval,\n        parseFloatAttribute(newValue, defaultPositionProbeInterval),\n      );\n      instance.startEmitting();\n    },\n    debug: (instance, newValue) => {\n      instance.props.debug = parseBoolAttribute(newValue, defaultPositionProbeDebug);\n      instance.positionProbeGraphics?.setDebug(instance.props.debug, instance.props);\n    },\n  });\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...PositionProbe.attributeHandler.getAttributes(),\n    ];\n  }\n\n  private timer: NodeJS.Timeout | null = null;\n\n  private currentlyInRange = false;\n\n  constructor() {\n    super();\n  }\n\n  protected enable() {\n    // no-op\n  }\n\n  protected disable() {\n    // no-op\n  }\n\n  public parentTransformed() {\n    // no-op\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n    return OrientedBoundingBox.fromSizeAndMatrixWorld(\n      new Vect3(this.props.range * 2, this.props.range * 2, this.props.range * 2),\n      this.transformableElementGraphics.getWorldMatrix(),\n    );\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.positionProbeAnimatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.positionProbeAnimatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.positionProbeGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    PositionProbe.attributeHandler.handle(this, name, newValue);\n  }\n\n  private emitPosition() {\n    const userPositionAndRotation = this.getUserPositionAndRotation();\n    const elementRelative = getRelativePositionAndRotationRelativeToObject(\n      userPositionAndRotation,\n      this,\n    );\n\n    // Check if the position is within range\n    const distance = new Vect3().copy(elementRelative.position).length();\n\n    let withinBounds = true;\n    this.getAppliedBounds().forEach((bounds) => {\n      if (!bounds.containsPoint(userPositionAndRotation.position)) {\n        withinBounds = false;\n      }\n    });\n\n    if (withinBounds && distance <= this.props.range) {\n      const elementRelativePositionAndRotation = {\n        position: elementRelative.position,\n        rotation: {\n          x: elementRelative.rotation.x,\n          y: elementRelative.rotation.y,\n          z: elementRelative.rotation.z,\n        },\n      };\n\n      let documentRoot: MElement<G> | null = null;\n      const remoteDocument = this.getInitiatedRemoteDocument();\n      if (remoteDocument) {\n        documentRoot = remoteDocument;\n      }\n      const documentRelative =\n        documentRoot !== null\n          ? getRelativePositionAndRotationRelativeToObject(userPositionAndRotation, documentRoot)\n          : userPositionAndRotation;\n\n      const documentRelativePositionAndRotation = {\n        position: documentRelative.position,\n        rotation: {\n          x: documentRelative.rotation.x,\n          y: documentRelative.rotation.y,\n          z: documentRelative.rotation.z,\n        },\n      };\n      if (!this.currentlyInRange) {\n        this.currentlyInRange = true;\n        this.dispatchEvent(\n          new CustomEvent(positionProbeEnterEventName, {\n            detail: {\n              elementRelative: elementRelativePositionAndRotation,\n              documentRelative: documentRelativePositionAndRotation,\n            },\n          }),\n        );\n      } else {\n        this.dispatchEvent(\n          new CustomEvent(positionProbePositionMoveEventName, {\n            detail: {\n              elementRelative: elementRelativePositionAndRotation,\n              documentRelative: documentRelativePositionAndRotation,\n            },\n          }),\n        );\n      }\n    } else {\n      if (this.currentlyInRange) {\n        this.currentlyInRange = false;\n        this.dispatchEvent(new CustomEvent(positionProbeLeaveEventName, {}));\n      }\n    }\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.positionProbeGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.positionProbeGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLPositionProbeGraphicsInterface(this);\n\n    for (const name of PositionProbe.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    this.applyBounds();\n    this.startEmitting();\n  }\n\n  public disconnectedCallback(): void {\n    if (this.timer) {\n      clearInterval(this.timer);\n    }\n    this.positionProbeAnimatedAttributeHelper.reset();\n    this.positionProbeGraphics?.dispose();\n    this.positionProbeGraphics = null;\n    super.disconnectedCallback();\n  }\n\n  private startEmitting() {\n    if (this.timer) {\n      clearInterval(this.timer);\n    }\n\n    this.timer = setInterval(() => {\n      this.emitPosition();\n    }, this.props.intervalMs);\n  }\n}\n", "import { AttributeHandler } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { GraphicsAdapter, PromptGraphics } from \"../graphics\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nexport type MPromptProps = {\n  message: string | undefined;\n  placeholder: string | undefined;\n  prefill: string | undefined;\n};\n\nexport class Prompt<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-prompt\";\n  private promptGraphics: PromptGraphics<G> | null;\n\n  private abortController: AbortController | null = null;\n\n  public props: MPromptProps = {\n    message: undefined as string | undefined,\n    placeholder: undefined as string | undefined,\n    prefill: undefined as string | undefined,\n  };\n\n  private static attributeHandler = new AttributeHandler<Prompt<GraphicsAdapter>>({\n    message: (instance, newValue) => {\n      instance.props.message = newValue !== null ? newValue : undefined;\n      instance.promptGraphics?.setMessage(instance.props.message, instance.props);\n    },\n    placeholder: (instance, newValue) => {\n      instance.props.placeholder = newValue !== null ? newValue : undefined;\n      instance.promptGraphics?.setPlaceholder(instance.props.placeholder, instance.props);\n    },\n    prefill: (instance, newValue) => {\n      instance.props.prefill = newValue !== null ? newValue : undefined;\n      instance.promptGraphics?.setPrefill(instance.props.prefill, instance.props);\n    },\n  });\n\n  protected enable() {\n    // no-op\n  }\n\n  protected disable() {\n    // no-op\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [...TransformableElement.observedAttributes, ...Prompt.attributeHandler.getAttributes()];\n  }\n\n  constructor() {\n    super();\n\n    this.addEventListener(\"click\", () => {\n      this.trigger();\n    });\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    return null;\n  }\n\n  public parentTransformed(): void {\n    // no-op\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.promptGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Prompt.attributeHandler.handle(this, name, newValue);\n  }\n\n  private trigger(): void {\n    if (this.abortController) {\n      this.abortController.abort();\n      this.abortController = null;\n    }\n    this.abortController = new AbortController();\n    this.getScene().prompt(this.props, this.abortController.signal, (result) => {\n      if (!this.isConnected) {\n        return;\n      }\n      if (result !== null) {\n        this.dispatchEvent(\n          new CustomEvent(\"prompt\", { bubbles: false, detail: { value: result } }),\n        );\n      }\n    });\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.promptGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.promptGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLPromptGraphicsInterface(this);\n\n    for (const name of Prompt.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n  }\n\n  public disconnectedCallback(): void {\n    this.promptGraphics?.dispose();\n    this.promptGraphics = null;\n    super.disconnectedCallback();\n  }\n}\n", "/**\n * The MMLDocumentTimeManager class is responsible for tracking the current document time and notifying listeners of\n * either shifts in time (e.g. media synced to time) and also ticking (e.g. for elements that are animating) when the\n * document time changes.\n */\nexport class MMLDocumentTimeManager {\n  private relativeDocumentStartTime = 0;\n  private overridenDocumentTime: number | null = null;\n  private documentTimeListeners = new Set<(time: number) => void>();\n  private documentTimeTickListeners = new Set<(time: number) => void>();\n\n  constructor() {}\n\n  public tick() {\n    const documentTime = this.getDocumentTime();\n    for (const cb of this.documentTimeTickListeners) {\n      cb(documentTime);\n    }\n  }\n\n  public getDocumentTime(): number {\n    if (this.overridenDocumentTime !== null) {\n      return this.overridenDocumentTime;\n    }\n    return (document.timeline.currentTime as number) - this.relativeDocumentStartTime;\n  }\n\n  public getWindowTime(): number {\n    if (this.overridenDocumentTime !== null) {\n      return this.overridenDocumentTime;\n    }\n    return document.timeline.currentTime as number;\n  }\n\n  public addDocumentTimeListenerCallback(cb: (time: number) => void) {\n    this.documentTimeListeners.add(cb);\n  }\n\n  public removeDocumentTimeListenerCallback(cb: (time: number) => void) {\n    this.documentTimeListeners.delete(cb);\n  }\n\n  public addDocumentTimeTickListenerCallback(cb: (time: number) => void) {\n    this.documentTimeTickListeners.add(cb);\n  }\n\n  public removeDocumentTimeTickListenerCallback(cb: (time: number) => void) {\n    this.documentTimeTickListeners.delete(cb);\n  }\n\n  public setDocumentTime(documentTime: number) {\n    if (this.overridenDocumentTime !== null) {\n      return;\n    }\n    this.relativeDocumentStartTime = (document.timeline.currentTime as number) - documentTime;\n\n    for (const cb of this.documentTimeListeners) {\n      cb(documentTime);\n    }\n  }\n\n  // This method is used for testing to allow overriding the document time\n  public overrideDocumentTime(documentTime: number) {\n    this.overridenDocumentTime = documentTime;\n\n    for (const cb of this.documentTimeListeners) {\n      cb(documentTime);\n    }\n  }\n}\n", "import { OrientedBoundingBox } from \"../bounding-box\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { RemoteDocumentGraphics } from \"../graphics\";\nimport { IMMLScene } from \"../scene\";\nimport { MMLDocumentTimeManager } from \"../time\";\nimport { consumeEventEventName } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nexport class RemoteDocument<\n  G extends GraphicsAdapter = GraphicsAdapter,\n> extends TransformableElement<G> {\n  static tagName = \"m-remote-document\";\n\n  private scene: IMMLScene<G> | null = null;\n  private documentAddress: string | null = null;\n  private documentTimeManager: MMLDocumentTimeManager;\n  private animationFrameCallback: number | null = null;\n  private remoteDocumentGraphics: RemoteDocumentGraphics<G> | null;\n\n  constructor() {\n    super();\n    this.documentTimeManager = new MMLDocumentTimeManager();\n\n    this.addEventListener(consumeEventEventName, (wrappedEvent: CustomEvent) => {\n      wrappedEvent.stopPropagation();\n    });\n  }\n\n  public showError(showError: boolean) {\n    this.remoteDocumentGraphics?.showError(showError);\n  }\n\n  protected enable() {\n    // no-op\n  }\n\n  protected disable() {\n    // no-op\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    return null;\n  }\n\n  public parentTransformed(): void {\n    // no-op\n  }\n\n  public isClickable(): boolean {\n    return false;\n  }\n\n  public getDocumentTimeManager(): MMLDocumentTimeManager {\n    return this.documentTimeManager;\n  }\n\n  public connectedCallback(): void {\n    this.style.display = \"none\";\n    if (!this.isConnected) {\n      return;\n    }\n\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.remoteDocumentGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.remoteDocumentGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .RemoteDocumentGraphicsInterface(this);\n    this.animationFrameCallback = window.requestAnimationFrame(() => {\n      this.tick();\n    });\n  }\n\n  public disconnectedCallback() {\n    if (this.animationFrameCallback) {\n      window.cancelAnimationFrame(this.animationFrameCallback);\n      this.animationFrameCallback = null;\n    }\n    this.remoteDocumentGraphics?.dispose();\n    this.remoteDocumentGraphics = null;\n    super.disconnectedCallback();\n  }\n\n  public dispatchEvent(event: CustomEvent): boolean {\n    return HTMLElement.prototype.dispatchEvent.call(this, event);\n  }\n\n  public init(mmlScene: IMMLScene<G>, documentAddress: string) {\n    if (this.scene) {\n      throw new Error(\"Scene already set\");\n    }\n    this.scene = mmlScene;\n    this.documentAddress = documentAddress;\n    this.connectedCallback();\n  }\n\n  public getDocumentAddress(): string | null {\n    return this.documentAddress;\n  }\n\n  public getMMLScene(): IMMLScene<G> | null {\n    if (!this.scene) {\n      return null;\n    }\n    return this.scene;\n  }\n\n  public tick() {\n    this.documentTimeManager.tick();\n    this.animationFrameCallback = window.requestAnimationFrame(() => {\n      this.tick();\n    });\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport {\n  AttributeHandler,\n  parseBoolAttribute,\n  parseColorAttribute,\n  parseFloatAttribute,\n} from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { ClickableHelper } from \"../clickable/ClickableHelper\";\nimport { CollideableHelper } from \"../collision\";\nimport { MMLColor } from \"../color\";\nimport { GraphicsAdapter, SphereGraphics } from \"../graphics\";\nimport { Vect3 } from \"../math\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultSphereColor: MMLColor = { r: 1, g: 1, b: 1 };\nconst defaultSphereRadius = 0.5;\nconst defaultSphereOpacity = 1;\nconst defaultSphereCastShadows = true;\n\nexport type MSphereProps = {\n  radius: number;\n  color: MMLColor;\n  opacity: number;\n  castShadows: boolean;\n};\n\nexport class Sphere<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-sphere\";\n\n  public props: MSphereProps = {\n    radius: defaultSphereRadius,\n    color: defaultSphereColor,\n    opacity: defaultSphereOpacity,\n    castShadows: defaultSphereCastShadows,\n  };\n\n  private sphereAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    color: [\n      AnimationType.Color,\n      defaultSphereColor,\n      (newValue: MMLColor) => {\n        this.props.color = newValue;\n        this.sphereGraphics?.setColor(newValue, this.props);\n      },\n    ],\n    radius: [\n      AnimationType.Number,\n      defaultSphereRadius,\n      (newValue: number) => {\n        this.props.radius = newValue;\n        this.sphereGraphics?.setRadius(newValue, this.props);\n        this.applyBounds();\n        this.collideableHelper.updateCollider(this.sphereGraphics?.getCollisionElement());\n      },\n    ],\n    opacity: [\n      AnimationType.Number,\n      defaultSphereOpacity,\n      (newValue: number) => {\n        this.props.opacity = newValue;\n        this.sphereGraphics?.setOpacity(newValue, this.props);\n      },\n    ],\n  });\n  private collideableHelper = new CollideableHelper(this);\n  private clickableHelper = new ClickableHelper();\n\n  private static attributeHandler = new AttributeHandler<Sphere<GraphicsAdapter>>({\n    radius: (instance, newValue) => {\n      instance.sphereAnimatedAttributeHelper.elementSetAttribute(\n        \"radius\",\n        parseFloatAttribute(newValue, defaultSphereRadius),\n      );\n    },\n    color: (instance, newValue) => {\n      instance.sphereAnimatedAttributeHelper.elementSetAttribute(\n        \"color\",\n        parseColorAttribute(newValue, defaultSphereColor),\n      );\n    },\n    opacity: (instance, newValue) => {\n      instance.sphereAnimatedAttributeHelper.elementSetAttribute(\n        \"opacity\",\n        parseFloatAttribute(newValue, defaultSphereOpacity),\n      );\n    },\n    \"cast-shadows\": (instance, newValue) => {\n      instance.props.castShadows = parseBoolAttribute(newValue, defaultSphereCastShadows);\n      instance.sphereGraphics?.setCastShadows(instance.props.castShadows, instance.props);\n    },\n  });\n  private sphereGraphics: SphereGraphics<G> | null;\n\n  protected enable() {\n    this.collideableHelper.enable();\n  }\n\n  protected disable() {\n    this.collideableHelper.disable();\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.transformableElementGraphics) {\n      return null;\n    }\n    return OrientedBoundingBox.fromSizeAndMatrixWorld(\n      new Vect3(this.props.radius * 2, this.props.radius * 2, this.props.radius * 2),\n      this.transformableElementGraphics.getWorldMatrix(),\n    );\n  }\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...Sphere.attributeHandler.getAttributes(),\n      ...CollideableHelper.observedAttributes,\n      ...ClickableHelper.observedAttributes,\n    ];\n  }\n\n  constructor() {\n    super();\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.sphereAnimatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.sphereAnimatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  public parentTransformed(): void {\n    this.collideableHelper.parentTransformed();\n  }\n\n  public isClickable(): boolean {\n    return this.clickableHelper.isClickable();\n  }\n\n  public attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.sphereGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Sphere.attributeHandler.handle(this, name, newValue);\n    this.collideableHelper.handle(name, newValue);\n    this.clickableHelper.handle(name, newValue);\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.sphereGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.sphereGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLSphereGraphicsInterface(this);\n\n    for (const name of Sphere.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    this.applyBounds();\n    this.collideableHelper.updateCollider(this.sphereGraphics.getCollisionElement());\n  }\n\n  public disconnectedCallback(): void {\n    this.collideableHelper.removeColliders();\n    this.sphereAnimatedAttributeHelper.reset();\n    this.sphereGraphics?.dispose();\n    this.sphereGraphics = null;\n    super.disconnectedCallback();\n  }\n}\n", "import { AnimatedAttributeHelper } from \"../attribute-animation\";\nimport { AttributeHandler, parseBoolAttribute, parseFloatAttribute } from \"../attributes\";\nimport { OrientedBoundingBox } from \"../bounding-box\";\nimport { ClickableHelper } from \"../clickable/ClickableHelper\";\nimport { CollideableHelper } from \"../collision\";\nimport { GraphicsAdapter, VideoGraphics } from \"../graphics\";\nimport { Vect3 } from \"../math\";\nimport { AnimationType } from \"./AttributeAnimation\";\nimport { MElement } from \"./MElement\";\nimport { TransformableElement } from \"./TransformableElement\";\n\nconst defaultVideoWidth = null;\nconst defaultVideoHeight = null;\nconst defaultVideoVolume = 1;\nconst defaultVideoLoop = true;\nconst defaultVideoEnabled = true;\nconst defaultVideoStartTime = 0;\nconst defaultVideoPauseTime = null;\nconst defaultVideoSrc = null;\nconst defaultVideoCastShadows = true;\nconst defaultVideoEmissive = 0;\n\nexport type MVideoProps = {\n  width: number | null;\n  height: number | null;\n  enabled: boolean;\n  loop: boolean;\n  startTime: number;\n  pauseTime: number | null;\n  src: string | null;\n  volume: number;\n  castShadows: boolean;\n  emissive: number;\n};\n\nexport class Video<G extends GraphicsAdapter = GraphicsAdapter> extends TransformableElement<G> {\n  static tagName = \"m-video\";\n\n  private videoAnimatedAttributeHelper = new AnimatedAttributeHelper(this, {\n    width: [\n      AnimationType.Number,\n      defaultVideoWidth,\n      (newValue: number) => {\n        this.props.width = newValue;\n        this.videoGraphics?.setWidth(newValue, this.props);\n      },\n    ],\n    height: [\n      AnimationType.Number,\n      defaultVideoHeight,\n      (newValue: number) => {\n        this.props.height = newValue;\n        this.videoGraphics?.setHeight(newValue, this.props);\n      },\n    ],\n    emissive: [\n      AnimationType.Number,\n      defaultVideoEmissive,\n      (newValue: number) => {\n        this.props.emissive = newValue;\n        this.videoGraphics?.setEmissive(newValue, this.props);\n      },\n    ],\n  });\n\n  static get observedAttributes(): Array<string> {\n    return [\n      ...TransformableElement.observedAttributes,\n      ...Video.attributeHandler.getAttributes(),\n      ...CollideableHelper.observedAttributes,\n      ...ClickableHelper.observedAttributes,\n    ];\n  }\n\n  private documentTimeListener: { remove: () => void };\n  private collideableHelper = new CollideableHelper(this);\n  private clickableHelper = new ClickableHelper();\n\n  // Parsed attribute values\n  public props: MVideoProps = {\n    startTime: defaultVideoStartTime,\n    pauseTime: defaultVideoPauseTime,\n    src: defaultVideoSrc,\n    loop: defaultVideoLoop,\n    enabled: defaultVideoEnabled,\n    volume: defaultVideoVolume,\n    width: defaultVideoWidth,\n    height: defaultVideoHeight,\n    castShadows: defaultVideoCastShadows,\n    emissive: defaultVideoEmissive,\n  };\n\n  private static attributeHandler = new AttributeHandler<Video<GraphicsAdapter>>({\n    width: (instance, newValue) => {\n      instance.videoAnimatedAttributeHelper.elementSetAttribute(\n        \"width\",\n        parseFloatAttribute(newValue, defaultVideoWidth),\n      );\n    },\n    height: (instance, newValue) => {\n      instance.videoAnimatedAttributeHelper.elementSetAttribute(\n        \"height\",\n        parseFloatAttribute(newValue, defaultVideoHeight),\n      );\n    },\n    enabled: (instance, newValue) => {\n      instance.props.enabled = parseBoolAttribute(newValue, defaultVideoEnabled);\n      instance.videoGraphics?.setEnabled(instance.props.enabled, instance.props);\n    },\n    loop: (instance, newValue) => {\n      instance.props.loop = parseBoolAttribute(newValue, defaultVideoLoop);\n      instance.videoGraphics?.setLoop(instance.props.loop, instance.props);\n    },\n    \"start-time\": (instance, newValue) => {\n      instance.props.startTime = parseFloatAttribute(newValue, defaultVideoStartTime);\n      instance.videoGraphics?.setStartTime(instance.props.startTime, instance.props);\n    },\n    \"pause-time\": (instance, newValue) => {\n      instance.props.pauseTime = parseFloatAttribute(newValue, defaultVideoPauseTime);\n      instance.videoGraphics?.setPauseTime(instance.props.pauseTime, instance.props);\n    },\n    src: (instance, newValue) => {\n      instance.props.src = newValue;\n      instance.videoGraphics?.setSrc(newValue, instance.props);\n    },\n    volume: (instance, newValue) => {\n      instance.props.volume = parseFloatAttribute(newValue, defaultVideoVolume);\n      instance.videoGraphics?.setVolume(instance.props.volume, instance.props);\n    },\n    \"cast-shadows\": (instance, newValue) => {\n      instance.props.castShadows = parseBoolAttribute(newValue, defaultVideoCastShadows);\n      instance.videoGraphics?.setCastShadows(instance.props.castShadows, instance.props);\n    },\n    emissive: (instance, newValue) => {\n      instance.videoAnimatedAttributeHelper.elementSetAttribute(\n        \"emissive\",\n        parseFloatAttribute(newValue, defaultVideoEmissive),\n      );\n    },\n  });\n  private videoGraphics: VideoGraphics<G> | null;\n\n  protected enable() {\n    this.videoGraphics?.syncVideoTime();\n  }\n\n  protected disable() {\n    this.videoGraphics?.syncVideoTime();\n  }\n\n  constructor() {\n    super();\n  }\n\n  public getContentBounds(): OrientedBoundingBox | null {\n    if (!this.videoGraphics || !this.transformableElementGraphics) {\n      return null;\n    }\n    const { width, height } = this.videoGraphics.getWidthAndHeight() || { width: 0, height: 0 };\n    return OrientedBoundingBox.fromSizeAndMatrixWorld(\n      new Vect3(width, height, 0),\n      this.transformableElementGraphics.getWorldMatrix(),\n    );\n  }\n\n  public addSideEffectChild(child: MElement<G>): void {\n    this.videoAnimatedAttributeHelper.addSideEffectChild(child);\n    super.addSideEffectChild(child);\n  }\n\n  public removeSideEffectChild(child: MElement<G>): void {\n    this.videoAnimatedAttributeHelper.removeSideEffectChild(child);\n    super.removeSideEffectChild(child);\n  }\n\n  public parentTransformed(): void {\n    this.collideableHelper.parentTransformed();\n  }\n\n  public isClickable(): boolean {\n    return this.clickableHelper.isClickable();\n  }\n\n  attributeChangedCallback(name: string, oldValue: string | null, newValue: string) {\n    if (!this.videoGraphics) {\n      return;\n    }\n    super.attributeChangedCallback(name, oldValue, newValue);\n    Video.attributeHandler.handle(this, name, newValue);\n    this.collideableHelper.handle(name, newValue);\n    this.clickableHelper.handle(name, newValue);\n  }\n\n  private documentTimeChanged() {\n    this.videoGraphics?.syncVideoTime();\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (!this.getScene().hasGraphicsAdapter() || this.videoGraphics) {\n      return;\n    }\n    const graphicsAdapter = this.getScene().getGraphicsAdapter();\n\n    this.videoGraphics = graphicsAdapter\n      .getGraphicsAdapterFactory()\n      .MMLVideoGraphicsInterface(this, () => {\n        this.applyBounds();\n        this.collideableHelper.updateCollider(this.videoGraphics?.getCollisionElement());\n      });\n\n    this.documentTimeListener = this.addDocumentTimeListener(() => {\n      this.documentTimeChanged();\n    });\n\n    for (const name of Video.observedAttributes) {\n      const value = this.getAttribute(name);\n      if (value !== null) {\n        this.attributeChangedCallback(name, null, value);\n      }\n    }\n\n    this.collideableHelper.updateCollider(this.videoGraphics?.getCollisionElement());\n  }\n\n  disconnectedCallback() {\n    this.videoAnimatedAttributeHelper.reset();\n    this.videoGraphics?.dispose();\n    this.videoGraphics = null;\n    this.documentTimeListener.remove();\n    this.collideableHelper.removeColliders();\n    super.disconnectedCallback();\n  }\n}\n", "import { Animation } from \"./Animation\";\nimport { AttributeAnimation } from \"./AttributeAnimation\";\nimport { AttributeLerp } from \"./AttributeLerp\";\nimport { Audio } from \"./Audio\";\nimport { Character } from \"./Character\";\nimport { ChatProbe } from \"./ChatProbe\";\nimport { Cube } from \"./Cube\";\nimport { Cylinder } from \"./Cylinder\";\nimport { Frame } from \"./Frame\";\nimport { Group } from \"./Group\";\nimport { Image } from \"./Image\";\nimport { Interaction } from \"./Interaction\";\nimport { Label } from \"./Label\";\nimport { Light } from \"./Light\";\nimport { Link } from \"./Link\";\nimport { MElement } from \"./MElement\";\nimport { Model } from \"./Model\";\nimport { Overlay } from \"./Overlay\";\nimport { Plane } from \"./Plane\";\nimport { PositionProbe } from \"./PositionProbe\";\nimport { Prompt } from \"./Prompt\";\nimport { RemoteDocument } from \"./RemoteDocument\";\nimport { Sphere } from \"./Sphere\";\nimport { Video } from \"./Video\";\n\nexport function registerCustomElementsToWindow(targetWindow: Window) {\n  // TODO - copy the classes to generate window-specific classes rather than overwriting the superclass on each call\n  const targetHTMLElement = (targetWindow as any)[\"HTMLElement\"] as typeof HTMLElement;\n  MElement.overwriteSuperclass(targetHTMLElement);\n  targetWindow.customElements.define(RemoteDocument.tagName, RemoteDocument);\n  targetWindow.customElements.define(Light.tagName, Light);\n  targetWindow.customElements.define(Model.tagName, Model);\n  targetWindow.customElements.define(Character.tagName, Character);\n  targetWindow.customElements.define(Cube.tagName, Cube);\n  targetWindow.customElements.define(Frame.tagName, Frame);\n  targetWindow.customElements.define(Cylinder.tagName, Cylinder);\n  targetWindow.customElements.define(Plane.tagName, Plane);\n  targetWindow.customElements.define(Label.tagName, Label);\n  targetWindow.customElements.define(Group.tagName, Group);\n  targetWindow.customElements.define(Prompt.tagName, Prompt);\n  targetWindow.customElements.define(Link.tagName, Link);\n  targetWindow.customElements.define(Overlay.tagName, Overlay);\n  targetWindow.customElements.define(Sphere.tagName, Sphere);\n  targetWindow.customElements.define(Image.tagName, Image);\n  targetWindow.customElements.define(Video.tagName, Video);\n  targetWindow.customElements.define(Audio.tagName, Audio);\n  targetWindow.customElements.define(PositionProbe.tagName, PositionProbe);\n  targetWindow.customElements.define(ChatProbe.tagName, ChatProbe);\n  targetWindow.customElements.define(Interaction.tagName, Interaction);\n  targetWindow.customElements.define(Animation.tagName, Animation);\n  targetWindow.customElements.define(AttributeAnimation.tagName, AttributeAnimation);\n  targetWindow.customElements.define(AttributeLerp.tagName, AttributeLerp);\n}\n", "type ListenerFunc = (...args: any[]) => void;\n\ntype EventSpecificationTuple = [EventTarget, string, ListenerFunc, AddEventListenerOptions?];\n\n/**\n * The EventHandlerCollection is a utility class that allows you to add event listeners to a collection of targets and\n * then clear them all at once.\n *\n * This avoids the caller needing to keep references to the functions applied to the event listeners.\n */\nexport class EventHandlerCollection {\n  private eventsByTarget: Map<EventTarget, Map<string, Set<ListenerFunc>>> = new Map();\n\n  public add(\n    target: EventTarget,\n    key: string,\n    listener: ListenerFunc,\n    options?: AddEventListenerOptions,\n  ): this {\n    target.addEventListener(key, listener, options);\n\n    let existingTarget = this.eventsByTarget.get(target);\n    if (existingTarget === undefined) {\n      existingTarget = new Map();\n      this.eventsByTarget.set(target, existingTarget);\n    }\n    let existingKey = existingTarget.get(key);\n    if (existingKey === undefined) {\n      existingKey = new Set();\n      existingTarget.set(key, existingKey);\n    }\n    existingKey.add(listener);\n\n    return this;\n  }\n\n  public clear() {\n    this.eventsByTarget.forEach((keyMap, target) => {\n      keyMap.forEach((listenerSet, key) => {\n        listenerSet.forEach((listenerFunc) => {\n          target.removeEventListener(key, listenerFunc);\n        });\n      });\n    });\n    this.eventsByTarget.clear();\n  }\n\n  static create(initial?: Array<EventSpecificationTuple>): EventHandlerCollection {\n    const instance = new EventHandlerCollection();\n    if (initial !== undefined) {\n      initial.forEach(([target, key, listenerFunc, options]) => {\n        instance.add(target, key, listenerFunc, options);\n      });\n    }\n    return instance;\n  }\n}\n", "import { Interaction } from \"../elements\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { InteractionListener } from \"../scene\";\nimport { EventHandlerCollection } from \"../utils/EventHandlerCollection\";\n\ntype InteractionState = {\n  interaction: Interaction<GraphicsAdapter>;\n  distance?: number;\n  button?: HTMLButtonElement;\n};\n\nfunction createInteractionsHolder(\n  onPrev: () => void,\n  onNext: () => void,\n  onClose: () => void,\n): {\n  holderElement: HTMLDivElement;\n  listElement: HTMLDivElement;\n  prevButton: HTMLButtonElement;\n  statusHolder: HTMLDivElement;\n  nextButton: HTMLButtonElement;\n} {\n  const holderElement = document.createElement(\"div\");\n  holderElement.setAttribute(\"data-test-id\", \"interactions-holder\");\n  holderElement.style.zIndex = \"100\";\n  holderElement.style.position = \"absolute\";\n  holderElement.style.backgroundColor = \"white\";\n  holderElement.style.padding = \"10px\";\n  holderElement.style.display = \"none\";\n  holderElement.style.border = \"1px solid #AAA\";\n  holderElement.style.fontFamily = \"sans-serif\";\n  holderElement.style.top = \"50%\";\n  holderElement.style.left = \"50%\";\n  holderElement.style.transform = \"translate(-50%, -50%)\";\n\n  const closeButtonHolder = document.createElement(\"div\");\n  closeButtonHolder.style.display = \"flex\";\n  closeButtonHolder.style.justifyContent = \"flex-end\";\n  holderElement.appendChild(closeButtonHolder);\n\n  const title = document.createElement(\"h3\");\n  title.style.textAlign = \"center\";\n  title.textContent = \"Interactions\";\n  holderElement.appendChild(title);\n\n  const closeButton = document.createElement(\"button\");\n  closeButton.textContent = \"Close\";\n  closeButton.style.cursor = \"pointer\";\n  closeButton.addEventListener(\"click\", () => {\n    onClose();\n  });\n  closeButtonHolder.appendChild(closeButton);\n\n  const listElement = document.createElement(\"div\");\n  listElement.setAttribute(\"data-test-id\", \"interactions-list\");\n  holderElement.appendChild(listElement);\n\n  const buttonHolder = document.createElement(\"div\");\n  buttonHolder.style.display = \"flex\";\n  buttonHolder.style.justifyContent = \"space-between\";\n  holderElement.appendChild(buttonHolder);\n\n  const prevButton = document.createElement(\"button\");\n  prevButton.textContent = \"Prev\";\n  prevButton.style.cursor = \"pointer\";\n  prevButton.addEventListener(\"click\", onPrev);\n  buttonHolder.appendChild(prevButton);\n\n  const statusHolder = document.createElement(\"div\");\n  statusHolder.style.display = \"flex\";\n  statusHolder.style.justifyContent = \"center\";\n  statusHolder.style.padding = \"5px\";\n  buttonHolder.appendChild(statusHolder);\n\n  const nextButton = document.createElement(\"button\");\n  nextButton.textContent = \"Next\";\n  nextButton.style.cursor = \"pointer\";\n  nextButton.addEventListener(\"click\", onNext);\n  buttonHolder.appendChild(nextButton);\n\n  return { holderElement, listElement, prevButton, statusHolder, nextButton };\n}\n\nfunction createInteractionPrompt() {\n  const interactionPrompt = document.createElement(\"div\");\n  interactionPrompt.setAttribute(\"data-test-id\", \"interactions-prompt\");\n  interactionPrompt.style.zIndex = \"101\";\n  interactionPrompt.style.position = \"absolute\";\n  interactionPrompt.style.top = \"10px\";\n  interactionPrompt.style.left = \"10px\";\n  interactionPrompt.style.display = \"none\";\n  interactionPrompt.style.padding = \"12px 10px\";\n  interactionPrompt.style.fontFamily = \"Helvetica\";\n  interactionPrompt.style.color = \"white\";\n  interactionPrompt.style.backgroundColor = \"#222222b2\";\n  interactionPrompt.innerHTML = \"Press E to interact\";\n  return interactionPrompt;\n}\n\nexport class InteractionManager {\n  private static pageLimit = 3;\n  private pageOffset = 0;\n\n  private eventCollection = new EventHandlerCollection();\n\n  private interactionListElement: HTMLDivElement;\n  private interactionHolderElement: HTMLDivElement;\n  private prevButton: HTMLButtonElement;\n  private statusHolder: HTMLDivElement;\n  private nextButton: HTMLButtonElement;\n  private interactionPromptElement: HTMLDivElement;\n\n  private possibleActions = new Map<Interaction<GraphicsAdapter>, InteractionState>();\n  private visibleActions = new Set<InteractionState>();\n  private tickInterval: NodeJS.Timeout | null = null;\n  private sortedActions: InteractionState[] = [];\n\n  private static createButtonText(interaction: Interaction<GraphicsAdapter>) {\n    return `${interaction.props.prompt ?? \"Interact\"}`;\n  }\n\n  private constructor(\n    private container: HTMLElement,\n    private interactionShouldShowDistance: (\n      interaction: Interaction<GraphicsAdapter>,\n    ) => number | null,\n  ) {\n    this.container = container;\n    const { holderElement, listElement, prevButton, statusHolder, nextButton } =\n      createInteractionsHolder(\n        () => {\n          this.pageOffset--;\n          this.displayInteractions();\n        },\n        () => {\n          this.pageOffset++;\n          this.displayInteractions();\n        },\n        () => {\n          this.hideHolder();\n        },\n      );\n    this.prevButton = prevButton;\n    this.statusHolder = statusHolder;\n    this.nextButton = nextButton;\n    this.interactionListElement = listElement;\n    this.interactionHolderElement = holderElement;\n    this.container.appendChild(this.interactionHolderElement);\n\n    this.interactionPromptElement = createInteractionPrompt();\n    this.container.appendChild(this.interactionPromptElement);\n\n    this.eventCollection.add(document, \"keydown\", (e: KeyboardEvent) => {\n      // if the e key is pressed, show the UI\n      if (e.code === \"KeyE\") {\n        if (this.interactionHolderElement.style.display === \"block\") {\n          this.hideHolder();\n          return;\n        }\n        if (this.visibleActions.size > 0) {\n          this.showHolder();\n        }\n      } else if (e.code === \"Escape\") {\n        this.hideHolder();\n      }\n    });\n  }\n\n  private getInteractionListener(): InteractionListener<GraphicsAdapter> {\n    return {\n      addInteraction: (interaction: Interaction<GraphicsAdapter>) => {\n        this.possibleActions.set(interaction, {\n          interaction,\n        });\n      },\n      removeInteraction: (interaction: Interaction<GraphicsAdapter>) => {\n        const interactionState = this.possibleActions.get(interaction);\n        if (!interactionState) {\n          console.warn(\"Interaction not found\", interaction);\n          return;\n        }\n\n        if (interactionState.button) {\n          interactionState.button.remove();\n        }\n        this.possibleActions.delete(interaction);\n        if (this.visibleActions.has(interactionState)) {\n          this.visibleActions.delete(interactionState);\n          if (this.visibleActions.size === 0) {\n            this.hidePrompt();\n          }\n        }\n      },\n      updateInteraction: (interaction: Interaction<GraphicsAdapter>) => {\n        const interactionState = this.possibleActions.get(interaction);\n        if (!interactionState) {\n          console.warn(\"Interaction not found\", interaction);\n          return;\n        }\n        if (interactionState.button) {\n          interactionState.button.textContent = InteractionManager.createButtonText(interaction);\n        }\n      },\n    };\n  }\n\n  static init(\n    container: HTMLElement,\n    interactionShouldShowDistance: (interaction: Interaction<GraphicsAdapter>) => number | null,\n  ): {\n    interactionManager: InteractionManager;\n    interactionListener: InteractionListener<GraphicsAdapter>;\n  } {\n    const interactionManager = new InteractionManager(container, interactionShouldShowDistance);\n    interactionManager.startTick();\n    return { interactionManager, interactionListener: interactionManager.getInteractionListener() };\n  }\n\n  public dispose() {\n    if (this.tickInterval) {\n      clearInterval(this.tickInterval);\n    }\n    this.eventCollection.clear();\n    this.interactionListElement.remove();\n    this.interactionHolderElement.remove();\n    this.interactionPromptElement.remove();\n  }\n\n  private startTick() {\n    this.tickInterval = setInterval(() => {\n      this.possibleActions.forEach((interactionState, interaction) => {\n        const showDistance = this.interactionShouldShowDistance(interaction);\n        if (showDistance !== null) {\n          interactionState.distance = showDistance;\n          this.visibleActions.add(interactionState);\n        } else {\n          this.visibleActions.delete(interactionState);\n        }\n      });\n\n      if (this.visibleActions.size === 0) {\n        this.hidePrompt();\n        this.hideHolder();\n        return;\n      } else {\n        this.showPrompt();\n      }\n\n      this.sortedActions = Array.from(this.visibleActions).sort(\n        (a: InteractionState, b: InteractionState) => {\n          // sort by priority first\n          const priorityDiff = a.interaction.props.priority - b.interaction.props.priority;\n          if (priorityDiff !== 0) {\n            return priorityDiff;\n          }\n\n          // Otherwise sort by distance if available\n          if (a.distance && b.distance) {\n            const distanceDiff = a.distance - b.distance;\n            if (Math.abs(distanceDiff) > 0.1) {\n              return distanceDiff;\n            }\n          }\n          return 0;\n        },\n      );\n\n      this.displayInteractions();\n    }, 1000);\n  }\n\n  private displayInteractions() {\n    this.interactionListElement.innerHTML = \"\";\n    const maximumPageOffset = Math.floor(\n      (this.sortedActions.length - 1) / InteractionManager.pageLimit,\n    );\n    if (this.pageOffset > maximumPageOffset) {\n      this.pageOffset = maximumPageOffset;\n    }\n    if (this.pageOffset < 0) {\n      this.pageOffset = 0;\n    }\n    const startIndex = this.pageOffset * InteractionManager.pageLimit;\n\n    const pagedItems = this.sortedActions.slice(\n      startIndex,\n      startIndex + InteractionManager.pageLimit,\n    );\n\n    if (this.pageOffset > 0) {\n      this.prevButton.removeAttribute(\"disabled\");\n    } else {\n      this.prevButton.setAttribute(\"disabled\", \"true\");\n    }\n\n    if (this.pageOffset < maximumPageOffset) {\n      this.nextButton.removeAttribute(\"disabled\");\n    } else {\n      this.nextButton.setAttribute(\"disabled\", \"true\");\n    }\n\n    this.statusHolder.textContent = `Page ${this.pageOffset + 1} of ${maximumPageOffset + 1}`;\n\n    pagedItems.forEach((interactionState) => {\n      if (!interactionState.button) {\n        const interactionText = InteractionManager.createButtonText(interactionState.interaction);\n        const button = document.createElement(\"button\");\n        button.style.display = \"block\";\n        button.style.marginBottom = \"5px\";\n        button.style.cursor = \"pointer\";\n        button.style.textOverflow = \"ellipsis\";\n        button.style.overflow = \"hidden\";\n        button.style.whiteSpace = \"nowrap\";\n        button.style.maxWidth = \"200px\";\n        button.setAttribute(\"data-test-id\", `interaction-${interactionText}`);\n        button.textContent = interactionText;\n        button.addEventListener(\"click\", () => {\n          interactionState.interaction.trigger();\n          this.hideHolder();\n        });\n        interactionState.button = button;\n      }\n      this.interactionListElement.appendChild(interactionState.button);\n    });\n  }\n\n  private hideHolder() {\n    this.interactionHolderElement.style.display = \"none\";\n  }\n\n  private showHolder() {\n    this.interactionHolderElement.style.display = \"block\";\n  }\n\n  private hidePrompt() {\n    this.interactionPromptElement.style.display = \"none\";\n  }\n\n  private showPrompt() {\n    this.interactionPromptElement.style.display = \"block\";\n  }\n}\n", "export class Modal {\n  public element: HTMLDivElement;\n  public titleElement: HTMLDivElement;\n  public contentsElement: HTMLDivElement;\n\n  constructor() {\n    this.element = document.createElement(\"div\");\n    this.element.style.display = \"block\";\n    this.element.style.border = \"1px solid #AAA\";\n    this.element.style.fontFamily = \"sans-serif\";\n    this.element.style.color = \"black\";\n\n    this.element.style.boxShadow = \"0px 4px 4px rgba(0, 0, 0, 0.1)\";\n    this.element.style.backdropFilter = \"blur(4px)\";\n    this.element.style.borderRadius = \"4px\";\n\n    this.titleElement = document.createElement(\"div\");\n    this.titleElement.style.background = \"rgba(255, 255, 255, 0.8)\";\n    this.titleElement.style.padding = \"8px\";\n    this.titleElement.style.fontWeight = \"bold\";\n    this.titleElement.style.borderBottom = \"1px solid #AAA\";\n\n    this.contentsElement = document.createElement(\"div\");\n    this.contentsElement.style.background = \"rgba(255, 255, 255, 0.6)\";\n    this.contentsElement.style.padding = \"8px\";\n    this.element.append(this.titleElement, this.contentsElement);\n\n    this.element.addEventListener(\"keydown\", (e: KeyboardEvent) => {\n      e.stopPropagation();\n    });\n  }\n\n  dispose() {\n    this.element.remove();\n  }\n}\n", "import { Modal } from \"./Modal\";\n\nexport class ConfirmModal extends Modal {\n  private confirmContentsElement: HTMLDivElement;\n  private messageElement: HTMLDivElement;\n  private buttonsHolder: HTMLDivElement;\n  private cancelButton: HTMLButtonElement;\n  private okButton: HTMLButtonElement;\n\n  constructor(title: string, message: string, callback: (result: boolean) => void) {\n    super();\n\n    this.titleElement.textContent = title;\n\n    this.confirmContentsElement = document.createElement(\"div\");\n    this.messageElement = document.createElement(\"div\");\n    this.messageElement.textContent = message;\n    this.messageElement.style.marginBottom = \"8px\";\n    this.confirmContentsElement.appendChild(this.messageElement);\n    this.contentsElement.appendChild(this.confirmContentsElement);\n\n    this.buttonsHolder = document.createElement(\"div\");\n    this.buttonsHolder.style.display = \"flex\";\n    this.buttonsHolder.style.justifyContent = \"space-between\";\n    this.buttonsHolder.style.marginTop = \"8px\";\n\n    this.cancelButton = document.createElement(\"button\");\n    this.cancelButton.setAttribute(\"data-test-id\", \"confirm-modal-cancel-button\");\n    this.cancelButton.style.cursor = \"pointer\";\n    this.cancelButton.textContent = \"Cancel\";\n    this.cancelButton.addEventListener(\"click\", () => {\n      callback(false);\n      this.dispose();\n    });\n    this.buttonsHolder.appendChild(this.cancelButton);\n\n    this.okButton = document.createElement(\"button\");\n    this.okButton.setAttribute(\"data-test-id\", \"confirm-modal-ok-button\");\n    this.okButton.style.cursor = \"pointer\";\n    this.okButton.textContent = \"OK\";\n    this.okButton.addEventListener(\"click\", () => {\n      callback(true);\n      this.dispose();\n    });\n    this.buttonsHolder.appendChild(this.okButton);\n    this.contentsElement.appendChild(this.buttonsHolder);\n  }\n}\n", "import { PromptProps } from \"../scene\";\nimport { EventHandlerCollection } from \"../utils/EventHandlerCollection\";\nimport { Modal } from \"./Modal\";\n\nexport class PromptModal extends Modal {\n  private promptContentsElement: HTMLDivElement;\n  private promptMessageElement: HTMLDivElement;\n  private promptInputElement: HTMLInputElement;\n  private buttonsHolder: HTMLDivElement;\n  private cancelButton: HTMLButtonElement;\n  private okButton: HTMLButtonElement;\n  private callback: (result: string | null) => void;\n  private eventHandlerCollection = new EventHandlerCollection();\n\n  constructor(promptProps: PromptProps, callback: (result: string | null) => void) {\n    super();\n\n    this.callback = callback;\n\n    this.titleElement.textContent = \"Prompt\";\n\n    this.promptContentsElement = document.createElement(\"div\");\n    this.promptMessageElement = document.createElement(\"div\");\n    this.promptMessageElement.textContent = promptProps.message || \"Enter a value\";\n    this.promptMessageElement.style.marginBottom = \"8px\";\n    this.promptContentsElement.appendChild(this.promptMessageElement);\n\n    this.promptInputElement = document.createElement(\"input\");\n    this.promptInputElement.type = \"text\";\n    this.promptInputElement.style.width = \"80vw\";\n    this.promptInputElement.style.maxWidth = \"300px\";\n    this.promptInputElement.setAttribute(\"data-test-id\", \"prompt-input\");\n    this.promptInputElement.setAttribute(\"placeholder\", promptProps.placeholder || \"\");\n    this.promptInputElement.setAttribute(\"value\", promptProps.prefill || \"\");\n    this.promptInputElement.addEventListener(\"change\", () => {\n      this.checkValue();\n    });\n    this.promptInputElement.addEventListener(\"keyup\", (event) => {\n      if (event.key === \"Enter\") {\n        if (this.promptInputElement.value.length > 0) {\n          this.dispose();\n          this.callback(this.promptInputElement.value);\n        }\n      }\n      this.checkValue();\n    });\n    this.eventHandlerCollection.add(document, \"keydown\", (e: KeyboardEvent) => {\n      if (e.code === \"Escape\") {\n        this.dispose();\n        this.callback(null);\n      }\n      this.checkValue();\n    });\n    this.promptContentsElement.appendChild(this.promptInputElement);\n    this.contentsElement.appendChild(this.promptContentsElement);\n\n    this.buttonsHolder = document.createElement(\"div\");\n    this.buttonsHolder.style.display = \"flex\";\n    this.buttonsHolder.style.justifyContent = \"space-between\";\n    this.buttonsHolder.style.marginTop = \"8px\";\n\n    this.cancelButton = document.createElement(\"button\");\n    this.cancelButton.setAttribute(\"data-test-id\", \"prompt-cancel-button\");\n    this.cancelButton.style.cursor = \"pointer\";\n    this.cancelButton.textContent = \"Cancel\";\n    this.cancelButton.addEventListener(\"click\", () => {\n      this.dispose();\n      this.callback(null);\n    });\n    this.buttonsHolder.appendChild(this.cancelButton);\n\n    this.okButton = document.createElement(\"button\");\n    this.okButton.setAttribute(\"data-test-id\", \"prompt-ok-button\");\n    this.okButton.style.cursor = \"pointer\";\n    this.okButton.textContent = \"OK\";\n    this.okButton.addEventListener(\"click\", () => {\n      this.dispose();\n      this.callback(this.promptInputElement.value);\n    });\n    this.buttonsHolder.appendChild(this.okButton);\n    this.contentsElement.appendChild(this.buttonsHolder);\n  }\n\n  public focus() {\n    this.promptInputElement.focus();\n    this.promptInputElement.setSelectionRange(\n      this.promptInputElement.value.length,\n      this.promptInputElement.value.length,\n    );\n    this.checkValue();\n  }\n\n  dispose() {\n    this.eventHandlerCollection.clear();\n    super.dispose();\n  }\n\n  private checkValue() {\n    if (this.promptInputElement.value.length > 0) {\n      this.okButton.disabled = false;\n    } else {\n      this.okButton.disabled = true;\n    }\n  }\n}\n", "import { LinkProps, PromptProps } from \"../scene\";\nimport { ConfirmModal } from \"./ConfirmModal\";\nimport { Modal } from \"./Modal\";\nimport { PromptModal } from \"./PromptModal\";\n\ntype PromptState = {\n  prompt?: PromptModal;\n  promptProps: PromptProps;\n  resolve: (result: string | null) => void;\n};\n\ntype LinkState = {\n  href: string;\n  target?: string;\n  popup: boolean;\n  windowCallback: (openedWindow: Window | null) => void;\n};\n\nexport class PromptManager {\n  private promptHolderElement: HTMLDivElement;\n\n  private queue = new Array<PromptState | LinkState>();\n  private currentPrompt: PromptState | LinkState | null = null;\n  private currentModal: Modal | null = null;\n\n  private constructor(private container: HTMLElement) {\n    const holderElement = document.createElement(\"div\");\n    holderElement.setAttribute(\"data-test-id\", \"prompt-holder\");\n    holderElement.style.zIndex = \"100\";\n    holderElement.style.position = \"absolute\";\n    holderElement.style.top = \"50%\";\n    holderElement.style.left = \"50%\";\n    holderElement.style.transform = \"translate(-50%, -50%)\";\n    this.promptHolderElement = holderElement;\n    this.container.appendChild(this.promptHolderElement);\n  }\n\n  static init(container: HTMLElement): PromptManager {\n    return new PromptManager(container);\n  }\n\n  public dispose() {\n    this.promptHolderElement.remove();\n  }\n\n  private showPrompt(promptState: PromptState | LinkState) {\n    this.currentPrompt = promptState;\n    if (\"href\" in promptState) {\n      const confirmModal = new ConfirmModal(\n        \"Confirm Navigation\",\n        `Open ${promptState.href}?`,\n        (result: boolean) => {\n          this.currentPrompt = null;\n          this.currentModal = null;\n          if (result) {\n            let features;\n            if (promptState.popup) {\n              const popupWidth = 500;\n              const popupHeight = 500;\n\n              const screenLeft =\n                window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n              const screenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n              const windowWidth = window.innerWidth\n                ? window.innerWidth\n                : document.documentElement.clientWidth\n                  ? document.documentElement.clientWidth\n                  : screen.width;\n              const windowHeight = window.innerHeight\n                ? window.innerHeight\n                : document.documentElement.clientHeight\n                  ? document.documentElement.clientHeight\n                  : screen.height;\n\n              const left = (windowWidth - popupWidth) / 2 + screenLeft;\n              const top = (windowHeight - popupHeight) / 2 + screenTop;\n              features = `toolbar=no,menubar=no,width=${popupWidth},height=${popupHeight},left=${left},top=${top}`;\n            }\n\n            const openedWindow = window.open(\n              promptState.href,\n              promptState.target ?? \"_blank\",\n              features,\n            );\n            promptState.windowCallback(openedWindow);\n          }\n          this.showNextPromptIfAny();\n        },\n      );\n      this.currentModal = confirmModal;\n      this.promptHolderElement.appendChild(confirmModal.element);\n    } else {\n      const promptModal = new PromptModal(promptState.promptProps, (result: string | null) => {\n        this.currentPrompt = null;\n        this.currentModal = null;\n        promptState.resolve(result);\n        this.showNextPromptIfAny();\n      });\n      this.currentModal = promptModal;\n      this.promptHolderElement.appendChild(promptModal.element);\n      promptModal.focus();\n    }\n  }\n\n  public prompt(\n    promptProps: PromptProps,\n    abortSignal: AbortSignal,\n    callback: (message: string | null) => void,\n  ) {\n    abortSignal.addEventListener(\"abort\", () => {\n      if (this.currentPrompt === promptState) {\n        // The current prompt is the one we are aborting\n        this.currentPrompt = null;\n        this.currentModal?.dispose();\n        this.showNextPromptIfAny();\n      } else {\n        // Remove the link from the queue\n        this.queue = this.queue.filter((item) => item !== promptState);\n      }\n    });\n    const promptState: PromptState = {\n      promptProps,\n      resolve: callback,\n    };\n    if (this.currentPrompt !== null) {\n      this.queue.push(promptState);\n      return;\n    }\n    this.showPrompt(promptState);\n  }\n\n  public link(\n    linkProps: LinkProps,\n    abortSignal: AbortSignal,\n    windowCallback: (openedWindow: Window | null) => void,\n  ) {\n    abortSignal.addEventListener(\"abort\", () => {\n      if (this.currentPrompt === linkState) {\n        // The current prompt is the one we are aborting\n        this.currentPrompt = null;\n        this.currentModal?.dispose();\n        this.currentModal = null;\n        this.showNextPromptIfAny();\n      } else {\n        // Remove the link from the queue\n        this.queue = this.queue.filter((item) => item !== linkState);\n      }\n    });\n    const linkState: LinkState = {\n      href: linkProps.href,\n      target: linkProps.target,\n      popup: linkProps.popup ?? false,\n      windowCallback,\n    };\n    if (this.currentPrompt !== null) {\n      this.queue.push(linkState);\n      return;\n    }\n    this.showPrompt(linkState);\n  }\n\n  private showNextPromptIfAny() {\n    const nextPrompt = this.queue.shift();\n    if (nextPrompt !== undefined) {\n      this.showPrompt(nextPrompt);\n    }\n  }\n}\n", "import { DebugHelper } from \"../debug-helper\";\nimport {\n  Animation,\n  Audio,\n  ChatProbe,\n  Cube,\n  Cylinder,\n  Frame,\n  Image,\n  Interaction,\n  Label,\n  Light,\n  Link,\n  MElement,\n  Model,\n  Overlay,\n  Plane,\n  PositionProbe,\n  Prompt,\n  RemoteDocument,\n  Sphere,\n  TransformableElement,\n  Video,\n} from \"../elements\";\nimport {\n  AnimationGraphics,\n  AudioGraphics,\n  ChatProbeGraphics,\n  CubeGraphics,\n  CylinderGraphics,\n  DebugHelperGraphics,\n  FrameGraphics,\n  GraphicsAdapter,\n  ImageGraphics,\n  InteractionGraphics,\n  LabelGraphics,\n  LightGraphics,\n  LinkGraphics,\n  MElementGraphics,\n  ModelGraphics,\n  OverlayGraphics,\n  PlaneGraphics,\n  PositionProbeGraphics,\n  PromptGraphics,\n  RemoteDocumentGraphics,\n  SphereGraphics,\n  StandaloneGraphicsAdapter,\n  TransformableGraphics,\n  VideoGraphics,\n} from \"../graphics\";\nimport { InteractionManager } from \"../interaction-ui\";\nimport { LoadingProgressManager } from \"../loading\";\nimport { PromptManager } from \"../prompt-ui\";\n\nexport interface MMLGraphicsInterface<C extends GraphicsAdapter> {\n  MMLAnimationGraphicsInterface: (element: Animation<C>) => AnimationGraphics<C>;\n  MMLDebugHelperGraphicsInterface<G extends C>(debugHelper: DebugHelper<G>): DebugHelperGraphics<G>;\n  RemoteDocumentGraphicsInterface: (element: RemoteDocument<C>) => RemoteDocumentGraphics<C>;\n  MElementGraphicsInterface: (element: MElement<C>) => MElementGraphics<C>;\n  MMLTransformableGraphicsInterface: (element: TransformableElement<C>) => TransformableGraphics<C>;\n  MMLImageGraphicsInterface: (\n    element: Image<C>,\n    updateMeshCallback: () => void,\n  ) => ImageGraphics<C>;\n  MMLVideoGraphicsInterface: (\n    element: Video<C>,\n    updateMeshCallback: () => void,\n  ) => VideoGraphics<C>;\n  MMLAudioGraphicsInterface: (element: Audio<C>) => AudioGraphics<C>;\n  MMLCubeGraphicsInterface: (element: Cube<C>) => CubeGraphics<C>;\n  MMLLabelGraphicsInterface: (element: Label<C>) => LabelGraphics<C>;\n  MMLLinkGraphicsInterface: (element: Link<C>) => LinkGraphics<C>;\n  MMLOverlayGraphicsInterface: (element: Overlay<C>) => OverlayGraphics<C>;\n  MMLPlaneGraphicsInterface: (element: Plane<C>) => PlaneGraphics<C>;\n  MMLPromptGraphicsInterface: (element: Prompt<C>) => PromptGraphics<C>;\n  MMLInteractionGraphicsInterface: (element: Interaction<C>) => InteractionGraphics<C>;\n  MMLChatProbeGraphicsInterface: (element: ChatProbe<C>) => ChatProbeGraphics<C>;\n  MMLPositionProbeGraphicsInterface: (element: PositionProbe<C>) => PositionProbeGraphics<C>;\n  MMLSphereGraphicsInterface: (element: Sphere<C>) => SphereGraphics<C>;\n  MMLCylinderGraphicsInterface: (element: Cylinder<C>) => CylinderGraphics<C>;\n  MMLLightGraphicsInterface: (element: Light<C>) => LightGraphics<C>;\n  MMLFrameGraphicsInterface: (element: Frame<C>) => FrameGraphics<C>;\n  MMLModelGraphicsInterface: (\n    element: Model<C>,\n    updateMeshCallback: () => void,\n  ) => ModelGraphics<C>;\n}\n\nexport type PositionAndRotation = {\n  position: { x: number; y: number; z: number };\n  // rotation in degrees\n  rotation: { x: number; y: number; z: number };\n};\n\nexport type InteractionListener<G extends GraphicsAdapter = GraphicsAdapter> = {\n  addInteraction(interaction: Interaction<G>): void;\n  updateInteraction(interaction: Interaction<G>): void;\n  removeInteraction(interaction: Interaction<G>): void;\n};\n\nexport type ChatProbeListener<G extends GraphicsAdapter = GraphicsAdapter> = {\n  addChatProbe(chatProbe: ChatProbe<G>): void;\n  updateChatProbe(chatProbe: ChatProbe<G>): void;\n  removeChatProbe(chatProbe: ChatProbe<G>): void;\n};\n\nexport type PromptProps = {\n  message?: string;\n  placeholder?: string;\n  prefill?: string;\n};\n\nexport type LinkProps = {\n  href: string;\n  target?: string;\n  popup?: boolean;\n};\n\n/**\n * The IMMLScene interface is the public interface for attaching content (E.g.\n * an MML Document) into the underlyingScene, but it can be implemented by\n * classes other than MMLScene.\n */\nexport type IMMLScene<G extends GraphicsAdapter = GraphicsAdapter> = {\n  getGraphicsAdapter: () => G;\n  hasGraphicsAdapter: () => boolean;\n\n  addCollider?: (collider: unknown, element: MElement<G>) => void;\n  updateCollider?: (collider: unknown, element: MElement<G>) => void;\n  removeCollider?: (collider: unknown, element: MElement<G>) => void;\n\n  addInteraction?: (interaction: Interaction<G>) => void;\n  updateInteraction?: (interaction: Interaction<G>) => void;\n  removeInteraction?: (interaction: Interaction<G>) => void;\n\n  addChatProbe?: (chatProbe: ChatProbe<G>) => void;\n  updateChatProbe?: (chatProbe: ChatProbe<G>) => void;\n  removeChatProbe?: (chatProbe: ChatProbe<G>) => void;\n\n  getOverlayElement?: () => HTMLElement | null;\n\n  getUserPositionAndRotation(): PositionAndRotation;\n\n  prompt: (\n    promptProps: PromptProps,\n    abortSignal: AbortSignal,\n    callback: (message: string | null) => void,\n  ) => void;\n\n  link: (\n    linkProps: LinkProps,\n    abortSignal: AbortSignal,\n    windowCallback: (openedWindow: Window | null) => void,\n  ) => void;\n\n  getLoadingProgressManager?: () => LoadingProgressManager | null;\n};\n\n/**\n * The MMLScene class creates a HTML Element that renders a scene and includes the various manager instances\n * for handling clicks, interaction events, and controls.\n *\n * It is the default implementation of the IMMLScene interface and presents a fly camera with drag controls.\n */\nexport class MMLScene<G extends StandaloneGraphicsAdapter> implements IMMLScene<G> {\n  private colliders = new Set<unknown>();\n\n  private interactions = new Set<Interaction<G>>();\n  private interactionListeners = new Set<InteractionListener<G>>();\n\n  private chatProbes = new Set<ChatProbe<G>>();\n  private chatProbeListeners = new Set<ChatProbeListener<G>>();\n\n  private resizeListener: () => void;\n  private promptManager: PromptManager;\n  private interactionManager: InteractionManager;\n  private resizeObserver: ResizeObserver;\n  private loadingProgressManager: LoadingProgressManager;\n\n  private graphicsAdapter: G | null = null;\n\n  constructor(public element: HTMLElement) {\n    this.loadingProgressManager = new LoadingProgressManager();\n  }\n\n  public init(graphicsAdapter: G) {\n    this.graphicsAdapter = graphicsAdapter;\n    this.graphicsAdapter.start();\n\n    this.resizeObserver = new ResizeObserver(() => {\n      this.fitContainer();\n    });\n    this.resizeObserver.observe(this.element);\n\n    this.promptManager = PromptManager.init(this.element);\n    const { interactionManager, interactionListener } = InteractionManager.init(\n      this.element,\n      this.graphicsAdapter.interactionShouldShowDistance.bind(this.graphicsAdapter),\n    );\n    this.interactionManager = interactionManager;\n    this.addInteractionListener(interactionListener);\n\n    this.resizeListener = () => {\n      this.fitContainer();\n    };\n    window.addEventListener(\"resize\", this.resizeListener, false);\n\n    this.fitContainer();\n  }\n\n  public hasGraphicsAdapter(): boolean {\n    return this.graphicsAdapter !== null;\n  }\n\n  public getGraphicsAdapter(): G {\n    if (!this.graphicsAdapter) {\n      throw new Error(\"MMLScene not initialized with a graphics adapter. Call init() first.\");\n    }\n    return this.graphicsAdapter;\n  }\n\n  public getUserPositionAndRotation(): PositionAndRotation {\n    if (!this.graphicsAdapter) {\n      throw new Error(\"MMLScene not initialized with a graphics adapter\");\n    }\n    return this.graphicsAdapter.getUserPositionAndRotation();\n  }\n\n  public fitContainer() {\n    if (!this.graphicsAdapter) {\n      throw new Error(\"MMLScene not initialized with a graphics adapter\");\n    }\n    const width = this.element.clientWidth;\n    const height = this.element.clientHeight;\n    this.graphicsAdapter.resize(width, height);\n  }\n\n  public dispose() {\n    window.removeEventListener(\"resize\", this.resizeListener);\n    this.resizeObserver.disconnect();\n    this.promptManager.dispose();\n    this.interactionManager.dispose();\n  }\n\n  public prompt(\n    promptProps: PromptProps,\n    abortSignal: AbortSignal,\n    callback: (message: string | null) => void,\n  ) {\n    if (!this) {\n      console.error(\"MMLScene not initialized\");\n      return;\n    }\n    this.promptManager.prompt(promptProps, abortSignal, callback);\n  }\n\n  public link(\n    linkProps: LinkProps,\n    abortSignal: AbortSignal,\n    windowCallback: (openedWindow: Window | null) => void,\n  ) {\n    this.promptManager.link(linkProps, abortSignal, windowCallback);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  public addCollider(collider: unknown, element: MElement<G>): void {\n    this.colliders.add(collider);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  public updateCollider(collider: unknown): void {\n    // no-op\n  }\n\n  public removeCollider(collider: unknown): void {\n    this.colliders.delete(collider);\n  }\n\n  public addInteraction(interaction: Interaction<G>): void {\n    this.interactions.add(interaction);\n    for (const listener of this.interactionListeners) {\n      listener.addInteraction(interaction);\n    }\n  }\n\n  public updateInteraction(interaction: Interaction<G>): void {\n    for (const listener of this.interactionListeners) {\n      listener.updateInteraction(interaction);\n    }\n  }\n\n  public removeInteraction(interaction: Interaction<G>): void {\n    this.interactions.delete(interaction);\n    for (const listener of this.interactionListeners) {\n      listener.removeInteraction(interaction);\n    }\n  }\n\n  public getInteractions(): Set<Interaction<G>> {\n    return this.interactions;\n  }\n\n  public addInteractionListener(\n    listener: InteractionListener<G>,\n    addExistingInteractions = true,\n  ): void {\n    this.interactionListeners.add(listener);\n    if (addExistingInteractions) {\n      for (const interaction of this.interactions) {\n        listener.addInteraction(interaction);\n      }\n    }\n  }\n\n  public removeInteractionListener(listener: InteractionListener<G>): void {\n    this.interactionListeners.delete(listener);\n  }\n\n  public addChatProbe(chatProbe: ChatProbe<G>): void {\n    this.chatProbes.add(chatProbe);\n    for (const listener of this.chatProbeListeners) {\n      listener.addChatProbe(chatProbe);\n    }\n  }\n\n  public updateChatProbe(chatProbe: ChatProbe<G>): void {\n    for (const listener of this.chatProbeListeners) {\n      listener.updateChatProbe(chatProbe);\n    }\n  }\n\n  public removeChatProbe(chatProbe: ChatProbe<G>): void {\n    this.chatProbes.delete(chatProbe);\n    for (const listener of this.chatProbeListeners) {\n      listener.removeChatProbe(chatProbe);\n    }\n  }\n\n  public getLoadingProgressManager(): LoadingProgressManager {\n    return this.loadingProgressManager;\n  }\n\n  public getChatProbes(): Set<ChatProbe<G>> {\n    return this.chatProbes;\n  }\n\n  public addChatProbeListener(listener: ChatProbeListener<G>, addExistingChatProbes = true): void {\n    this.chatProbeListeners.add(listener);\n    if (addExistingChatProbes) {\n      for (const chatProbe of this.chatProbes) {\n        listener.addChatProbe(chatProbe);\n      }\n    }\n  }\n\n  public removeChatProbeListener(listener: ChatProbeListener<G>): void {\n    this.chatProbeListeners.delete(listener);\n  }\n}\n", "import { StandaloneGraphicsAdapter } from \"../graphics\";\nimport { LoadingProgressBar, LoadingSpinner } from \"../loading\";\nimport { MMLScene } from \"./MMLScene\";\n\nexport type FullScreenMMLSceneOptions = {\n  showDebugLoading?: boolean;\n  loadingStyle?: \"bar\" | \"spinner\";\n  allowOverlay?: boolean;\n};\n\nexport class FullScreenMMLScene<G extends StandaloneGraphicsAdapter> extends MMLScene<G> {\n  private loadingProgressBar: LoadingProgressBar | LoadingSpinner;\n  private showDebugLoading: boolean;\n\n  constructor(private options: FullScreenMMLSceneOptions = {}) {\n    super(document.createElement(\"div\"));\n    this.element = document.createElement(\"div\");\n    this.element.style.width = \"100%\";\n    this.element.style.height = \"100%\";\n    this.element.style.position = \"relative\";\n\n    this.showDebugLoading = options.showDebugLoading ?? true;\n\n    this.createLoadingProgressBar();\n    this.configureWindowStyling();\n  }\n\n  private createLoadingProgressBar() {\n    const loadingProgressManager = this.getLoadingProgressManager();\n    const loadingStyle = this.options.loadingStyle || \"bar\";\n    if (loadingStyle === \"spinner\") {\n      this.loadingProgressBar = new LoadingSpinner(loadingProgressManager);\n    } else {\n      this.loadingProgressBar = new LoadingProgressBar(\n        loadingProgressManager,\n        this.showDebugLoading,\n      );\n    }\n    this.element.append(this.loadingProgressBar.element);\n  }\n\n  public resetLoadingProgressBar() {\n    this.loadingProgressBar.dispose();\n    this.createLoadingProgressBar();\n  }\n\n  public getOverlayElement(): HTMLElement | null {\n    if (this.options.allowOverlay) {\n      return this.element;\n    }\n    return null;\n  }\n\n  private configureWindowStyling() {\n    document.documentElement.style.width = \"100%\";\n    document.documentElement.style.height = \"100%\";\n    document.documentElement.style.overflow = \"hidden\";\n    document.documentElement.style.overscrollBehaviorX = \"contain\";\n    document.documentElement.style.margin = \"0\";\n\n    const onload = () => {\n      document.body.style.margin = \"0\";\n      document.body.style.height = \"100%\";\n    };\n    if (document.body) {\n      onload();\n    } else {\n      window.addEventListener(\"load\", () => {\n        onload();\n      });\n    }\n  }\n\n  dispose() {\n    super.dispose();\n    this.element.remove();\n  }\n}\n", "import { MElement, registerCustomElementsToWindow } from \"./elements\";\nimport { setGlobalDocumentTimeManager, setGlobalMMLScene } from \"./global\";\nimport { StandaloneGraphicsAdapter } from \"./graphics\";\nimport { FullScreenMMLScene, FullScreenMMLSceneOptions } from \"./scene\";\nimport { MMLDocumentTimeManager } from \"./time\";\n\nexport function configureWindowForMML(\n  window: Window,\n  getGraphicsAdapter: (element: HTMLElement) => Promise<StandaloneGraphicsAdapter>,\n  options?: FullScreenMMLSceneOptions,\n) {\n  const fullScreenMMLScene = new FullScreenMMLScene(options);\n  const mmlDocumentTimeManager = new MMLDocumentTimeManager();\n  setGlobalMMLScene(fullScreenMMLScene);\n  setGlobalDocumentTimeManager(mmlDocumentTimeManager);\n  registerCustomElementsToWindow(window);\n  const onload = async () => {\n    window.document.body.append(fullScreenMMLScene.element);\n\n    const graphicsAdapter = await getGraphicsAdapter(fullScreenMMLScene.element);\n\n    fullScreenMMLScene.init(graphicsAdapter);\n\n    // Traverse all the elements in the document and add them to the scene\n    const traverse = (element: Element | Document) => {\n      for (const i in element.children) {\n        const child = element.children[i];\n        if (MElement.isMElement(child)) {\n          child.connectedCallback?.();\n        }\n        traverse(child);\n      }\n    };\n    traverse(window.document);\n\n    fullScreenMMLScene.getLoadingProgressManager().setInitialLoad(true);\n\n    const tick = () => {\n      mmlDocumentTimeManager.tick();\n      window.requestAnimationFrame(tick);\n    };\n    tick();\n  };\n\n  if (window.document.body) {\n    onload();\n  } else {\n    // Wait for the window to load\n    window.addEventListener(\"load\", onload);\n  }\n}\n", "import { Animation, MAnimationProps } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class AnimationGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Animation<G>) {}\n\n  abstract parentModelUpdated(): void;\n\n  abstract setSrc(src: string | null, mAnimationProps: MAnimationProps): void;\n\n  abstract setWeight(weight: number, mAnimationProps: MAnimationProps): void;\n\n  abstract setRatio(ratio: number | null, mAnimationProps: MAnimationProps): void;\n\n  abstract setSpeed(speed: number, mAnimationProps: MAnimationProps): void;\n\n  abstract setLoop(loop: boolean, mAnimationProps: MAnimationProps): void;\n\n  abstract setStartTime(startTime: number, mAnimationProps: MAnimationProps): void;\n\n  abstract setPauseTime(pauseTime: number | null, mAnimationProps: MAnimationProps): void;\n\n  abstract dispose(): void;\n}\n", "import { Audio, MAudioProps } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class AudioGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Audio<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract setSrc(src: string | null, mAudioProps: MAudioProps): void;\n\n  abstract setStartTime(startTime: number, mAudioProps: MAudioProps): void;\n\n  abstract setPauseTime(pauseTime: number | null, mAudioProps: MAudioProps): void;\n\n  abstract setLoopDuration(loopDuration: number | null, mAudioProps: MAudioProps): void;\n\n  abstract setLoop(loop: boolean, mAudioProps: MAudioProps): void;\n\n  abstract setEnabled(enabled: boolean, mAudioProps: MAudioProps): void;\n\n  abstract setVolume(volume: number, mAudioProps: MAudioProps): void;\n\n  abstract setConeAngle(coneAngle: number | null, mAudioProps: MAudioProps): void;\n\n  abstract setConeFalloffAngle(coneFalloffAngle: number | null, mAudioProps: MAudioProps): void;\n\n  abstract setDebug(debug: boolean, mAudioProps: MAudioProps): void;\n\n  abstract syncAudioTime(): void;\n\n  abstract dispose(): void;\n}\n", "import { ChatProbe, MChatProbeProps } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class ChatProbeGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: ChatProbe<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract setRange(range: number, mChatProbeProps: MChatProbeProps): void;\n\n  abstract setDebug(debug: boolean, mChatProbeProps: MChatProbeProps): void;\n\n  abstract dispose(): void;\n}\n", "import { MMLColor } from \"../color\";\nimport { Cube, MCubeProps } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class CubeGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Cube<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract getCollisionElement(): G[\"collisionType\"] | null;\n\n  abstract setWidth(width: number, mCubeProps: MCubeProps): void;\n\n  abstract setHeight(height: number, mCubeProps: MCubeProps): void;\n\n  abstract setDepth(depth: number, mCubeProps: MCubeProps): void;\n\n  abstract setColor(color: MMLColor, mCubeProps: MCubeProps): void;\n\n  abstract setOpacity(opacity: number, mCubeProps: MCubeProps): void;\n\n  abstract setCastShadows(castShadows: boolean, mCubeProps: MCubeProps): void;\n\n  abstract dispose(): void;\n}\n", "import { MMLColor } from \"../color\";\nimport { Cylinder, MCylinderProps } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class CylinderGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Cylinder<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract getCollisionElement(): G[\"collisionType\"] | null;\n\n  abstract setRadius(radius: number, mCylinderProps: MCylinderProps): void;\n\n  abstract setHeight(height: number, mCylinderProps: MCylinderProps): void;\n\n  abstract setColor(color: MMLColor, mCylinderProps: MCylinderProps): void;\n\n  abstract setOpacity(opacity: number, mCylinderProps: MCylinderProps): void;\n\n  abstract setCastShadows(castShadows: boolean, mCylinderProps: MCylinderProps): void;\n\n  abstract dispose(): void;\n}\n", "import { DebugHelper } from \"../debug-helper/DebugHelper\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class DebugHelperGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(debugHelper: DebugHelper<G>) {}\n\n  abstract dispose(): void;\n}\n", "import { Frame, MFrameProps } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class FrameGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Frame<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract setSrc(src: string | null, mFrameProps: MFrameProps): void;\n\n  abstract setDebug(debug: boolean, mFrameProps: MFrameProps): void;\n\n  abstract setLoadRange(loadRange: number | null, mFrameProps: MFrameProps): void;\n\n  abstract setUnloadRange(unloadRange: number, mFrameProps: MFrameProps): void;\n\n  abstract setMinX(minX: number | null, mFrameProps: MFrameProps): void;\n\n  abstract setMaxX(maxX: number | null, mFrameProps: MFrameProps): void;\n\n  abstract setMinY(minY: number | null, mFrameProps: MFrameProps): void;\n\n  abstract setMaxY(maxY: number | null, mFrameProps: MFrameProps): void;\n\n  abstract setMinZ(minZ: number | null, mFrameProps: MFrameProps): void;\n\n  abstract setMaxZ(maxZ: number | null, mFrameProps: MFrameProps): void;\n\n  abstract dispose(): void;\n}\n", "import { Image, MImageProps } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class ImageGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Image<G>, updateMeshCallback: () => void) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract getCollisionElement(): G[\"collisionType\"] | null;\n\n  abstract getWidthAndHeight(): { width: number; height: number };\n\n  abstract setSrc(src: string | null, mImageProps: MImageProps): void;\n\n  abstract setWidth(width: number | null, mImageProps: MImageProps): void;\n\n  abstract setHeight(height: number | null, mImageProps: MImageProps): void;\n\n  abstract setOpacity(opacity: number, mImageProps: MImageProps): void;\n\n  abstract setEmissive(opacity: number, mImageProps: MImageProps): void;\n\n  abstract setCastShadows(castShadows: boolean, mImageProps: MImageProps): void;\n\n  abstract dispose(): void;\n}\n", "import { Interaction, MInteractionProps } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class InteractionGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Interaction<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract setRange(range: number, mInteractionProps: MInteractionProps): void;\n\n  abstract setInFocus(inFocus: boolean, mInteractionProps: MInteractionProps): void;\n\n  abstract setLineOfSight(lineOfSight: boolean, mInteractionProps: MInteractionProps): void;\n\n  abstract setPriority(priority: number, mInteractionProps: MInteractionProps): void;\n\n  abstract setPrompt(prompt: string | null, mInteractionProps: MInteractionProps): void;\n\n  abstract setDebug(debug: boolean, mInteractionProps: MInteractionProps): void;\n\n  abstract dispose(): void;\n}\n", "import { MMLColor } from \"../color\";\nimport { Label, MLabelAlignment, MLabelProps } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class LabelGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Label<G>) {}\n\n  abstract allAttributesObserved(): void;\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract getCollisionElement(): G[\"collisionType\"] | null;\n\n  abstract setContent(content: string, mLabelProps: MLabelProps): void;\n\n  abstract setAlignment(alignment: MLabelAlignment, mLabelProps: MLabelProps): void;\n\n  abstract setWidth(width: number, mLabelProps: MLabelProps): void;\n\n  abstract setHeight(height: number, mLabelProps: MLabelProps): void;\n\n  abstract setFontSize(fontSize: number, mLabelProps: MLabelProps): void;\n\n  abstract setPadding(padding: number, mLabelProps: MLabelProps): void;\n\n  abstract setColor(color: MMLColor, mLabelProps: MLabelProps): void;\n\n  abstract setFontColor(fontColor: MMLColor, mLabelProps: MLabelProps): void;\n\n  abstract setCastShadows(castShadows: boolean, mLabelProps: MLabelProps): void;\n\n  abstract setEmissive(emissive: number, mLabelProps: MLabelProps): void;\n\n  abstract dispose(): void;\n}\n", "import { MMLColor } from \"../color\";\nimport { Light, LightTypes, MLightProps } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class LightGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Light<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract setEnabled(enabled: boolean, mLightProps: MLightProps): void;\n\n  abstract setDebug(debug: boolean, mLightProps: MLightProps): void;\n\n  abstract setCastShadows(castShadows: boolean, mLightProps: MLightProps): void;\n\n  abstract setAngle(angle: number, mLightProps: MLightProps): void;\n\n  abstract setIntensity(intensity: number, mLightProps: MLightProps): void;\n\n  abstract setDistance(distance: number, mLightProps: MLightProps): void;\n\n  abstract setType(type: LightTypes, mLightProps: MLightProps): void;\n\n  abstract setColor(color: MMLColor, mLightProps: MLightProps): void;\n\n  abstract dispose(): void;\n}\n", "import { Link, MLinkProps } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class LinkGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Link<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract setHref(href: string | null, props: MLinkProps): void;\n\n  abstract setTarget(target: string | null, props: MLinkProps): void;\n\n  abstract dispose(): void;\n}\n", "import { MElement } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class MElementGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: MElement<G>) {}\n\n  abstract getContainer(): G[\"containerType\"];\n\n  abstract dispose(): void;\n}\n", "import { Animation, MModelProps, Model } from \"../elements\";\nimport { IVect3 } from \"../math/Vect3\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class ModelGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Model<G>, updateMeshCallback: () => void) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract getBoundingBox(): {\n    centerOffset: IVect3;\n    size: IVect3;\n  } | null;\n\n  abstract transformed(): void;\n\n  abstract getCollisionElement(): G[\"collisionType\"] | null;\n\n  abstract hasLoadedModel(): boolean;\n\n  abstract hasLoadedAnimation(): boolean;\n\n  abstract setSrc(src: string | null, mModelProps: MModelProps): void;\n\n  abstract setAnim(anim: string | null, mModelProps: MModelProps): void;\n\n  abstract setAnimEnabled(animEnabled: boolean | null, mModelProps: MModelProps): void;\n\n  abstract setAnimLoop(animLoop: boolean | null, mModelProps: MModelProps): void;\n\n  abstract setAnimStartTime(animStartTime: number | null, mModelProps: MModelProps): void;\n\n  abstract setAnimPauseTime(animPauseTime: number | null, mModelProps: MModelProps): void;\n\n  abstract setDebug(debug: boolean, mModelProps: MModelProps): void;\n\n  abstract setCastShadows(castShadows: boolean, mModelProps: MModelProps): void;\n\n  abstract updateChildAnimation?(animation: Animation<G>, animationState: any): void;\n\n  abstract removeChildAnimation?(animation: Animation<G>): void;\n\n  abstract dispose(): void;\n}\n", "import { MOverlayProps, Overlay } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class OverlayGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Overlay<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract setAnchor(anchor: string | null, props: MOverlayProps): void;\n\n  abstract setOffsetX(target: number | null, props: MOverlayProps): void;\n\n  abstract setOffsetY(target: number | null, props: MOverlayProps): void;\n\n  abstract dispose(): void;\n}\n", "import { MMLColor } from \"../color\";\nimport { MPlaneProps, Plane } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class PlaneGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Plane<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract getCollisionElement(): G[\"collisionType\"] | null;\n\n  abstract setWidth(width: number, mPlaneProps: MPlaneProps): void;\n\n  abstract setHeight(height: number, mPlaneProps: MPlaneProps): void;\n\n  abstract setColor(color: MMLColor, mPlaneProps: MPlaneProps): void;\n\n  abstract setOpacity(opacity: number, mPlaneProps: MPlaneProps): void;\n\n  abstract setCastShadows(castShadows: boolean, mPlaneProps: MPlaneProps): void;\n\n  abstract dispose(): void;\n}\n", "import { MPositionProbeProps, PositionProbe } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class PositionProbeGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: PositionProbe<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract setRange(range: number, mPositionProbeProps: MPositionProbeProps): void;\n\n  abstract setDebug(debug: boolean, mPositionProbeProps: MPositionProbeProps): void;\n\n  abstract dispose(): void;\n}\n", "import { MPromptProps, Prompt } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class PromptGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Prompt<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract setMessage(message: string | undefined, mPromptProps: MPromptProps): void;\n\n  abstract setPlaceholder(placeholder: string | undefined, mPromptProps: MPromptProps): void;\n\n  abstract setPrefill(prefill: string | undefined, mPromptProps: MPromptProps): void;\n\n  abstract setDebug(debug: boolean, mPromptProps: MPromptProps): void;\n\n  abstract dispose(): void;\n}\n", "import { RemoteDocument } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class RemoteDocumentGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: RemoteDocument<G>) {}\n\n  abstract showError(showError: boolean): void;\n\n  abstract dispose(): void;\n}\n", "import { MMLColor } from \"../color\";\nimport { MSphereProps, Sphere } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class SphereGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Sphere<G>) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract getCollisionElement(): G[\"collisionType\"] | null;\n\n  abstract setRadius(width: number, mSphereProps: MSphereProps): void;\n\n  abstract setColor(color: MMLColor, mSphereProps: MSphereProps): void;\n\n  abstract setOpacity(opacity: number, mSphereProps: MSphereProps): void;\n\n  abstract setCastShadows(castShadows: boolean, mSphereProps: MSphereProps): void;\n\n  abstract dispose(): void;\n}\n", "import { TransformableElement, TransformableElementProps } from \"../elements\";\nimport { Matr4 } from \"../math/Matr4\";\nimport { IVect3 } from \"../math/Vect3\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class TransformableGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: TransformableElement<G>) {}\n\n  abstract getWorldMatrix(): Matr4;\n\n  abstract getWorldPosition(): IVect3;\n\n  abstract getLocalPosition(): IVect3;\n\n  abstract setSocket(\n    socket: string | null,\n    transformableElementProps: TransformableElementProps,\n  ): void;\n\n  abstract setX(x: number, transformableElementProps: TransformableElementProps): void;\n\n  abstract setY(y: number, transformableElementProps: TransformableElementProps): void;\n\n  abstract setZ(z: number, transformableElementProps: TransformableElementProps): void;\n\n  abstract setRotationX(\n    rotationX: number,\n    transformableElementProps: TransformableElementProps,\n  ): void;\n\n  abstract setRotationY(\n    rotationY: number,\n    transformableElementProps: TransformableElementProps,\n  ): void;\n\n  abstract setRotationZ(\n    rotationZ: number,\n    transformableElementProps: TransformableElementProps,\n  ): void;\n\n  abstract setScaleX(scaleX: number, transformableElementProps: TransformableElementProps): void;\n\n  abstract setScaleY(scaleY: number, transformableElementProps: TransformableElementProps): void;\n\n  abstract setScaleZ(scaleZ: number, transformableElementProps: TransformableElementProps): void;\n\n  abstract getVisible(): boolean;\n\n  abstract setVisible(visible: boolean, transformableElementProps: TransformableElementProps): void;\n\n  abstract dispose(): void;\n}\n", "import { MVideoProps, Video } from \"../elements\";\nimport { GraphicsAdapter } from \"./GraphicsAdapter\";\n\nexport abstract class VideoGraphics<G extends GraphicsAdapter = GraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(element: Video<G>, updateMeshCallback: () => void) {}\n\n  abstract enable(): void;\n\n  abstract disable(): void;\n\n  abstract getCollisionElement(): G[\"collisionType\"] | null;\n\n  abstract getWidthAndHeight(): { width: number; height: number };\n\n  abstract setSrc(src: string | null, mVideoProps: MVideoProps): void;\n\n  abstract setWidth(width: number | null, mVideoProps: MVideoProps): void;\n\n  abstract setHeight(height: number | null, mVideoProps: MVideoProps): void;\n\n  abstract setEnabled(enabled: boolean, mVideoProps: MVideoProps): void;\n\n  abstract setCastShadows(castShadows: boolean, mVideoProps: MVideoProps): void;\n\n  abstract setLoop(loop: boolean, mVideoProps: MVideoProps): void;\n\n  abstract setVolume(volume: number, mVideoProps: MVideoProps): void;\n\n  abstract setEmissive(emissive: number, mVideoProps: MVideoProps): void;\n\n  abstract setStartTime(startTime: number, mVideoProps: MVideoProps): void;\n\n  abstract setPauseTime(pauseTime: number | null, mVideoProps: MVideoProps): void;\n\n  abstract syncVideoTime(): void;\n\n  abstract dispose(): void;\n}\n", "export type IframeWrapperResult = {\n  iframeWrapper: IframeWrapper;\n  iframeWindow: Window;\n  iframeDocument: Document;\n  iframeBody: HTMLElement;\n};\n\n/**\n * The IframeWrapper class creates an iframe that can be used to load a document and then be disposed of. This is useful\n * for running a full NetworkedDOM document in an iframe and then disposing of it when it is no longer needed which will\n * clear up the <script> tags that were added to the document and their side-effects.\n *\n * The other use case this is intended for is as a target for a client connected to a document to synchronise the\n * document state to and have the custom element implementations for the elements in the document run in the iframe (and\n * therefore not pollute/conflict with the root window)\n */\nexport class IframeWrapper {\n  public readonly iframe: HTMLIFrameElement;\n\n  private constructor() {\n    this.iframe = document.createElement(\"iframe\");\n    this.iframe.style.position = \"fixed\";\n    this.iframe.style.top = \"0\";\n    this.iframe.style.left = \"0\";\n    this.iframe.style.width = \"0\";\n    this.iframe.style.height = \"0\";\n    this.iframe.style.border = \"none\";\n    this.iframe.style.visibility = \"hidden\";\n  }\n\n  public static async create(): Promise<IframeWrapperResult> {\n    return new Promise((resolve) => {\n      const iframeWrapper = new IframeWrapper();\n      document.body.append(iframeWrapper.iframe);\n\n      /*\n       Firefox is inconsistent with Chrome on how iframes are loaded. Firefox presents an empty doc that is then\n       disposed of before presenting a clean second document so we need to wait for the load event before appending\n       anything.\n      */\n      const ready = iframeWrapper.iframe.contentWindow\n        ? iframeWrapper.iframe.contentWindow.document.readyState === \"complete\"\n        : false;\n      const onLoad = () => {\n        const iframe = iframeWrapper.iframe;\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const iframeWindow = iframe.contentWindow!;\n        resolve({\n          iframeWrapper,\n          iframeWindow,\n          iframeDocument: iframeWindow.document,\n          iframeBody: iframeWindow.document.body,\n        });\n      };\n      if (ready) {\n        // Run this asynchronously to ensure that implementations handle the case of waiting correctly\n        setTimeout(() => {\n          onLoad();\n        });\n      } else {\n        iframeWrapper.iframe.addEventListener(\"load\", () => {\n          onLoad();\n        });\n      }\n    });\n  }\n\n  public dispose() {\n    this.iframe.remove();\n  }\n}\n", "export class StatusUI {\n  private element: HTMLDivElement;\n\n  constructor() {\n    this.element = document.createElement(\"div\");\n    this.element.style.position = \"fixed\";\n    this.element.style.top = \"50%\";\n    this.element.style.left = \"50%\";\n    this.element.style.transform = \"translate(-50%, -50%)\";\n    this.element.style.zIndex = \"1000\";\n    this.element.style.backgroundColor = \"rgba(0, 0, 0, 0.5)\";\n    this.element.style.color = \"white\";\n    this.element.style.padding = \"1em\";\n    this.element.style.fontFamily = \"sans-serif\";\n    this.element.style.fontSize = \"1.5em\";\n    this.element.style.fontWeight = \"bold\";\n    this.element.style.pointerEvents = \"none\";\n    this.element.style.display = \"none\";\n    document.body.append(this.element);\n  }\n\n  public setStatus(text: string) {\n    this.element.textContent = text;\n    this.element.style.display = \"block\";\n  }\n\n  public setNoStatus() {\n    this.element.textContent = \"\";\n    this.element.style.display = \"none\";\n  }\n\n  dispose() {\n    this.element.remove();\n  }\n}\n", "export type TagAdapterThemeColors = {\n  background: string;\n  brackets: string;\n  tag: string;\n  attribute: string;\n  unrecognizedAttribute: string;\n  value: string;\n  appliedValue: string;\n  equals: string;\n  quote: string;\n};\n\nexport const tagAdapterDefaultTheme: TagAdapterThemeColors = {\n  background: \"#1D2331\",\n  brackets: \"#D4D2C8\",\n  tag: \"#73D0FF\",\n  attribute: \"#FFD173\",\n  unrecognizedAttribute: \"#FF9800\",\n  value: \"#D5FF80\",\n  appliedValue: \"#B800FF\",\n  equals: \"#FFAD66\",\n  quote: \"#D5FF80\",\n};\n", "import { DebugHelper } from \"../debug-helper\";\nimport { DebugHelperGraphics } from \"../graphics\";\nimport { TagDebugGraphicsAdapter } from \"./StandaloneTagDebugAdapter\";\n\nexport class TagDebugAdapterDebugHelper implements DebugHelperGraphics<TagDebugGraphicsAdapter> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(debugHelper: DebugHelper<TagDebugGraphicsAdapter>) {}\n\n  dispose(): void {\n    // no-op\n  }\n}\n", "import { MElement } from \"../elements\";\nimport { TagDebugGraphicsAdapter } from \"./StandaloneTagDebugAdapter\";\n\nexport function TagDebugAdapterElement<\n  T extends Record<string, string>,\n  G extends Record<string, any>,\n>(\n  functionToAttribute: T,\n  additionalFunctions: G,\n): (element: MElement<TagDebugGraphicsAdapter>) => {\n  enable: () => void;\n  disable: () => void;\n  dispose: () => void;\n  getCollisionElement(): null;\n} & Record<keyof T, (val: any, props: any) => void> &\n  G {\n  return (element: MElement<TagDebugGraphicsAdapter>) => {\n    const result = {} as Record<keyof T, (val: any, props: any) => void>;\n    for (const key in functionToAttribute) {\n      const attributeName = functionToAttribute[key];\n      result[key] = (val: any) => {\n        element.getContainer()?.setAppliedAttributeValue(attributeName, val);\n      };\n    }\n    return {\n      ...result,\n      enable: () => {\n        // no-op\n      },\n      disable: () => {\n        // no-op\n      },\n      getCollisionElement() {\n        return null;\n      },\n      dispose: () => {\n        // no-op\n      },\n      ...additionalFunctions,\n    };\n  };\n}\n", "import { MMLColor } from \"../color\";\nimport { TagAdapterThemeColors } from \"./TagAdapterThemeColors\";\n\nexport class TagDebugAttribute {\n  public element: HTMLElement;\n\n  private readonly valueSpan: HTMLSpanElement;\n\n  private appliedValue: {\n    raw: number | string | MMLColor | boolean;\n    displayString: string;\n    asString: string;\n  } | null = null;\n  private readonly appliedValueSpan: HTMLSpanElement;\n\n  constructor(\n    public key: string,\n    public value: string | null,\n    private theme: TagAdapterThemeColors,\n    private isObserved: boolean,\n  ) {\n    this.element = document.createElement(\"span\");\n\n    if (!isObserved) {\n      this.element.style.borderBottomStyle = \"dotted\";\n      this.element.style.borderWidth = \"2px\";\n      this.element.style.borderColor = this.theme.unrecognizedAttribute;\n    }\n\n    const keySpan = document.createElement(\"span\");\n    keySpan.textContent = ` ${key}`;\n    keySpan.style.color = this.theme.attribute;\n\n    const equalsSpan = document.createElement(\"span\");\n    equalsSpan.textContent = \"=\";\n    equalsSpan.style.color = this.theme.equals;\n\n    const quoteSpan = document.createElement(\"span\");\n    quoteSpan.textContent = `\"`;\n    quoteSpan.style.color = this.theme.quote;\n\n    this.valueSpan = document.createElement(\"span\");\n    this.valueSpan.textContent = value;\n    this.valueSpan.style.color = this.theme.value;\n\n    const endQuoteSpan = document.createElement(\"span\");\n    endQuoteSpan.textContent = `\"`;\n    endQuoteSpan.style.color = this.theme.quote;\n\n    this.appliedValueSpan = document.createElement(\"span\");\n    this.appliedValueSpan.className = \"no-copy\";\n    this.appliedValueSpan.style.color = this.theme.appliedValue;\n    this.appliedValueSpan.style.display = \"none\";\n\n    this.element.append(\n      keySpan,\n      equalsSpan,\n      quoteSpan,\n      this.valueSpan,\n      endQuoteSpan,\n      this.appliedValueSpan,\n    );\n  }\n\n  public setValue(value: string | null) {\n    this.value = value;\n    if (value === null) {\n      this.valueSpan.textContent = \"\";\n      this.appliedValueSpan.style.display = \"none\";\n      if (this.appliedValue !== null) {\n        this.appliedValueSpan.style.display = \"inline\";\n      }\n      return;\n    }\n    this.valueSpan.textContent = `${value}`;\n    if (this.appliedValue !== null) {\n      if (this.appliedValue.asString === value) {\n        this.appliedValueSpan.style.display = \"none\";\n      } else {\n        this.appliedValueSpan.style.display = \"inline\";\n      }\n    }\n  }\n\n  public setAppliedValue(value: number | string | boolean | MMLColor | null) {\n    if (value === null) {\n      this.appliedValueSpan.style.display = \"none\";\n      this.appliedValue = null;\n      return;\n    }\n    if (typeof value === \"object\") {\n      // Assume it is a color\n      this.appliedValueSpan.style.display = \"inline\";\n      this.appliedValueSpan.textContent = `\u2588(${value.r}, ${value.g}, ${value.b}${value.a ? `, ${value.a}` : \"\"})`;\n      const average = (value.r + value.g + value.b) / 3;\n      this.appliedValueSpan.style.color = `rgb(${value.r * 255}, ${value.g * 255}, ${value.b * 255})`;\n      this.appliedValueSpan.style.backgroundColor = average > 0.5 ? \"black\" : \"white\";\n    } else {\n      const asString = value.toString();\n      let displayString = asString;\n      if (typeof value === \"number\") {\n        // Limit the number of decimal places\n        const asFixed = value.toFixed(6);\n        if (asString.length > asFixed.length) {\n          displayString = asFixed;\n        }\n      }\n      this.appliedValue = {\n        raw: value,\n        asString,\n        displayString,\n      };\n      if (this.value !== null) {\n        if (this.value === asString) {\n          this.appliedValueSpan.style.display = \"none\";\n          return;\n        }\n      }\n      this.appliedValueSpan.style.display = \"inline\";\n      this.appliedValueSpan.textContent = `(${displayString})`;\n    }\n  }\n\n  hasAppliedValue() {\n    return this.appliedValue !== null;\n  }\n\n  hasValue() {\n    return this.value !== null;\n  }\n}\n", "import { MMLColor } from \"../color\";\nimport { MElement } from \"../elements\";\nimport { MElementGraphics } from \"../graphics\";\nimport { IMMLScene } from \"../scene\";\nimport { TagDebugGraphicsAdapter } from \"./StandaloneTagDebugAdapter\";\nimport { TagAdapterThemeColors } from \"./TagAdapterThemeColors\";\nimport { TagDebugAttribute } from \"./TagDebugAttribute\";\n\nconst ignoredAttributes = new Set([\"style\"]);\n\nexport class TagDebugMElement implements MElementGraphics<TagDebugGraphicsAdapter> {\n  private container: HTMLElement;\n  private mutationObserver: MutationObserver;\n  private attributesHolder: HTMLSpanElement;\n  private childElementHolder: HTMLDivElement;\n  private currentParent: TagDebugMElement | IMMLScene<TagDebugGraphicsAdapter> | null = null;\n\n  private attributes: Record<string, TagDebugAttribute> = {};\n  private theme: TagAdapterThemeColors;\n  public indentLevel: number;\n  private observedAttributes = new Set<string>();\n\n  constructor(private mElement: MElement<TagDebugGraphicsAdapter>) {\n    // @ts-expect-error - accessing __proto__ is not type safe\n    const observedAttributesArray = mElement.__proto__?.constructor?.observedAttributes ?? [];\n    this.observedAttributes = new Set([...observedAttributesArray, \"id\", \"class\"]);\n\n    const graphicAdapter = mElement.getScene().getGraphicsAdapter();\n    this.theme = graphicAdapter.theme;\n\n    this.container = document.createElement(\"div\");\n    this.container.style.fontFamily = \"monospace\";\n    this.container.style.lineHeight = \"1.5em\";\n\n    const mElementParent = this.mElement.getMElementParent();\n    if (mElementParent) {\n      this.currentParent = mElementParent.getContainer() as TagDebugMElement;\n      this.currentParent?.childElementHolder.append(this.container);\n      this.indentLevel = this.currentParent.indentLevel + 1;\n    } else {\n      // If none of the ancestors are MElements then this element may be directly connected to the body (without a wrapper).\n      // Attempt to use a global scene that has been configured to attach this element to.\n      const scene = this.mElement.getScene();\n      this.currentParent = scene;\n      (scene.getGraphicsAdapter().getRootContainer() as HTMLElement).append(this.container);\n      this.indentLevel = 0;\n    }\n\n    const firstLine = document.createElement(\"div\");\n    firstLine.style.textWrap = \"nowrap\";\n    const openingLineBreak = document.createElement(\"span\");\n    openingLineBreak.textContent = \"\\n\";\n\n    const openingBracket = document.createElement(\"span\");\n    const indent = Array(this.indentLevel * 4)\n      .fill(\" \")\n      .join(\"\");\n    openingBracket.textContent = `${indent}<`;\n    openingBracket.style.color = this.theme.brackets;\n    openingBracket.style.whiteSpace = \"pre\";\n\n    const openingTag = document.createElement(\"span\");\n    openingTag.textContent = mElement.tagName.toLowerCase();\n    openingTag.style.color = this.theme.tag;\n    this.attributesHolder = document.createElement(\"span\");\n\n    const openingTagEnd = document.createElement(\"span\");\n    openingTagEnd.textContent = \">\";\n    openingTagEnd.style.color = this.theme.brackets;\n\n    firstLine.append(\n      openingLineBreak,\n      openingBracket,\n      openingTag,\n      this.attributesHolder,\n      openingTagEnd,\n    );\n    this.childElementHolder = document.createElement(\"div\");\n\n    const closingTag = document.createElement(\"div\");\n    closingTag.style.textWrap = \"nowrap\";\n    const closingLineBreak = document.createElement(\"span\");\n    closingLineBreak.textContent = \"\\n\";\n    const closingTagOpeningBracket = document.createElement(\"span\");\n    closingTagOpeningBracket.textContent = `${indent}</`;\n    closingTagOpeningBracket.style.color = this.theme.brackets;\n    closingTagOpeningBracket.style.whiteSpace = \"pre\";\n    const closingTagName = document.createElement(\"span\");\n    closingTagName.textContent = mElement.tagName.toLowerCase();\n    closingTagName.style.color = this.theme.tag;\n    const closingTagEnd = document.createElement(\"span\");\n    closingTagEnd.textContent = \">\";\n    closingTagEnd.style.color = this.theme.brackets;\n    closingTag.append(closingLineBreak, closingTagOpeningBracket, closingTagName, closingTagEnd);\n    this.container.append(firstLine, this.childElementHolder, closingTag);\n\n    this.mutationObserver = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        if (mutation.type === \"attributes\") {\n          // attributeName is always set for attributes\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          const attributeName = mutation.attributeName!;\n          if (ignoredAttributes.has(attributeName)) {\n            return;\n          }\n          const attributeValue = this.mElement.getAttribute(attributeName);\n          const existingAttribute = this.attributes[attributeName];\n          if (attributeValue === null) {\n            if (existingAttribute) {\n              if (!existingAttribute.hasAppliedValue()) {\n                existingAttribute.element.remove();\n                delete this.attributes[attributeName];\n              } else {\n                existingAttribute.setValue(null);\n              }\n            }\n          } else {\n            if (existingAttribute) {\n              existingAttribute.setValue(attributeValue);\n            } else {\n              this.createAttributeElement(attributeName, attributeValue);\n            }\n          }\n        }\n      });\n    });\n\n    // Add existing attributes\n    for (let i = 0; i < mElement.attributes.length; i++) {\n      const attribute = mElement.attributes[i];\n      if (ignoredAttributes.has(attribute.name)) {\n        continue;\n      }\n      this.createAttributeElement(attribute.name, attribute.value);\n    }\n\n    this.mutationObserver.observe(mElement, { attributes: true });\n  }\n\n  private createAttributeElement(attributeName: string, value: string | null): TagDebugAttribute {\n    const newAttribute = new TagDebugAttribute(\n      attributeName,\n      value,\n      this.theme,\n      this.observedAttributes.has(attributeName),\n    );\n    this.attributes[attributeName] = newAttribute;\n    this.attributesHolder.append(newAttribute.element);\n    return newAttribute;\n  }\n\n  public setAppliedAttributeValue(\n    attributeName: string,\n    value: number | string | boolean | MMLColor | null,\n  ): void {\n    const existingAttribute = this.attributes[attributeName];\n    if (existingAttribute) {\n      existingAttribute.setAppliedValue(value);\n      if (value === null && !existingAttribute.hasValue()) {\n        existingAttribute.element.remove();\n        delete this.attributes[attributeName];\n      }\n    } else if (value !== null) {\n      const newAttribute = this.createAttributeElement(attributeName, null);\n      newAttribute.setAppliedValue(value);\n    }\n  }\n\n  getContainer(): TagDebugMElement {\n    return this;\n  }\n\n  dispose(): void {\n    this.mutationObserver.disconnect();\n\n    if (this.currentParent === null) {\n      throw new Error(\"Was not connected to a parent\");\n    }\n\n    if (this.currentParent instanceof TagDebugMElement) {\n      this.currentParent.childElementHolder.removeChild(this.container);\n      this.currentParent = null;\n    } else {\n      (this.currentParent.getGraphicsAdapter().getRootContainer() as HTMLElement).removeChild(\n        this.container,\n      );\n      this.currentParent = null;\n    }\n  }\n}\n", "import { Matr4, Vect3 } from \"../math\";\nimport { MMLGraphicsInterface } from \"../scene\";\nimport { TagDebugGraphicsAdapter } from \"./StandaloneTagDebugAdapter\";\nimport { TagDebugAdapterDebugHelper } from \"./TagDebugAdapterDebugHelper\";\nimport { TagDebugAdapterElement } from \"./TagDebugAdapterElement\";\nimport { TagDebugMElement } from \"./TagDebugMElement\";\n\nexport const TagDebugAdapterGraphicsInterface: MMLGraphicsInterface<TagDebugGraphicsAdapter> = {\n  MElementGraphicsInterface: (element) => new TagDebugMElement(element),\n  MMLDebugHelperGraphicsInterface: (debugHelper) => new TagDebugAdapterDebugHelper(debugHelper),\n  MMLCubeGraphicsInterface: TagDebugAdapterElement(\n    {\n      setWidth: \"width\",\n      setHeight: \"height\",\n      setDepth: \"depth\",\n      setCastShadows: \"cast-shadows\",\n      setColor: \"color\",\n      setOpacity: \"opacity\",\n    },\n    {},\n  ),\n  MMLSphereGraphicsInterface: TagDebugAdapterElement(\n    {\n      setRadius: \"radius\",\n      setCastShadows: \"cast-shadows\",\n      setColor: \"color\",\n      setOpacity: \"opacity\",\n    },\n    {},\n  ),\n  MMLPlaneGraphicsInterface: TagDebugAdapterElement(\n    {\n      setWidth: \"width\",\n      setHeight: \"height\",\n      setCastShadows: \"cast-shadows\",\n      setColor: \"color\",\n      setOpacity: \"opacity\",\n    },\n    {},\n  ),\n  MMLImageGraphicsInterface: TagDebugAdapterElement(\n    {\n      setSrc: \"src\",\n      setWidth: \"width\",\n      setHeight: \"height\",\n      setEmissive: \"emissive\",\n      setCastShadows: \"cast-shadows\",\n      setOpacity: \"opacity\",\n    },\n    {\n      getWidthAndHeight: () => ({ width: 0, height: 0 }),\n    },\n  ),\n  MMLAudioGraphicsInterface: TagDebugAdapterElement(\n    {\n      setSrc: \"src\",\n      setEnabled: \"enabled\",\n      setLoop: \"loop\",\n      setLoopDuration: \"loop-duration\",\n      setVolume: \"volume\",\n      setStartTime: \"start-time\",\n      setPauseTime: \"pause-time\",\n      setConeAngle: \"cone-angle\",\n      setConeFalloffAngle: \"cone-falloff-angle\",\n      setDebug: \"debug\",\n    },\n    {\n      syncAudioTime: () => {},\n    },\n  ),\n  MMLCylinderGraphicsInterface: TagDebugAdapterElement(\n    {\n      setRadius: \"radius\",\n      setHeight: \"height\",\n      setCastShadows: \"cast-shadows\",\n      setColor: \"color\",\n      setOpacity: \"opacity\",\n    },\n    {},\n  ),\n  MMLTransformableGraphicsInterface: TagDebugAdapterElement(\n    {\n      setX: \"x\",\n      setY: \"y\",\n      setZ: \"z\",\n      setRotationX: \"rx\",\n      setRotationY: \"ry\",\n      setRotationZ: \"rz\",\n      setScaleX: \"sx\",\n      setScaleY: \"sy\",\n      setScaleZ: \"sz\",\n      setVisible: \"visible\",\n      setSocket: \"socket\",\n    },\n    {\n      getWorldMatrix: () => {\n        return new Matr4();\n      },\n      getWorldPosition: () => {\n        return new Vect3(0, 0, 0);\n      },\n      getLocalPosition: () => {\n        return new Vect3(0, 0, 0);\n      },\n      getVisible: () => {\n        return true;\n      },\n    },\n  ),\n  RemoteDocumentGraphicsInterface: TagDebugAdapterElement(\n    {},\n    {\n      showError() {\n        // no-op\n      },\n      dispose() {\n        // no-op\n      },\n    },\n  ),\n  MMLLightGraphicsInterface: TagDebugAdapterElement(\n    {\n      setEnabled: \"enabled\",\n      setDebug: \"debug\",\n      setCastShadows: \"cast-shadows\",\n      setAngle: \"angle\",\n      setIntensity: \"intensity\",\n      setDistance: \"distance\",\n      setType: \"type\",\n      setColor: \"color\",\n    },\n    {},\n  ),\n  MMLLinkGraphicsInterface: TagDebugAdapterElement(\n    {\n      setHref: \"href\",\n      setTarget: \"target\",\n    },\n    {},\n  ),\n  MMLModelGraphicsInterface: TagDebugAdapterElement(\n    {\n      setSrc: \"src\",\n      setDebug: \"debug\",\n      setCastShadows: \"cast-shadows\",\n      setAnim: \"anim\",\n      setAnimEnabled: \"anim-enabled\",\n      setAnimStartTime: \"anim-start-time\",\n      setAnimPauseTime: \"anim-pause-time\",\n      setAnimLoop: \"anim-loop\",\n    },\n    {\n      getBoundingBox: () => ({\n        centerOffset: { x: 0, y: 0, z: 0 },\n        size: { x: 0, y: 0, z: 0 },\n      }),\n      hasLoadedAnimation: () => false,\n      hasLoadedModel: () => false,\n      transformed: () => false,\n    },\n  ),\n  MMLVideoGraphicsInterface: TagDebugAdapterElement(\n    {\n      setSrc: \"src\",\n      setWidth: \"width\",\n      setHeight: \"height\",\n      setEnabled: \"enabled\",\n      setCastShadows: \"cast-shadows\",\n      setLoop: \"loop\",\n      setVolume: \"volume\",\n      setEmissive: \"emissive\",\n      setStartTime: \"start-time\",\n      setPauseTime: \"pause-time\",\n    },\n    {\n      syncVideoTime: () => {},\n      getWidthAndHeight: () => ({ width: 0, height: 0 }),\n    },\n  ),\n  MMLFrameGraphicsInterface: TagDebugAdapterElement(\n    {\n      setSrc: \"src\",\n      setDebug: \"debug\",\n      setLoadRange: \"load-range\",\n      setUnloadRange: \"unload-range\",\n      setMinX: \"min-x\",\n      setMaxX: \"max-x\",\n      setMinY: \"min-y\",\n      setMaxY: \"max-y\",\n      setMinZ: \"min-z\",\n      setMaxZ: \"max-z\",\n    },\n    {},\n  ),\n  MMLLabelGraphicsInterface: TagDebugAdapterElement(\n    {\n      setContent: \"content\",\n      setFontSize: \"font-size\",\n      setAlignment: \"alignment\",\n      setPadding: \"padding\",\n      setColor: \"color\",\n      setFontColor: \"font-color\",\n      setEmissive: \"emissive\",\n      setWidth: \"width\",\n      setHeight: \"height\",\n      setCastShadows: \"cast-shadows\",\n    },\n    {\n      allAttributesObserved: () => {},\n    },\n  ),\n  MMLPromptGraphicsInterface: TagDebugAdapterElement(\n    {\n      setMessage: \"message\",\n      setPlaceholder: \"placeholder\",\n      setPrefill: \"prefill\",\n      setDebug: \"debug\",\n    },\n    {},\n  ),\n  MMLInteractionGraphicsInterface: TagDebugAdapterElement(\n    {\n      setRange: \"range\",\n      setInFocus: \"in-focus\",\n      setLineOfSight: \"line-of-sight\",\n      setPriority: \"priority\",\n      setPrompt: \"prompt\",\n      setDebug: \"debug\",\n    },\n    {},\n  ),\n  MMLChatProbeGraphicsInterface: TagDebugAdapterElement(\n    {\n      setRange: \"range\",\n      setDebug: \"debug\",\n    },\n    {},\n  ),\n  MMLPositionProbeGraphicsInterface: TagDebugAdapterElement(\n    {\n      setRange: \"range\",\n      setDebug: \"debug\",\n    },\n    {},\n  ),\n  MMLAnimationGraphicsInterface: TagDebugAdapterElement(\n    {\n      setSrc: \"src\",\n      setWeight: \"weight\",\n      setLoop: \"loop\",\n      setSpeed: \"speed\",\n      setRatio: \"ratio\",\n      setStartTime: \"start-time\",\n      setPauseTime: \"pause-time\",\n    },\n    {\n      parentModelUpdated: () => {},\n    },\n  ),\n  MMLOverlayGraphicsInterface: TagDebugAdapterElement(\n    {\n      setAnchor: \"anchor\",\n      setOffsetX: \"offset-x\",\n      setOffsetY: \"offset-y\",\n    },\n    {\n      dispose: () => {},\n    },\n  ),\n};\n", "import { Interaction } from \"../elements\";\nimport { GraphicsAdapter } from \"../graphics\";\nimport { MMLGraphicsInterface } from \"../scene\";\nimport { tagAdapterDefaultTheme, TagAdapterThemeColors } from \"./TagAdapterThemeColors\";\nimport { TagDebugAdapterGraphicsInterface } from \"./TagDebugAdapterGraphicsInterface\";\nimport { TagDebugMElement } from \"./TagDebugMElement\";\n\nexport type TagDebugGraphicsAdapter = GraphicsAdapter<TagDebugMElement, null, HTMLElement> & {\n  theme: TagAdapterThemeColors;\n};\n\nexport class StandaloneTagDebugAdapter implements TagDebugGraphicsAdapter {\n  collisionType: null;\n  containerType: TagDebugMElement;\n\n  private constructor(private element: HTMLElement) {\n    this.element.style.background = this.theme.background;\n\n    element.addEventListener(\"copy\", function (e) {\n      e.preventDefault();\n      const selection = window.getSelection();\n      if (selection) {\n        const range = selection.getRangeAt(0);\n        const div = document.createElement(\"div\");\n        div.appendChild(range.cloneContents());\n        const noCopyElements = div.querySelectorAll(\".no-copy\");\n        noCopyElements.forEach((element) => element.remove());\n        const asText = div.textContent;\n        if (asText) {\n          e.clipboardData?.setData(\"text/plain\", asText);\n        }\n      }\n    });\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  interactionShouldShowDistance(interaction: Interaction<GraphicsAdapter>): number | null {\n    return null;\n  }\n\n  public getGraphicsAdapterFactory(): MMLGraphicsInterface<this> {\n    return TagDebugAdapterGraphicsInterface as MMLGraphicsInterface<this>;\n  }\n\n  public theme: TagAdapterThemeColors = tagAdapterDefaultTheme;\n\n  public static async create(element: HTMLElement): Promise<StandaloneTagDebugAdapter> {\n    element.style.overflow = \"auto\";\n    const adapter = new StandaloneTagDebugAdapter(element);\n    await adapter.init();\n    return adapter;\n  }\n\n  async init(): Promise<void> {\n    // No setup needed\n    return Promise.resolve();\n  }\n\n  start() {\n    // no-op\n  }\n\n  getUserPositionAndRotation() {\n    return {\n      position: {\n        x: 0,\n        y: 0,\n        z: 0,\n      },\n      rotation: {\n        x: 0,\n        y: 0,\n        z: 0,\n      },\n    };\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  resize(width: number, height: number) {\n    // no-op\n  }\n\n  dispose() {\n    // no-op\n  }\n\n  getRootContainer(): HTMLElement {\n    return this.element;\n  }\n}\n", "export function calculateContentSize(opts: {\n  content?: {\n    width: number;\n    height: number;\n  };\n  width: number | null;\n  height: number | null;\n}): { width: number; height: number } {\n  if (opts.content) {\n    const height = opts.height;\n    const width = opts.width;\n    const loadedWidth = Math.max(opts.content.width, 1);\n    const loadedHeight = Math.max(opts.content.height, 1);\n\n    if (height && width) {\n      return { width, height };\n    } else if (height && !width) {\n      return {\n        // compute width from height and content aspect ratio\n        width: (height * loadedWidth) / loadedHeight,\n        height,\n      };\n    } else if (!height && width) {\n      return {\n        width,\n        // compute height from width and content aspect ratio\n        height: (width * loadedHeight) / loadedWidth,\n      };\n    } else {\n      return {\n        width: 1,\n        // compute height from content aspect ratio\n        height: loadedHeight / loadedWidth,\n      };\n    }\n  } else {\n    // No content loaded - use the provided width and height if available\n    return {\n      width: opts.width !== null ? opts.width : 1,\n      height: opts.height !== null ? opts.height : 1,\n    };\n  }\n}\n", "import { VideoSource, VideoSourceProps } from \"./VideoSource\";\n\nexport class StaticFileVideoSource implements VideoSource {\n  private delayedStartTimer: NodeJS.Timeout | null = null;\n  private delayedPauseTimer: NodeJS.Timeout | null = null;\n  private shouldBePaused = false;\n  private pauseListener: () => void;\n\n  constructor(\n    private srcURL: URL,\n    private videoTag: HTMLVideoElement,\n    private videoSourceProps: VideoSourceProps,\n    private getDocumentTime: () => number | null,\n  ) {\n    this.pauseListener = () => {\n      if (this.shouldBePaused) {\n        // Pause is intentional\n        return;\n      }\n      // The video was likely paused (unintentionally) by the user using system controls\n      if (this.videoSourceProps) {\n        this.syncVideoSource(this.videoSourceProps);\n      }\n    };\n    videoTag.addEventListener(\"pause\", this.pauseListener);\n\n    try {\n      videoTag.src = srcURL.toString();\n    } catch (e) {\n      console.error(\"src failed to switch\", e);\n    }\n  }\n\n  public getContentAddress(): string {\n    return this.srcURL.toString();\n  }\n\n  public dispose() {\n    this.videoTag.removeEventListener(\"pause\", this.pauseListener);\n    this.videoTag.src = \"\";\n    if (this.delayedPauseTimer !== null) {\n      clearTimeout(this.delayedPauseTimer);\n      this.delayedPauseTimer = null;\n    }\n    if (this.delayedStartTimer !== null) {\n      clearTimeout(this.delayedStartTimer);\n      this.delayedStartTimer = null;\n    }\n  }\n\n  public syncVideoSource(props: VideoSourceProps): void {\n    const documentTimeMilliseconds = this.getDocumentTime();\n    this.videoSourceProps = props;\n    if (this.delayedStartTimer) {\n      clearTimeout(this.delayedStartTimer);\n      this.delayedStartTimer = null;\n    }\n    if (this.delayedPauseTimer !== null) {\n      clearTimeout(this.delayedPauseTimer);\n      this.delayedPauseTimer = null;\n    }\n\n    const startTimeMilliseconds = props.startTime ? props.startTime : 0;\n    const pauseTimeMilliseconds = props.pauseTime;\n    if (pauseTimeMilliseconds !== null) {\n      if (documentTimeMilliseconds !== null && pauseTimeMilliseconds > documentTimeMilliseconds) {\n        // The pause time is in the future\n        const delayedPauseTimer = setTimeout(() => {\n          if (this.delayedPauseTimer === delayedPauseTimer) {\n            this.delayedPauseTimer = null;\n          }\n          this.syncVideoSource(this.videoSourceProps);\n        }, pauseTimeMilliseconds - documentTimeMilliseconds);\n        this.delayedPauseTimer = delayedPauseTimer;\n      } else {\n        // The video should be paused because the pauseTime is in the past\n        let totalPlaybackTimeSeconds = (pauseTimeMilliseconds - startTimeMilliseconds) / 1000.0;\n        if (totalPlaybackTimeSeconds < 0) {\n          // The pauseTime is before the startTime - set the video's time to zero (i.e. unplayed)\n          totalPlaybackTimeSeconds = 0;\n        }\n        if (props.loop) {\n          totalPlaybackTimeSeconds = totalPlaybackTimeSeconds % this.videoTag.duration;\n        } else if (totalPlaybackTimeSeconds > this.videoTag.duration) {\n          totalPlaybackTimeSeconds = this.videoTag.duration;\n        }\n        this.shouldBePaused = true;\n        this.videoTag.pause();\n        this.videoTag.currentTime = totalPlaybackTimeSeconds;\n        return;\n      }\n    }\n\n    let currentTimeSeconds = 0;\n    if (documentTimeMilliseconds) {\n      currentTimeSeconds = (documentTimeMilliseconds - startTimeMilliseconds) / 1000;\n    } else {\n      currentTimeSeconds = startTimeMilliseconds / 1000;\n    }\n    let desiredVideoTimeSeconds;\n    if (currentTimeSeconds < 0) {\n      // The video should not start yet\n      this.videoTag.currentTime = 0;\n      this.shouldBePaused = true;\n      this.videoTag.pause();\n      const delayedStartTimer = setTimeout(() => {\n        if (this.delayedStartTimer === delayedStartTimer) {\n          this.delayedStartTimer = null;\n        }\n        this.syncVideoSource(this.videoSourceProps);\n      }, -currentTimeSeconds * 1000);\n      this.delayedStartTimer = delayedStartTimer;\n      return;\n    } else if (props.loop) {\n      desiredVideoTimeSeconds = currentTimeSeconds % this.videoTag.duration;\n    } else {\n      desiredVideoTimeSeconds = currentTimeSeconds;\n    }\n\n    let delta = desiredVideoTimeSeconds - this.videoTag.currentTime;\n    if (props.loop) {\n      // Check if the delta wrapping around is smaller (i.e. the desired and current are closer together if we wrap around)\n      const loopedDelta = delta - this.videoTag.duration;\n      if (Math.abs(delta) > Math.abs(loopedDelta)) {\n        delta = loopedDelta;\n      }\n    }\n\n    if (Math.abs(delta) < 0.1) {\n      // Do nothing - this is close enough - set the playback rate to 1\n      this.videoTag.playbackRate = 1;\n    } else if (Math.abs(delta) > 0.5) {\n      this.videoTag.currentTime = desiredVideoTimeSeconds;\n      this.videoTag.playbackRate = 1;\n    } else {\n      if (delta > 0) {\n        this.videoTag.playbackRate = 1.02;\n      } else {\n        this.videoTag.playbackRate = 0.98;\n      }\n    }\n\n    if (desiredVideoTimeSeconds >= this.videoTag.duration) {\n      this.shouldBePaused = true;\n      this.videoTag.pause();\n      return;\n    } else {\n      this.shouldBePaused = false;\n      if (this.videoTag.paused) {\n        this.videoTag.play().catch((e) => {\n          console.error(\"failed to play\", e);\n        });\n      }\n      return;\n    }\n  }\n}\n", "// Originally from https://github.com/cloudflare/workers-sdk/blob/b404ab707b324685235b522ee66bd6e8351f62be/templates/stream/webrtc/src/negotiateConnectionWithClientOffer.ts\n\n/**\n * Performs the actual SDP exchange.\n *\n * 1. Constructs the client's SDP offer\n * 2. Sends the SDP offer to the server,\n * 3. Awaits the server's offer.\n *\n * SDP describes what kind of media we can send and how the server and client communicate.\n *\n * https://developer.mozilla.org/en-US/docs/Glossary/SDP\n * https://www.ietf.org/archive/id/draft-ietf-wish-whip-01.html#name-protocol-operation\n */\nexport async function negotiateConnectionWithClientOffer(\n  peerConnection: RTCPeerConnection,\n  endpoint: string,\n) {\n  /** https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createOffer */\n  const offer = await peerConnection.createOffer();\n  /** https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/setLocalDescription */\n  await peerConnection.setLocalDescription(offer);\n\n  /** Wait for ICE gathering to complete */\n  const ofr = await waitToCompleteICEGathering(peerConnection);\n  if (!ofr) {\n    throw Error(\"failed to gather ICE candidates for offer\");\n  }\n\n  /**\n   * As long as the connection is open, attempt to...\n   */\n  while (peerConnection.connectionState !== \"closed\") {\n    /**\n     * This response contains the server's SDP offer.\n     * This specifies how the client should communicate,\n     * and what kind of media client and server have negotiated to exchange.\n     */\n    const response = await postSDPOffer(endpoint, ofr.sdp);\n    if (response.status === 201) {\n      const answerSDP = await response.text();\n      await peerConnection.setRemoteDescription(\n        new RTCSessionDescription({ type: \"answer\", sdp: answerSDP }),\n      );\n      return response.headers.get(\"Location\");\n    } else if (response.status === 405) {\n      console.log(\"Remember to update the URL passed into the WHIP or WHEP client\");\n    } else {\n      const errorMessage = await response.text();\n      console.error(\"WHEP error in negotiation response\", errorMessage);\n    }\n\n    /** Limit reconnection attempts to at-most once every 5 seconds */\n    await new Promise((r) => setTimeout(r, 5000));\n  }\n}\n\nasync function postSDPOffer(endpoint: string, data: string) {\n  return await fetch(endpoint, {\n    method: \"POST\",\n    mode: \"cors\",\n    headers: {\n      \"content-type\": \"application/sdp\",\n    },\n    body: data,\n  });\n}\n\n/**\n * Receives an RTCPeerConnection and waits until\n * the connection is initialized or a timeout passes.\n *\n * https://www.ietf.org/archive/id/draft-ietf-wish-whip-01.html#section-4.1\n * https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/iceGatheringState\n * https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/icegatheringstatechange_event\n */\nasync function waitToCompleteICEGathering(peerConnection: RTCPeerConnection) {\n  return new Promise<RTCSessionDescription | null>((resolve) => {\n    /** Wait at most 1 second for ICE gathering. */\n    setTimeout(function () {\n      resolve(peerConnection.localDescription);\n    }, 1000);\n    peerConnection.onicegatheringstatechange = () =>\n      peerConnection.iceGatheringState === \"complete\" && resolve(peerConnection.localDescription);\n  });\n}\n", "import { negotiateConnectionWithClientOffer } from \"./negotiateConnectionWithClientOffer\";\nimport { VideoSource } from \"./VideoSource\";\n\nexport class WHEPVideoSource implements VideoSource {\n  private peerConnection: RTCPeerConnection;\n  private stream: MediaStream;\n\n  constructor(\n    private srcURL: URL,\n    private videoTag: HTMLVideoElement,\n  ) {\n    const endpoint = new URL(srcURL);\n    endpoint.protocol = \"https:\";\n    this.stream = new MediaStream();\n    this.peerConnection = new RTCPeerConnection({\n      iceServers: [\n        {\n          urls: \"stun:stun.cloudflare.com:3478\",\n        },\n      ],\n      bundlePolicy: \"max-bundle\",\n    });\n    this.peerConnection.addTransceiver(\"video\", {\n      direction: \"recvonly\",\n    });\n    this.peerConnection.addTransceiver(\"audio\", {\n      direction: \"recvonly\",\n    });\n\n    this.peerConnection.ontrack = (event) => {\n      const track = event.track;\n      const currentTracks = this.stream.getTracks();\n      const streamAlreadyHasVideoTrack = currentTracks.some((track) => track.kind === \"video\");\n      const streamAlreadyHasAudioTrack = currentTracks.some((track) => track.kind === \"audio\");\n      switch (track.kind) {\n        case \"video\":\n          if (streamAlreadyHasVideoTrack) {\n            break;\n          }\n          this.stream.addTrack(track);\n          break;\n        case \"audio\":\n          if (streamAlreadyHasAudioTrack) {\n            break;\n          }\n          this.stream.addTrack(track);\n          break;\n        default:\n          console.warn(\"got unknown track \" + track);\n      }\n    };\n\n    this.peerConnection.addEventListener(\"connectionstatechange\", () => {\n      if (this.peerConnection.connectionState !== \"connected\") {\n        return;\n      }\n      this.videoTag.srcObject = this.stream;\n    });\n\n    this.peerConnection.addEventListener(\"negotiationneeded\", async () => {\n      try {\n        await negotiateConnectionWithClientOffer(this.peerConnection, endpoint.toString());\n      } catch (err) {\n        console.error(\"Failed to negotiate with WHEP endpoint\", err);\n      }\n    });\n  }\n\n  getContentAddress(): string {\n    return this.srcURL.toString();\n  }\n\n  public dispose() {\n    this.peerConnection.close();\n    this.videoTag.srcObject = null;\n  }\n\n  syncVideoSource() {\n    this.videoTag.play().catch((err) => {\n      console.error(\"play error\", err);\n    });\n  }\n\n  static isWHEPURL(url: URL) {\n    return url.protocol === \"whep:\";\n  }\n}\n", "export * from \"./attribute-animation\";\nexport * from \"./attributes\";\nexport * from \"./bounding-box\";\nexport * from \"./canvas-text/CanvasText\";\nexport * from \"./collision\";\nexport * from \"./color\";\nexport * from \"./configure-window-for-mml\";\nexport * from \"./debug-helper/DebugHelper\";\nexport * from \"./elements\";\nexport * from \"./global\";\nexport * from \"./graphics\";\nexport * from \"./iframe\";\nexport * from \"./interaction-ui\";\nexport * from \"./loading\";\nexport * from \"./math\";\nexport * from \"./network\";\nexport * from \"./position\";\nexport * from \"./prompt-ui\";\nexport * from \"./remote-document\";\nexport * from \"./scene\";\nexport * from \"./status-ui\";\nexport * from \"./tag-debug-adapter\";\nexport * from \"./time\";\nexport * from \"./utils/calculateContentSize\";\nexport * from \"./utils/EventHandlerCollection\";\nexport * from \"./video\";\nexport {\n  NetworkedDOMWebsocket,\n  NetworkedDOMWebsocketStatus,\n  NetworkedDOMWebsocketStatusToString,\n} from \"@mml-io/networked-dom-web\";\n"],
  "mappings": "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",
  "names": ["value", "scene", "documentTimeManager", "AnimationType", "defaultAttribute", "defaultEasing", "scene", "scene", "scene", "scene", "_a", "_b", "NetworkedDOMWebsocket", "NetworkedDOMWebsocketStatus", "scene", "_a", "_b", "NetworkedDOMWebsocket", "NetworkedDOMWebsocketStatus", "_a", "scene", "MLabelAlignment", "LightTypes", "OverlayAnchor", "remoteDocument", "_a", "window", "scene", "element", "track", "NetworkedDOMWebsocket", "NetworkedDOMWebsocketStatus"]
}
