import { LogMessage, ObservableDOMInterface, ObservableDOMMessage, ObservableDOMParameters, ObservableDOMRemoteEvent, StaticVirtualDOMElement } from "@mml-io/observable-dom-common";
export type DOMRunnerMessage = {
    loaded?: boolean;
    mutationList?: Array<MutationRecord>;
    logMessage?: LogMessage;
};
export type DOMRunnerInterface = {
    getDocument(): Document;
    getWindow(): Window & {
        CustomEvent: typeof CustomEvent;
        Text: typeof Text;
        HTMLScriptElement: typeof HTMLScriptElement;
        Comment: typeof Comment;
    };
    dispatchRemoteEventFromConnectionId(connectionId: number, realElement: Element, remoteEvent: ObservableDOMRemoteEvent): void;
    dispose(): void;
    getDocumentTime(): number;
};
export type DOMRunnerFactory = (htmlPath: string, htmlContents: string, params: object, callback: (domRunnerMessage: DOMRunnerMessage) => void) => DOMRunnerInterface;
export type LiveVirtualDOMElement = Omit<StaticVirtualDOMElement, "childNodes"> & {
    realElement: Element | Text;
    childNodes: Array<LiveVirtualDOMElement>;
    parent: LiveVirtualDOMElement | null;
};
/**
 * The ObservableDOM class handles the running of an HTML document using a provided DOMRunnerFactory and converting the
 * mutations that are structured as references to live DOM elements into messages that refer to elements by nodeIds.
 */
export declare class ObservableDOM implements ObservableDOMInterface {
    private nodeToNodeId;
    private nodeIdToNode;
    private realElementToVirtualElement;
    private ignoreTextNodes;
    private callback;
    private nextNodeId;
    private htmlPath;
    private domRunner;
    private loaded;
    private preLoadLogMessages;
    private documentTimeIntervalTimer;
    constructor(observableDOMParameters: ObservableDOMParameters, callback: (message: ObservableDOMMessage, observableDOM: ObservableDOMInterface) => void, runnerFactory: DOMRunnerFactory);
    addConnectedUserId(connectionId: number, connectionToken: string | null): void;
    removeConnectedUserId(connectionId: number): void;
    private processModificationList;
    private createMutationRecord;
    private removeVirtualDOMElement;
    private createVirtualDOMElementWithChildren;
    private createVirtualDOMElement;
    private getVirtualDOMElementForRealElementOrThrow;
    private isIgnoredElement;
    private isIgnoredAttribute;
    dispatchRemoteEventFromConnectionId(connectionId: number, remoteEvent: ObservableDOMRemoteEvent): void;
    dispose(): void;
    private getDocumentTime;
}
//# sourceMappingURL=ObservableDOM.d.ts.map