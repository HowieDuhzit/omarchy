{
  "version": 3,
  "sources": ["../src/messages.ts"],
  "sourcesContent": ["import {\n  ObservableDOMInterface,\n  ObservableDOMMessage,\n  ObservableDOMRemoteEvent,\n} from \"./ObservableDOMInterface\";\n\nexport const ADD_CONNECTED_USER_ID_MESSAGE_TYPE = \"addConnectedUserId\";\nexport const REMOVE_CONNECTED_USER_ID_MESSAGE_TYPE = \"removeConnectedUserId\";\nexport const DISPATCH_REMOTE_EVENT_FROM_CONNECTION_ID_MESSAGE_TYPE =\n  \"dispatchRemoteEventFromConnectionId\";\nexport const DOM_MESSAGE_TYPE = \"dom\";\n\nexport type AddConnectedUserIdMessage = {\n  type: typeof ADD_CONNECTED_USER_ID_MESSAGE_TYPE;\n  connectionId: number;\n  connectionToken: string | null;\n};\n\nexport type RemoveConnectedUserIdMessage = {\n  type: typeof REMOVE_CONNECTED_USER_ID_MESSAGE_TYPE;\n  connectionId: number;\n};\n\nexport type DispatchRemoteEventFromConnectionIdMessage = {\n  type: typeof DISPATCH_REMOTE_EVENT_FROM_CONNECTION_ID_MESSAGE_TYPE;\n  connectionId: number;\n  event: ObservableDOMRemoteEvent;\n};\n\nexport type ToObservableDOMInstanceMessage =\n  | AddConnectedUserIdMessage\n  | RemoveConnectedUserIdMessage\n  | DispatchRemoteEventFromConnectionIdMessage;\n\ntype DOMMessage = {\n  type: typeof DOM_MESSAGE_TYPE;\n  message: ObservableDOMMessage;\n};\n\nexport type FromObservableDOMInstanceMessage = DOMMessage;\n\nexport function applyMessageToObservableDOMInstance(\n  message: ToObservableDOMInstanceMessage,\n  instance: ObservableDOMInterface,\n) {\n  if (message.type === ADD_CONNECTED_USER_ID_MESSAGE_TYPE) {\n    instance.addConnectedUserId(message.connectionId, message.connectionToken);\n  } else if (message.type === REMOVE_CONNECTED_USER_ID_MESSAGE_TYPE) {\n    instance.removeConnectedUserId(message.connectionId);\n  } else if (message.type === DISPATCH_REMOTE_EVENT_FROM_CONNECTION_ID_MESSAGE_TYPE) {\n    instance.dispatchRemoteEventFromConnectionId(message.connectionId, message.event);\n  } else {\n    console.error(\"Unknown message type\", message);\n  }\n}\n\nexport function observableDOMInterfaceToMessageSender(\n  sender: (message: ToObservableDOMInstanceMessage) => void,\n  dispose: () => void,\n) {\n  const remoteObservableDOM: ObservableDOMInterface = {\n    addConnectedUserId(connectionId: number, connectionToken: string | null): void {\n      sender({\n        type: ADD_CONNECTED_USER_ID_MESSAGE_TYPE,\n        connectionId,\n        connectionToken,\n      });\n    },\n    dispatchRemoteEventFromConnectionId(\n      connectionId: number,\n      remoteEvent: ObservableDOMRemoteEvent,\n    ): void {\n      sender({\n        type: DISPATCH_REMOTE_EVENT_FROM_CONNECTION_ID_MESSAGE_TYPE,\n        connectionId,\n        event: remoteEvent,\n      });\n    },\n    dispose(): void {\n      dispose();\n    },\n    removeConnectedUserId(connectionId: number): void {\n      sender({\n        type: REMOVE_CONNECTED_USER_ID_MESSAGE_TYPE,\n        connectionId,\n      });\n    },\n  };\n  return remoteObservableDOM;\n}\n"],
  "mappings": ";AAMO,IAAM,qCAAqC;AAC3C,IAAM,wCAAwC;AAC9C,IAAM,wDACX;AACK,IAAM,mBAAmB;AA+BzB,SAAS,oCACd,SACA,UACA;AACA,MAAI,QAAQ,SAAS,oCAAoC;AACvD,aAAS,mBAAmB,QAAQ,cAAc,QAAQ,eAAe;AAAA,EAC3E,WAAW,QAAQ,SAAS,uCAAuC;AACjE,aAAS,sBAAsB,QAAQ,YAAY;AAAA,EACrD,WAAW,QAAQ,SAAS,uDAAuD;AACjF,aAAS,oCAAoC,QAAQ,cAAc,QAAQ,KAAK;AAAA,EAClF,OAAO;AACL,YAAQ,MAAM,wBAAwB,OAAO;AAAA,EAC/C;AACF;AAEO,SAAS,sCACd,QACA,SACA;AACA,QAAM,sBAA8C;AAAA,IAClD,mBAAmB,cAAsB,iBAAsC;AAC7E,aAAO;AAAA,QACL,MAAM;AAAA,QACN;AAAA,QACA;AAAA,MACF,CAAC;AAAA,IACH;AAAA,IACA,oCACE,cACA,aACM;AACN,aAAO;AAAA,QACL,MAAM;AAAA,QACN;AAAA,QACA,OAAO;AAAA,MACT,CAAC;AAAA,IACH;AAAA,IACA,UAAgB;AACd,cAAQ;AAAA,IACV;AAAA,IACA,sBAAsB,cAA4B;AAChD,aAAO;AAAA,QACL,MAAM;AAAA,QACN;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF;AACA,SAAO;AACT;",
  "names": []
}
